{
    "version": "https://jsonfeed.org/version/1",
    "title": "木语 • All posts by \"linux\" category",
    "description": "Spark!",
    "home_page_url": "https://koen666.github.io",
    "items": [
        {
            "id": "https://koen666.github.io/2026/02/02/ssh-l-r/",
            "url": "https://koen666.github.io/2026/02/02/ssh-l-r/",
            "title": "SSH 端口转发详解：彻底搞懂 -L 和 -R 的区别",
            "date_published": "2026-02-01T16:00:00.000Z",
            "content_html": "<p>在日常开发中，我们经常会遇到这样的需求：</p>\n<ol>\n<li>想连接线上数据库，但服务器为了安全只开放了 SSH 端口，数据库端口被防火墙挡住。</li>\n<li>在本地开发了一个 Web 应用，想发给异地同事或客户体验，但没有公网 IP。</li>\n</ol>\n<p>只要你有一台能 SSH 登录的服务器（或使用一些公共隧道服务），用一条 SSH 命令就能解决。</p>\n<p>SSH 端口转发本质上是“隧道”（Tunneling）。最常用的两个参数是 <code>-L</code> 和 <code>-R</code>：</p>\n<ul>\n<li><code>-L</code>（Local）：把远程的服务“拉回本地”（我想访问别人）。</li>\n<li><code>-R</code>（Remote）：把本地的服务“推出远程”（我想让别人访问我）。</li>\n</ul>\n<hr>\n<h2 id=\"1-ssh-l本地端口转发local-port-forwarding\"><a class=\"anchor\" href=\"#1-ssh-l本地端口转发local-port-forwarding\">#</a> 1. SSH -L：本地端口转发（Local Port Forwarding）</h2>\n<p>适用场景：安全地连接远程服务器上的服务（如 MySQL、Redis）。</p>\n<p>假设你有一台服务器 <code>1.2.3.4</code>，上面运行着 MySQL（<code>3306</code> 端口），但防火墙只允许本机 <code>127.0.0.1</code> 访问。你在本地 Windows/macOS 上想用 Navicat 或 DBeaver 管理它。</p>\n<h3 id=\"命令格式\"><a class=\"anchor\" href=\"#命令格式\">#</a> 命令格式</h3>\n<pre class=\"shiki shiki-themes vitesse-light vitesse-dark\" style=\"background-color:#ffffff;--shiki-dark-bg:#121212;color:#393a34;--shiki-dark:#dbd7caee\" tabindex=\"0\"><code class=\"language-bash\"><span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">ssh</span><span style=\"color:#A65E2B;--shiki-dark:#C99076\"> -L</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\"> </span><span style=\"color:#AB5959;--shiki-dark:#CB7676\">&lt;</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">本地端</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">口</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\">&gt;</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">:</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\">&lt;</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">目标I</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">P</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\">&gt;</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">:</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\">&lt;</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">目标端</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">口</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\">&gt;</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\"> </span><span style=\"color:#AB5959;--shiki-dark:#CB7676\">&lt;</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">用</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">户</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\">&gt;</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">@</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\">&lt;</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">跳板机I</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">P</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\">&gt;</span></span></code></pre>\n<h3 id=\"实战示例\"><a class=\"anchor\" href=\"#实战示例\">#</a> 实战示例</h3>\n<pre class=\"shiki shiki-themes vitesse-light vitesse-dark\" style=\"background-color:#ffffff;--shiki-dark-bg:#121212;color:#393a34;--shiki-dark:#dbd7caee\" tabindex=\"0\"><code class=\"language-bash\"><span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">ssh</span><span style=\"color:#A65E2B;--shiki-dark:#C99076\"> -L</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> 3307:localhost:3306</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> root@1.2.3.4</span></span></code></pre>\n<p>执行后：</p>\n<ul>\n<li>SSH 客户端会在你本地监听 <code>3307</code>。</li>\n<li>你连接 <code>localhost:3307</code>，请求会通过 SSH 隧道转发到远程的 <code>localhost:3306</code>。</li>\n</ul>\n<h2 id=\"2-ssh-r远程端口转发remote-port-forwarding\"><a class=\"anchor\" href=\"#2-ssh-r远程端口转发remote-port-forwarding\">#</a> 2. SSH -R：远程端口转发（Remote Port Forwarding）</h2>\n<p>适用场景：内网穿透，把本地服务暴露给公网访问。</p>\n<p>假设你在本地开发了一个 FastAPI 服务，监听 <code>8001</code> 端口。现在你需要让外部人员访问（演示/联调）。</p>\n<h3 id=\"命令格式-2\"><a class=\"anchor\" href=\"#命令格式-2\">#</a> 命令格式</h3>\n<pre class=\"shiki shiki-themes vitesse-light vitesse-dark\" style=\"background-color:#ffffff;--shiki-dark-bg:#121212;color:#393a34;--shiki-dark:#dbd7caee\" tabindex=\"0\"><code class=\"language-bash\"><span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">ssh</span><span style=\"color:#A65E2B;--shiki-dark:#C99076\"> -R</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\"> </span><span style=\"color:#AB5959;--shiki-dark:#CB7676\">&lt;</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">远程端</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">口</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\">&gt;</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">:</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\">&lt;</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">本地I</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">P</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\">&gt;</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">:</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\">&lt;</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">本地端</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">口</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\">&gt;</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\"> </span><span style=\"color:#AB5959;--shiki-dark:#CB7676\">&lt;</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">用</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">户</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\">&gt;</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">@</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\">&lt;</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">远程服务器I</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">P</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\">&gt;</span></span></code></pre>\n<h3 id=\"实战示例-2\"><a class=\"anchor\" href=\"#实战示例-2\">#</a> 实战示例</h3>\n<p>如果你有自己的服务器 <code>1.2.3.4</code>，可以把远程 <code>8080</code> 映射到本地 <code>8001</code>：</p>\n<pre class=\"shiki shiki-themes vitesse-light vitesse-dark\" style=\"background-color:#ffffff;--shiki-dark-bg:#121212;color:#393a34;--shiki-dark:#dbd7caee\" tabindex=\"0\"><code class=\"language-bash\"><span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">ssh</span><span style=\"color:#A65E2B;--shiki-dark:#C99076\"> -R</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> 8080:localhost:8001</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> root@1.2.3.4</span></span></code></pre>\n<p>执行后，访问远程服务器的 <code>8080</code> 端口，就会被转发到你本机的 <code>8001</code>。</p>\n<hr>\n<h2 id=\"3-小提示\"><a class=\"anchor\" href=\"#3-小提示\">#</a> 3. 小提示</h2>\n<ul>\n<li><code>-L</code> 常用于“我访问远程内网服务”。</li>\n<li><code>-R</code> 常用于“别人访问我本地服务”。</li>\n<li>生产环境下建议配合 <code>~/.ssh/config</code>、最小权限账号、以及必要的防火墙策略使用。</li>\n</ul>\n",
            "tags": [
                "SSH",
                "端口转发",
                "内网穿透"
            ]
        },
        {
            "id": "https://koen666.github.io/2025/10/06/screen/",
            "url": "https://koen666.github.io/2025/10/06/screen/",
            "title": "介绍screen，挂起的虚拟终端使用",
            "date_published": "2025-10-05T16:00:00.000Z",
            "content_html": "<h2 id=\"1-screen-是什么\"><a class=\"anchor\" href=\"#1-screen-是什么\">#</a> 1. screen 是什么？</h2>\n<ul>\n<li><code>screen</code> 是一种终端复用器（terminal multiplexer）。</li>\n<li>它可以在一个终端窗口中运行多个“虚拟终端”，并允许你把会话挂到后台继续运行。</li>\n<li>常见用途：\n<ul>\n<li>在远程服务器上运行长时间任务，即使断开 SSH 也能继续执行。</li>\n<li>在一个终端里同时打开多个 shell。</li>\n<li>共享会话（多人操作同一个 session，需要权限）。</li>\n</ul>\n</li>\n</ul>\n<h2 id=\"2-安装\"><a class=\"anchor\" href=\"#2-安装\">#</a> 2. 安装</h2>\n<p>多数 Linux 发行版可以直接安装或已预装。先检查版本：</p>\n<pre class=\"shiki shiki-themes vitesse-light vitesse-dark\" style=\"background-color:#ffffff;--shiki-dark-bg:#121212;color:#393a34;--shiki-dark:#dbd7caee\" tabindex=\"0\"><code class=\"language-bash\"><span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">screen</span><span style=\"color:#A65E2B;--shiki-dark:#C99076\"> --version</span></span></code></pre>\n<p>如果没有安装：</p>\n<pre class=\"shiki shiki-themes vitesse-light vitesse-dark\" style=\"background-color:#ffffff;--shiki-dark-bg:#121212;color:#393a34;--shiki-dark:#dbd7caee\" tabindex=\"0\"><code class=\"language-bash\"><span class=\"line\"><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\"># Ubuntu / Debian</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">sudo</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> apt</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> install</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> screen</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\"># CentOS / RHEL</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">sudo</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> yum</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> install</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> screen</span></span></code></pre>\n<h2 id=\"3-基本命令\"><a class=\"anchor\" href=\"#3-基本命令\">#</a> 3. 基本命令</h2>\n<h3 id=\"31-启动一个新-screen-会话\"><a class=\"anchor\" href=\"#31-启动一个新-screen-会话\">#</a> 3.1 启动一个新 screen 会话</h3>\n<pre class=\"shiki shiki-themes vitesse-light vitesse-dark\" style=\"background-color:#ffffff;--shiki-dark-bg:#121212;color:#393a34;--shiki-dark:#dbd7caee\" tabindex=\"0\"><code class=\"language-bash\"><span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">screen</span><span style=\"color:#A65E2B;--shiki-dark:#C99076\"> -S</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> mysession</span></span></code></pre>\n<ul>\n<li><code>-S mysession</code>：给会话取名字，方便管理。</li>\n<li>执行后你会进入一个新的终端环境，和普通 shell 使用方式一致。</li>\n</ul>\n<h3 id=\"32-在-screen-中操作\"><a class=\"anchor\" href=\"#32-在-screen-中操作\">#</a> 3.2 在 screen 中操作</h3>\n<ul>\n<li>新建窗口：<code>Ctrl+a</code> 然后 <code>c</code></li>\n<li>切换窗口：<code>Ctrl+a</code> 然后 <code>n</code>（下一个）、<code>p</code>（上一个）</li>\n<li>查看窗口列表：<code>Ctrl+a</code> 然后 <code>\"</code></li>\n</ul>\n<h3 id=\"33-暂时离开detach会话\"><a class=\"anchor\" href=\"#33-暂时离开detach会话\">#</a> 3.3 暂时离开（detach）会话</h3>\n<p>在 screen 中按：</p>\n<pre class=\"shiki shiki-themes vitesse-light vitesse-dark\" style=\"background-color:#ffffff;--shiki-dark-bg:#121212;color:#393a34;--shiki-dark:#dbd7caee\" tabindex=\"0\"><code class=\"language-text\"><span class=\"line\"><span>Ctrl+a d</span></span></code></pre>\n<p>会让 screen 会话在后台继续运行，终端回到原来的 shell。</p>\n<h3 id=\"34-恢复attach会话\"><a class=\"anchor\" href=\"#34-恢复attach会话\">#</a> 3.4 恢复（attach）会话</h3>\n<pre class=\"shiki shiki-themes vitesse-light vitesse-dark\" style=\"background-color:#ffffff;--shiki-dark-bg:#121212;color:#393a34;--shiki-dark:#dbd7caee\" tabindex=\"0\"><code class=\"language-bash\"><span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">screen</span><span style=\"color:#A65E2B;--shiki-dark:#C99076\"> -r</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> mysession</span></span></code></pre>\n<p>如果有多个会话：</p>\n<pre class=\"shiki shiki-themes vitesse-light vitesse-dark\" style=\"background-color:#ffffff;--shiki-dark-bg:#121212;color:#393a34;--shiki-dark:#dbd7caee\" tabindex=\"0\"><code class=\"language-bash\"><span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">screen</span><span style=\"color:#A65E2B;--shiki-dark:#C99076\"> -ls</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">screen</span><span style=\"color:#A65E2B;--shiki-dark:#C99076\"> -r</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> 会话ID</span></span></code></pre>\n<h3 id=\"35-结束会话\"><a class=\"anchor\" href=\"#35-结束会话\">#</a> 3.5 结束会话</h3>\n<p>在 screen 内直接输入：</p>\n<pre class=\"shiki shiki-themes vitesse-light vitesse-dark\" style=\"background-color:#ffffff;--shiki-dark-bg:#121212;color:#393a34;--shiki-dark:#dbd7caee\" tabindex=\"0\"><code class=\"language-bash\"><span class=\"line\"><span style=\"color:#998418;--shiki-dark:#B8A965\">exit</span></span></code></pre>\n<p>或在外部执行：</p>\n<pre class=\"shiki shiki-themes vitesse-light vitesse-dark\" style=\"background-color:#ffffff;--shiki-dark-bg:#121212;color:#393a34;--shiki-dark:#dbd7caee\" tabindex=\"0\"><code class=\"language-bash\"><span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">screen</span><span style=\"color:#A65E2B;--shiki-dark:#C99076\"> -X</span><span style=\"color:#A65E2B;--shiki-dark:#C99076\"> -S</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> mysession</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> quit</span></span></code></pre>\n<h2 id=\"4-高级技巧\"><a class=\"anchor\" href=\"#4-高级技巧\">#</a> 4. 高级技巧</h2>\n<h3 id=\"41-后台运行任务\"><a class=\"anchor\" href=\"#41-后台运行任务\">#</a> 4.1 后台运行任务</h3>\n<pre class=\"shiki shiki-themes vitesse-light vitesse-dark\" style=\"background-color:#ffffff;--shiki-dark-bg:#121212;color:#393a34;--shiki-dark:#dbd7caee\" tabindex=\"0\"><code class=\"language-bash\"><span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">screen</span><span style=\"color:#A65E2B;--shiki-dark:#C99076\"> -S</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> mytask</span><span style=\"color:#A65E2B;--shiki-dark:#C99076\"> -dm</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> bash</span><span style=\"color:#A65E2B;--shiki-dark:#C99076\"> -c</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">python myscript.py</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span></code></pre>\n<ul>\n<li><code>-dm</code>：创建会话并立即后台运行。</li>\n<li>之后可以用 <code>screen -r mytask</code> 查看进度。</li>\n</ul>\n<h3 id=\"42-日志记录\"><a class=\"anchor\" href=\"#42-日志记录\">#</a> 4.2 日志记录</h3>\n<p>在 screen 中按：</p>\n<pre class=\"shiki shiki-themes vitesse-light vitesse-dark\" style=\"background-color:#ffffff;--shiki-dark-bg:#121212;color:#393a34;--shiki-dark:#dbd7caee\" tabindex=\"0\"><code class=\"language-text\"><span class=\"line\"><span>Ctrl+a H</span></span></code></pre>\n<p>会将当前窗口输出记录到 <code>screenlog.0</code>。</p>\n<h3 id=\"43-共享会话\"><a class=\"anchor\" href=\"#43-共享会话\">#</a> 4.3 共享会话</h3>\n<pre class=\"shiki shiki-themes vitesse-light vitesse-dark\" style=\"background-color:#ffffff;--shiki-dark-bg:#121212;color:#393a34;--shiki-dark:#dbd7caee\" tabindex=\"0\"><code class=\"language-bash\"><span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">screen</span><span style=\"color:#A65E2B;--shiki-dark:#C99076\"> -x</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> mysession</span></span></code></pre>\n<p>允许多个用户同时连接到同一个会话（需要权限）。</p>\n<h2 id=\"5-总结\"><a class=\"anchor\" href=\"#5-总结\">#</a> 5. 总结</h2>\n<p><code>screen</code> 的核心价值：</p>\n<ul>\n<li>断开重连：网络断了也不会影响任务。</li>\n<li>多窗口管理：在一个终端里管理多个任务。</li>\n<li>后台执行：任务可持续运行，不占用本地终端。</li>\n</ul>\n",
            "tags": [
                "screen",
                "termux"
            ]
        }
    ]
}