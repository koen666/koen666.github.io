{
    "version": "https://jsonfeed.org/version/1",
    "title": "æœ¨è¯­ â€¢ All posts by \"dataloader\" tag",
    "description": "Spark!",
    "home_page_url": "https://koen666.github.io",
    "items": [
        {
            "id": "https://koen666.github.io/2025/09/15/%E4%BB%8Edataset%E5%88%B0dataloader/",
            "url": "https://koen666.github.io/2025/09/15/%E4%BB%8Edataset%E5%88%B0dataloader/",
            "title": "ä»dataset->dataloader",
            "date_published": "2025-09-14T16:00:00.000Z",
            "content_html": "<h2 id=\"dataset-dataloader\"><a class=\"anchor\" href=\"#dataset-dataloader\">#</a> <strong>dataset-&gt;dataloader</strong></h2>\n<pre class=\"shiki shiki-themes vitesse-light vitesse-dark\" style=\"background-color:#ffffff;--shiki-dark-bg:#121212;color:#393a34;--shiki-dark:#dbd7caee\" tabindex=\"0\"><code class=\"language-python\"><span class=\"line\"><span style=\"color:#1E754F;--shiki-dark:#4D9375\">import</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\"> torch</span></span>\n<span class=\"line\"><span style=\"color:#1E754F;--shiki-dark:#4D9375\">from</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\"> torch</span><span style=\"color:#999999;--shiki-dark:#666666\">.</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">utils</span><span style=\"color:#999999;--shiki-dark:#666666\">.</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">data </span><span style=\"color:#1E754F;--shiki-dark:#4D9375\">import</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\"> Dataset</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\"> DataLoader</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\"> Sampler</span></span>\n<span class=\"line\"><span style=\"color:#1E754F;--shiki-dark:#4D9375\">import</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\"> torch</span><span style=\"color:#999999;--shiki-dark:#666666\">.</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">nn </span><span style=\"color:#1E754F;--shiki-dark:#4D9375\">as</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\"> nn</span></span>\n<span class=\"line\"><span style=\"color:#1E754F;--shiki-dark:#4D9375\">import</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\"> torch</span><span style=\"color:#999999;--shiki-dark:#666666\">.</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">optim </span><span style=\"color:#1E754F;--shiki-dark:#4D9375\">as</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\"> optim</span></span></code></pre>\n<p><strong>è§£æ</strong>ï¼š</p>\n<ul>\n<li><code>torch</code>ï¼šPyTorch ä¸»åº“ï¼Œç”¨äºå¼ é‡æ“ä½œã€‚</li>\n<li><code>Dataset</code>ï¼šæ•°æ®é›†åŸºç±»ã€‚</li>\n<li><code>DataLoader</code>ï¼šæ‰¹æ¬¡ç”Ÿæˆå™¨ã€‚</li>\n<li><code>Sampler</code>ï¼šç´¢å¼•ç”Ÿæˆå™¨ã€‚</li>\n<li><code>nn</code>ï¼šç¥ç»ç½‘ç»œæ¨¡å—ã€‚</li>\n<li><code>optim</code>ï¼šä¼˜åŒ–å™¨ã€‚</li>\n</ul>\n<hr>\n<h3 id=\"1ï¸âƒ£-å®šä¹‰-dataset\"><a class=\"anchor\" href=\"#1ï¸âƒ£-å®šä¹‰-dataset\">#</a> <strong>1ï¸âƒ£ å®šä¹‰ Dataset</strong></h3>\n<pre class=\"shiki shiki-themes vitesse-light vitesse-dark\" style=\"background-color:#ffffff;--shiki-dark-bg:#121212;color:#393a34;--shiki-dark:#dbd7caee\" tabindex=\"0\"><code class=\"language-python\"><span class=\"line\"><span style=\"color:#AB5959;--shiki-dark:#CB7676\">class</span><span style=\"color:#2E8F82;--shiki-dark:#5DA994\"> MyDataset</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#59873A;--shiki-dark:#80A665\">Dataset</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span><span style=\"color:#999999;--shiki-dark:#666666\">:</span></span>\n<span class=\"line\"><span style=\"color:#AB5959;--shiki-dark:#CB7676\">    def</span><span style=\"color:#998418;--shiki-dark:#B8A965\"> __init__</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">self</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\"> data</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\"> labels</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span><span style=\"color:#999999;--shiki-dark:#666666\">:</span></span>\n<span class=\"line\"><span style=\"color:#A65E2B;--shiki-dark:#C99076\">        self</span><span style=\"color:#999999;--shiki-dark:#666666\">.</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">data </span><span style=\"color:#999999;--shiki-dark:#666666\">=</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\"> data       </span><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\"># å­˜å‚¨ç‰¹å¾åˆ—è¡¨</span></span>\n<span class=\"line\"><span style=\"color:#A65E2B;--shiki-dark:#C99076\">        self</span><span style=\"color:#999999;--shiki-dark:#666666\">.</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">labels </span><span style=\"color:#999999;--shiki-dark:#666666\">=</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\"> labels   </span><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\"># å­˜å‚¨æ ‡ç­¾åˆ—è¡¨</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#AB5959;--shiki-dark:#CB7676\">    def</span><span style=\"color:#998418;--shiki-dark:#B8A965\"> __len__</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">self</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span><span style=\"color:#999999;--shiki-dark:#666666\">:</span></span>\n<span class=\"line\"><span style=\"color:#1E754F;--shiki-dark:#4D9375\">        return</span><span style=\"color:#998418;--shiki-dark:#B8A965\"> len</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#A65E2B;--shiki-dark:#C99076\">self</span><span style=\"color:#999999;--shiki-dark:#666666\">.</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">data</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\">  # è¿”å›æ ·æœ¬æ€»æ•°</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#AB5959;--shiki-dark:#CB7676\">    def</span><span style=\"color:#998418;--shiki-dark:#B8A965\"> __getitem__</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">self</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\"> index</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span><span style=\"color:#999999;--shiki-dark:#666666\">:</span></span>\n<span class=\"line\"><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">        x </span><span style=\"color:#999999;--shiki-dark:#666666\">=</span><span style=\"color:#A65E2B;--shiki-dark:#C99076\"> self</span><span style=\"color:#999999;--shiki-dark:#666666\">.</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">data</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">[</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">index</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">]</span><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\">  # å–ç¬¬ index ä¸ªç‰¹å¾</span></span>\n<span class=\"line\"><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">        y </span><span style=\"color:#999999;--shiki-dark:#666666\">=</span><span style=\"color:#A65E2B;--shiki-dark:#C99076\"> self</span><span style=\"color:#999999;--shiki-dark:#666666\">.</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">labels</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">[</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">index</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">]</span><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\">  # å–ç¬¬ index ä¸ªæ ‡ç­¾</span></span>\n<span class=\"line\"><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\">        # è½¬ä¸º tensor å¹¶æŒ‡å®šæ•°æ®ç±»å‹</span></span>\n<span class=\"line\"><span style=\"color:#1E754F;--shiki-dark:#4D9375\">        return</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\"> torch</span><span style=\"color:#999999;--shiki-dark:#666666\">.</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">tensor</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">x</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span><span style=\"color:#B07D48;--shiki-dark:#BD976A\"> dtype</span><span style=\"color:#999999;--shiki-dark:#666666\">=</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">torch</span><span style=\"color:#999999;--shiki-dark:#666666\">.</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">float32</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\"> torch</span><span style=\"color:#999999;--shiki-dark:#666666\">.</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">tensor</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">y</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span><span style=\"color:#B07D48;--shiki-dark:#BD976A\"> dtype</span><span style=\"color:#999999;--shiki-dark:#666666\">=</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">torch</span><span style=\"color:#999999;--shiki-dark:#666666\">.</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">long</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span></span></code></pre>\n<p><strong>è¯¦ç»†è§£æ</strong>ï¼š</p>\n<ol>\n<li>\n<p><code>__init__</code>ï¼šåˆå§‹åŒ– Dataset å¯¹è±¡ï¼Œå­˜å‚¨æ•°æ®å’Œæ ‡ç­¾ã€‚</p>\n</li>\n<li>\n<p><code>__len__</code>ï¼šDataset çš„é•¿åº¦ï¼ˆæ ·æœ¬æ•°ï¼‰ï¼ŒDataLoader å†…éƒ¨ä¼šç”¨å®ƒæ¥è®¡ç®— batch æ•°é‡ã€‚</p>\n</li>\n<li>\n<p><code>__getitem__</code>ï¼š</p>\n<ul>\n<li>\n<p>æ¥æ”¶ä¸€ä¸ªæ•´æ•° <code>index</code>ã€‚</p>\n</li>\n<li>\n<p>ä»åˆ—è¡¨ä¸­å–æ•°æ®å’Œæ ‡ç­¾ã€‚</p>\n</li>\n<li>\n<p>è½¬ä¸º PyTorch å¼ é‡ï¼š</p>\n<ul>\n<li><code>x</code> â†’ float32ï¼Œç”¨äºè®¡ç®—ã€‚</li>\n<li><code>y</code> â†’ longï¼Œç”¨äºåˆ†ç±»ä»»åŠ¡çš„ CrossEntropyLossã€‚</li>\n</ul>\n</li>\n<li>\n<p>è¿”å› <code>(x, y)</code> å…ƒç»„ã€‚</p>\n</li>\n</ul>\n</li>\n<li>\n<p><strong>å…³é”®ç‚¹</strong>ï¼šDataset æœ¬èº«ä¸å¤„ç† batchï¼Œä¹Ÿä¸å†³å®šé¡ºåºï¼Œå®ƒåªçŸ¥é“å¦‚ä½•æ ¹æ®ç´¢å¼•å–å•ä¸ªæ ·æœ¬ã€‚</p>\n</li>\n</ol>\n<hr>\n<h3 id=\"2ï¸âƒ£-å®šä¹‰-sampler\"><a class=\"anchor\" href=\"#2ï¸âƒ£-å®šä¹‰-sampler\">#</a> <strong>2ï¸âƒ£ å®šä¹‰ Sampler</strong></h3>\n<pre class=\"shiki shiki-themes vitesse-light vitesse-dark\" style=\"background-color:#ffffff;--shiki-dark-bg:#121212;color:#393a34;--shiki-dark:#dbd7caee\" tabindex=\"0\"><code class=\"language-python\"><span class=\"line\"><span style=\"color:#AB5959;--shiki-dark:#CB7676\">class</span><span style=\"color:#2E8F82;--shiki-dark:#5DA994\"> ReverseSampler</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#59873A;--shiki-dark:#80A665\">Sampler</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span><span style=\"color:#999999;--shiki-dark:#666666\">:</span></span>\n<span class=\"line\"><span style=\"color:#AB5959;--shiki-dark:#CB7676\">    def</span><span style=\"color:#998418;--shiki-dark:#B8A965\"> __init__</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">self</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\"> data_source</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span><span style=\"color:#999999;--shiki-dark:#666666\">:</span></span>\n<span class=\"line\"><span style=\"color:#A65E2B;--shiki-dark:#C99076\">        self</span><span style=\"color:#999999;--shiki-dark:#666666\">.</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">data_source </span><span style=\"color:#999999;--shiki-dark:#666666\">=</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\"> data_source  </span><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\"># Dataset å¯¹è±¡</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#AB5959;--shiki-dark:#CB7676\">    def</span><span style=\"color:#998418;--shiki-dark:#B8A965\"> __iter__</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">self</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span><span style=\"color:#999999;--shiki-dark:#666666\">:</span></span>\n<span class=\"line\"><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\">        # è¿”å›ç´¢å¼•è¿­ä»£å™¨ï¼šå€’åºå–æ ·</span></span>\n<span class=\"line\"><span style=\"color:#1E754F;--shiki-dark:#4D9375\">        return</span><span style=\"color:#998418;--shiki-dark:#B8A965\"> iter</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#998418;--shiki-dark:#B8A965\">range</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">(</span><span style=\"color:#998418;--shiki-dark:#B8A965\">len</span><span style=\"color:#a65e2b;--shiki-dark:#d4976c\">(</span><span style=\"color:#A65E2B;--shiki-dark:#C99076\">self</span><span style=\"color:#999999;--shiki-dark:#666666\">.</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">data_source</span><span style=\"color:#a65e2b;--shiki-dark:#d4976c\">)</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\">-</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\">1</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\"> -</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\">1</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\"> -</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\">1</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">)</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#AB5959;--shiki-dark:#CB7676\">    def</span><span style=\"color:#998418;--shiki-dark:#B8A965\"> __len__</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">self</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span><span style=\"color:#999999;--shiki-dark:#666666\">:</span></span>\n<span class=\"line\"><span style=\"color:#1E754F;--shiki-dark:#4D9375\">        return</span><span style=\"color:#998418;--shiki-dark:#B8A965\"> len</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#A65E2B;--shiki-dark:#C99076\">self</span><span style=\"color:#999999;--shiki-dark:#666666\">.</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">data_source</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\">  # æ ·æœ¬æ€»æ•°</span></span></code></pre>\n<p><strong>è¯¦ç»†è§£æ</strong>ï¼š</p>\n<ol>\n<li>\n<p><code>__iter__</code>ï¼š</p>\n<ul>\n<li>\n<p>è¿”å›ä¸€ä¸ªè¿­ä»£å™¨ï¼Œç”¨äºç”Ÿæˆç´¢å¼•åºåˆ—ã€‚</p>\n</li>\n<li>\n<p><code>range(len(self.data_source)-1, -1, -1)</code>ï¼š</p>\n<ul>\n<li>ä»æœ€å¤§ç´¢å¼•åˆ° 0</li>\n<li>ä¾‹å¦‚æ•°æ®æœ‰ 5 ä¸ªæ ·æœ¬ï¼Œç´¢å¼•é¡ºåºæ˜¯ <code>[4,3,2,1,0]</code></li>\n</ul>\n</li>\n</ul>\n</li>\n<li>\n<p><code>__len__</code>ï¼š</p>\n<ul>\n<li>è¿”å› Dataset é•¿åº¦</li>\n<li>DataLoader å†…éƒ¨å¯èƒ½ç”¨å®ƒè®¡ç®— batch æ€»æ•°æˆ–è¿›åº¦æ¡ã€‚</li>\n</ul>\n</li>\n<li>\n<p><strong>å…³é”®ç‚¹</strong>ï¼š</p>\n<ul>\n<li>Sampler åªè´Ÿè´£â€œç´¢å¼•é¡ºåºâ€ï¼Œä¸æ¶‰åŠæ•°æ®æœ¬èº«ã€‚</li>\n<li>å¯ä»¥ç”¨å®ƒå®ç°é¡ºåºã€éšæœºæˆ–è‡ªå®šä¹‰é‡‡æ ·ç­–ç•¥ã€‚</li>\n</ul>\n</li>\n</ol>\n<hr>\n<h3 id=\"3ï¸âƒ£-åˆå§‹åŒ–-dataset-å’Œ-sampler\"><a class=\"anchor\" href=\"#3ï¸âƒ£-åˆå§‹åŒ–-dataset-å’Œ-sampler\">#</a> <strong>3ï¸âƒ£ åˆå§‹åŒ– Dataset å’Œ Sampler</strong></h3>\n<pre class=\"shiki shiki-themes vitesse-light vitesse-dark\" style=\"background-color:#ffffff;--shiki-dark-bg:#121212;color:#393a34;--shiki-dark:#dbd7caee\" tabindex=\"0\"><code class=\"language-python\"><span class=\"line\"><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">data </span><span style=\"color:#999999;--shiki-dark:#666666\">=</span><span style=\"color:#999999;--shiki-dark:#666666\"> </span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">[</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">[</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\">1</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\">2</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">]</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span><span style=\"color:#999999;--shiki-dark:#666666\"> </span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">[</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\">3</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\">4</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">]</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span><span style=\"color:#999999;--shiki-dark:#666666\"> </span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">[</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\">5</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\">6</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">]</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span><span style=\"color:#999999;--shiki-dark:#666666\"> </span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">[</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\">7</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\">8</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">]</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span><span style=\"color:#999999;--shiki-dark:#666666\"> </span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">[</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\">9</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\">10</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">]</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">]</span></span>\n<span class=\"line\"><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">labels </span><span style=\"color:#999999;--shiki-dark:#666666\">=</span><span style=\"color:#999999;--shiki-dark:#666666\"> </span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">[</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\">0</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\"> 1</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\"> 0</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\"> 1</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\"> 0</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">]</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">dataset </span><span style=\"color:#999999;--shiki-dark:#666666\">=</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\"> MyDataset</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">data</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\"> labels</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span></span>\n<span class=\"line\"><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">sampler </span><span style=\"color:#999999;--shiki-dark:#666666\">=</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\"> ReverseSampler</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">dataset</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span></span></code></pre>\n<ul>\n<li>\n<p>Dataset ä¿å­˜åŸå§‹æ•°æ®ã€‚</p>\n</li>\n<li>\n<p>Sampler å®šä¹‰ç´¢å¼•é¡ºåºï¼ˆå€’åºï¼‰ã€‚</p>\n</li>\n<li>\n<p>æ­¤æ—¶æ•°æ®å’Œç´¢å¼•æ˜¯åˆ†å¼€çš„ï¼š</p>\n<pre class=\"shiki shiki-themes vitesse-light vitesse-dark\" style=\"background-color:#ffffff;--shiki-dark-bg:#121212;color:#393a34;--shiki-dark:#dbd7caee\" tabindex=\"0\"><code class=\"language-text\"><span class=\"line\"><span>Dataset: [ [1,2], [3,4], [5,6], [7,8], [9,10] ]</span></span>\n<span class=\"line\"><span>Sampler: [4,3,2,1,0]</span></span></code></pre>\n</li>\n</ul>\n<hr>\n<h3 id=\"4ï¸âƒ£-å®šä¹‰-dataloader\"><a class=\"anchor\" href=\"#4ï¸âƒ£-å®šä¹‰-dataloader\">#</a> <strong>4ï¸âƒ£ å®šä¹‰ DataLoader</strong></h3>\n<pre class=\"shiki shiki-themes vitesse-light vitesse-dark\" style=\"background-color:#ffffff;--shiki-dark-bg:#121212;color:#393a34;--shiki-dark:#dbd7caee\" tabindex=\"0\"><code class=\"language-python\"><span class=\"line\"><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">batch_size </span><span style=\"color:#999999;--shiki-dark:#666666\">=</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\"> 2</span></span>\n<span class=\"line\"><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">dataloader </span><span style=\"color:#999999;--shiki-dark:#666666\">=</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\"> DataLoader</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">dataset</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span><span style=\"color:#B07D48;--shiki-dark:#BD976A\"> batch_size</span><span style=\"color:#999999;--shiki-dark:#666666\">=</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">batch_size</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span><span style=\"color:#B07D48;--shiki-dark:#BD976A\"> sampler</span><span style=\"color:#999999;--shiki-dark:#666666\">=</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">sampler</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span></span></code></pre>\n<p><strong>è¯¦ç»†è§£æ</strong>ï¼š</p>\n<ul>\n<li>\n<p>DataLoader æ¥æ”¶ Dataset å¯¹è±¡ã€‚</p>\n</li>\n<li>\n<p><code>batch_size=2</code> â†’ æ¯ä¸ª batch 2 ä¸ªæ ·æœ¬ã€‚</p>\n</li>\n<li>\n<p><code>sampler=sampler</code> â†’ ä½¿ç”¨æˆ‘ä»¬è‡ªå®šä¹‰çš„å€’åºç´¢å¼•ã€‚</p>\n</li>\n<li>\n<p><strong>å†…éƒ¨æµç¨‹</strong>ï¼š</p>\n<ol>\n<li>\n<p>DataLoader è°ƒç”¨ <code>sampler.__iter__()</code> â†’ å¾—åˆ°ç´¢å¼•è¿­ä»£å™¨ <code>[4,3,2,1,0]</code></p>\n</li>\n<li>\n<p>æŒ‰ <code>batch_size=2</code> å°†ç´¢å¼•åˆ†æ‰¹ï¼š</p>\n<ul>\n<li>Batch 0 â†’ <code>[4,3]</code></li>\n<li>Batch 1 â†’ <code>[2,1]</code></li>\n<li>Batch 2 â†’ <code>[0]</code></li>\n</ul>\n</li>\n<li>\n<p>å¯¹æ¯ä¸ª batch è°ƒç”¨ <code>dataset.__getitem__</code>ï¼Œè·å– <code>(x, y)</code> å¼ é‡ã€‚</p>\n</li>\n<li>\n<p>è¿”å› batch å¼ é‡ï¼š</p>\n<ul>\n<li><code>x_batch.shape = [batch_size, feature_dim]</code></li>\n<li><code>y_batch.shape = [batch_size]</code></li>\n</ul>\n</li>\n</ol>\n</li>\n<li>\n<p>DataLoader å¯ä»¥å¤šçº¿ç¨‹åŠ è½½æ•°æ®ï¼ˆé€šè¿‡ <code>num_workers</code>ï¼‰ï¼Œæå‡æ•ˆç‡ã€‚</p>\n</li>\n</ul>\n<hr>\n<h3 id=\"5ï¸âƒ£-å®šä¹‰æ¨¡å‹å’Œä¼˜åŒ–å™¨\"><a class=\"anchor\" href=\"#5ï¸âƒ£-å®šä¹‰æ¨¡å‹å’Œä¼˜åŒ–å™¨\">#</a> <strong>5ï¸âƒ£ å®šä¹‰æ¨¡å‹å’Œä¼˜åŒ–å™¨</strong></h3>\n<pre class=\"shiki shiki-themes vitesse-light vitesse-dark\" style=\"background-color:#ffffff;--shiki-dark-bg:#121212;color:#393a34;--shiki-dark:#dbd7caee\" tabindex=\"0\"><code class=\"language-python\"><span class=\"line\"><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">model </span><span style=\"color:#999999;--shiki-dark:#666666\">=</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\"> nn</span><span style=\"color:#999999;--shiki-dark:#666666\">.</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">Linear</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\">2</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\"> 2</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\">  # è¾“å…¥2ç»´ï¼Œè¾“å‡º2ç±»</span></span>\n<span class=\"line\"><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">criterion </span><span style=\"color:#999999;--shiki-dark:#666666\">=</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\"> nn</span><span style=\"color:#999999;--shiki-dark:#666666\">.</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">CrossEntropyLoss</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\">  # åˆ†ç±»æŸå¤±</span></span>\n<span class=\"line\"><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">optimizer </span><span style=\"color:#999999;--shiki-dark:#666666\">=</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\"> optim</span><span style=\"color:#999999;--shiki-dark:#666666\">.</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">SGD</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">model</span><span style=\"color:#999999;--shiki-dark:#666666\">.</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">parameters</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">(</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">)</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span><span style=\"color:#B07D48;--shiki-dark:#BD976A\"> lr</span><span style=\"color:#999999;--shiki-dark:#666666\">=</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\">0.01</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span></span></code></pre>\n<ul>\n<li>\n<p><code>nn.Linear(2,2)</code>ï¼š</p>\n<ul>\n<li>è¾“å…¥ 2 ç»´ç‰¹å¾ <code>[x1,x2]</code></li>\n<li>è¾“å‡º 2 ç±»çš„ logits</li>\n</ul>\n</li>\n<li>\n<p><code>CrossEntropyLoss</code>ï¼š</p>\n<ul>\n<li>ç”¨äºåˆ†ç±»ä»»åŠ¡</li>\n<li>å†…éƒ¨ä¼šè‡ªåŠ¨åš softmax</li>\n</ul>\n</li>\n<li>\n<p><code>SGD</code>ï¼š</p>\n<ul>\n<li>éšæœºæ¢¯åº¦ä¸‹é™ä¼˜åŒ–å™¨</li>\n<li>æ›´æ–°æ¨¡å‹å‚æ•°</li>\n</ul>\n</li>\n</ul>\n<hr>\n<h3 id=\"6ï¸âƒ£-æ¨¡æ‹Ÿè®­ç»ƒå¾ªç¯\"><a class=\"anchor\" href=\"#6ï¸âƒ£-æ¨¡æ‹Ÿè®­ç»ƒå¾ªç¯\">#</a> <strong>6ï¸âƒ£ æ¨¡æ‹Ÿè®­ç»ƒå¾ªç¯</strong></h3>\n<pre class=\"shiki shiki-themes vitesse-light vitesse-dark\" style=\"background-color:#ffffff;--shiki-dark-bg:#121212;color:#393a34;--shiki-dark:#dbd7caee\" tabindex=\"0\"><code class=\"language-python\"><span class=\"line\"><span style=\"color:#1E754F;--shiki-dark:#4D9375\">for</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\"> epoch </span><span style=\"color:#1E754F;--shiki-dark:#4D9375\">in</span><span style=\"color:#998418;--shiki-dark:#B8A965\"> range</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\">1</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span><span style=\"color:#999999;--shiki-dark:#666666\">:</span></span>\n<span class=\"line\"><span style=\"color:#1E754F;--shiki-dark:#4D9375\">    for</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\"> x_batch</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\"> y_batch </span><span style=\"color:#1E754F;--shiki-dark:#4D9375\">in</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\"> dataloader</span><span style=\"color:#999999;--shiki-dark:#666666\">:</span></span>\n<span class=\"line\"><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\">        # å‰å‘ä¼ æ’­</span></span>\n<span class=\"line\"><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">        outputs </span><span style=\"color:#999999;--shiki-dark:#666666\">=</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\"> model</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">x_batch</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\">   # [batch_size, num_classes]</span></span>\n<span class=\"line\"><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">        loss </span><span style=\"color:#999999;--shiki-dark:#666666\">=</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\"> criterion</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">outputs</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\"> y_batch</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\">        # åå‘ä¼ æ’­</span></span>\n<span class=\"line\"><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">        optimizer</span><span style=\"color:#999999;--shiki-dark:#666666\">.</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">zero_grad</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span></span>\n<span class=\"line\"><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">        loss</span><span style=\"color:#999999;--shiki-dark:#666666\">.</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">backward</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span></span>\n<span class=\"line\"><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">        optimizer</span><span style=\"color:#999999;--shiki-dark:#666666\">.</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">step</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#998418;--shiki-dark:#B8A965\">        print</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">Batch x:</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\"> x_batch</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span></span>\n<span class=\"line\"><span style=\"color:#998418;--shiki-dark:#B8A965\">        print</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">Batch y:</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\"> y_batch</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span></span>\n<span class=\"line\"><span style=\"color:#998418;--shiki-dark:#B8A965\">        print</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">Loss:</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\"> loss</span><span style=\"color:#999999;--shiki-dark:#666666\">.</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">item</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">(</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">)</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span></span></code></pre>\n<p><strong>è¯¦ç»†è§£æ</strong>ï¼š</p>\n<ol>\n<li>\n<p><code>for x_batch, y_batch in dataloader</code>ï¼š</p>\n<ul>\n<li>DataLoader è¿­ä»£ batch</li>\n<li>æ¯ä¸ª batch æ˜¯ <code>(x_batch, y_batch)</code> å¼ é‡</li>\n</ul>\n</li>\n<li>\n<p><code>outputs = model(x_batch)</code>ï¼š</p>\n<ul>\n<li>å‰å‘ä¼ æ’­ï¼Œè¾“å‡º <code>[batch_size, num_classes]</code> å¼ é‡</li>\n</ul>\n</li>\n<li>\n<p><code>loss = criterion(outputs, y_batch)</code>ï¼š</p>\n<ul>\n<li>è®¡ç®— loss</li>\n</ul>\n</li>\n<li>\n<p><code>optimizer.zero_grad()</code>ï¼š</p>\n<ul>\n<li>æ¸…ç©ºæ¢¯åº¦ï¼Œå¦åˆ™æ¢¯åº¦ä¼šç´¯åŠ </li>\n</ul>\n</li>\n<li>\n<p><code>loss.backward()</code>ï¼š</p>\n<ul>\n<li>è‡ªåŠ¨è®¡ç®—æ¢¯åº¦</li>\n</ul>\n</li>\n<li>\n<p><code>optimizer.step()</code>ï¼š</p>\n<ul>\n<li>æ›´æ–°æ¨¡å‹å‚æ•°</li>\n</ul>\n</li>\n<li>\n<p>æ‰“å° batch ä¿¡æ¯ï¼Œè§‚å¯Ÿè®­ç»ƒæ•°æ®æµå’Œ loss</p>\n</li>\n</ol>\n<p><strong>ç¤ºä¾‹è¾“å‡º</strong>ï¼ˆå€’åº batchï¼‰ï¼š</p>\n<pre class=\"shiki shiki-themes vitesse-light vitesse-dark\" style=\"background-color:#ffffff;--shiki-dark-bg:#121212;color:#393a34;--shiki-dark:#dbd7caee\" tabindex=\"0\"><code class=\"language-text\"><span class=\"line\"><span>Batch x: tensor([[ 9., 10.],</span></span>\n<span class=\"line\"><span>                 [ 7.,  8.]])</span></span>\n<span class=\"line\"><span>Batch y: tensor([0,1])</span></span>\n<span class=\"line\"><span>Loss: 0.7378</span></span>\n<span class=\"line\"><span>Batch x: tensor([[5.,6.],</span></span>\n<span class=\"line\"><span>                 [3.,4.]])</span></span>\n<span class=\"line\"><span>Batch y: tensor([0,1])</span></span>\n<span class=\"line\"><span>Loss: 0.6923</span></span>\n<span class=\"line\"><span>Batch x: tensor([[1.,2.]])</span></span>\n<span class=\"line\"><span>Batch y: tensor([0])</span></span>\n<span class=\"line\"><span>Loss: 0.6789</span></span></code></pre>\n<hr>\n<h3 id=\"7ï¸âƒ£-æ•°æ®æµå¯è§†åŒ–\"><a class=\"anchor\" href=\"#7ï¸âƒ£-æ•°æ®æµå¯è§†åŒ–\">#</a> <strong>7ï¸âƒ£ æ•°æ®æµå¯è§†åŒ–</strong></h3>\n<pre class=\"shiki shiki-themes vitesse-light vitesse-dark\" style=\"background-color:#ffffff;--shiki-dark-bg:#121212;color:#393a34;--shiki-dark:#dbd7caee\" tabindex=\"0\"><code class=\"language-text\"><span class=\"line\"><span>åŸå§‹æ•°æ®</span></span>\n<span class=\"line\"><span>data = [[1,2],[3,4],[5,6],[7,8],[9,10]]</span></span>\n<span class=\"line\"><span>labels = [0,1,0,1,0]</span></span>\n<span class=\"line\"><span>        â”‚</span></span>\n<span class=\"line\"><span>        â–¼</span></span>\n<span class=\"line\"><span>Dataset (MyDataset)</span></span>\n<span class=\"line\"><span>  - __getitem__ è¿”å›å•ä¸ªæ ·æœ¬</span></span>\n<span class=\"line\"><span>        â”‚</span></span>\n<span class=\"line\"><span>        â–¼</span></span>\n<span class=\"line\"><span>Sampler (ReverseSampler)</span></span>\n<span class=\"line\"><span>  - è¿”å›ç´¢å¼•åºåˆ— [4,3,2,1,0]</span></span>\n<span class=\"line\"><span>        â”‚</span></span>\n<span class=\"line\"><span>        â–¼</span></span>\n<span class=\"line\"><span>DataLoader (batch_size=2)</span></span>\n<span class=\"line\"><span>  - Batch 0: idx=[4,3] â†’ x=[[9,10],[7,8]], y=[0,1]</span></span>\n<span class=\"line\"><span>  - Batch 1: idx=[2,1] â†’ x=[[5,6],[3,4]], y=[0,1]</span></span>\n<span class=\"line\"><span>  - Batch 2: idx=[0]   â†’ x=[[1,2]], y=[0]</span></span>\n<span class=\"line\"><span>        â”‚</span></span>\n<span class=\"line\"><span>        â–¼</span></span>\n<span class=\"line\"><span>æ¨¡å‹è®­ç»ƒ</span></span>\n<span class=\"line\"><span>  - å‰å‘ä¼ æ’­: y_pred = model(x_batch)</span></span>\n<span class=\"line\"><span>  - è®¡ç®— loss</span></span>\n<span class=\"line\"><span>  - åå‘ä¼ æ’­: loss.backward()</span></span>\n<span class=\"line\"><span>  - å‚æ•°æ›´æ–°: optimizer.step()</span></span></code></pre>\n<p>ğŸ’¡ <strong>å…³é”®ç‚¹</strong>ï¼š</p>\n<ol>\n<li>Dataset â†’ ç®¡ç†åŸå§‹æ•°æ®å’Œå–æ ·æ–¹æ³•</li>\n<li>Sampler â†’ å†³å®šç´¢å¼•é¡ºåº</li>\n<li>DataLoader â†’ æŒ‰ batch èšåˆæ•°æ®</li>\n<li>æ¨¡å‹è®­ç»ƒ â†’ æ¥æ”¶ batchï¼Œè®¡ç®—æ¢¯åº¦ï¼Œæ›´æ–°å‚æ•°</li>\n</ol>\n",
            "tags": [
                "dataset",
                "deeplearning",
                "pytorch",
                "dataloader"
            ]
        }
    ]
}