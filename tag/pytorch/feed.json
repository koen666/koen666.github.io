{
    "version": "https://jsonfeed.org/version/1",
    "title": "æœ¨è¯­ â€¢ All posts by \"pytorch\" tag",
    "description": "Spark!",
    "home_page_url": "http://example.com",
    "items": [
        {
            "id": "http://example.com/2025/09/15/%E4%BB%8Edataset%E5%88%B0dataloader/",
            "url": "http://example.com/2025/09/15/%E4%BB%8Edataset%E5%88%B0dataloader/",
            "title": "ä»dataset->dataloader",
            "date_published": "2025-09-14T16:00:00.000Z",
            "content_html": "<h2 id=\"dataset-dataloader\"><a class=\"anchor\" href=\"#dataset-dataloader\">#</a> <strong>dataset-&gt;dataloader</strong></h2>\n<pre class=\"shiki shiki-themes vitesse-light vitesse-dark\" style=\"background-color:#ffffff;--shiki-dark-bg:#121212;color:#393a34;--shiki-dark:#dbd7caee\" tabindex=\"0\"><code class=\"language-python\"><span class=\"line\"><span style=\"color:#1E754F;--shiki-dark:#4D9375\">import</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\"> torch</span></span>\n<span class=\"line\"><span style=\"color:#1E754F;--shiki-dark:#4D9375\">from</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\"> torch</span><span style=\"color:#999999;--shiki-dark:#666666\">.</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">utils</span><span style=\"color:#999999;--shiki-dark:#666666\">.</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">data </span><span style=\"color:#1E754F;--shiki-dark:#4D9375\">import</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\"> Dataset</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\"> DataLoader</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\"> Sampler</span></span>\n<span class=\"line\"><span style=\"color:#1E754F;--shiki-dark:#4D9375\">import</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\"> torch</span><span style=\"color:#999999;--shiki-dark:#666666\">.</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">nn </span><span style=\"color:#1E754F;--shiki-dark:#4D9375\">as</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\"> nn</span></span>\n<span class=\"line\"><span style=\"color:#1E754F;--shiki-dark:#4D9375\">import</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\"> torch</span><span style=\"color:#999999;--shiki-dark:#666666\">.</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">optim </span><span style=\"color:#1E754F;--shiki-dark:#4D9375\">as</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\"> optim</span></span></code></pre>\n<p><strong>è§£æ</strong>ï¼š</p>\n<ul>\n<li><code>torch</code>ï¼šPyTorch ä¸»åº“ï¼Œç”¨äºå¼ é‡æ“ä½œã€‚</li>\n<li><code>Dataset</code>ï¼šæ•°æ®é›†åŸºç±»ã€‚</li>\n<li><code>DataLoader</code>ï¼šæ‰¹æ¬¡ç”Ÿæˆå™¨ã€‚</li>\n<li><code>Sampler</code>ï¼šç´¢å¼•ç”Ÿæˆå™¨ã€‚</li>\n<li><code>nn</code>ï¼šç¥ç»ç½‘ç»œæ¨¡å—ã€‚</li>\n<li><code>optim</code>ï¼šä¼˜åŒ–å™¨ã€‚</li>\n</ul>\n<hr>\n<h3 id=\"1ï¸âƒ£-å®šä¹‰-dataset\"><a class=\"anchor\" href=\"#1ï¸âƒ£-å®šä¹‰-dataset\">#</a> <strong>1ï¸âƒ£ å®šä¹‰ Dataset</strong></h3>\n<pre class=\"shiki shiki-themes vitesse-light vitesse-dark\" style=\"background-color:#ffffff;--shiki-dark-bg:#121212;color:#393a34;--shiki-dark:#dbd7caee\" tabindex=\"0\"><code class=\"language-python\"><span class=\"line\"><span style=\"color:#AB5959;--shiki-dark:#CB7676\">class</span><span style=\"color:#2E8F82;--shiki-dark:#5DA994\"> MyDataset</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#59873A;--shiki-dark:#80A665\">Dataset</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span><span style=\"color:#999999;--shiki-dark:#666666\">:</span></span>\n<span class=\"line\"><span style=\"color:#AB5959;--shiki-dark:#CB7676\">    def</span><span style=\"color:#998418;--shiki-dark:#B8A965\"> __init__</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">self</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\"> data</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\"> labels</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span><span style=\"color:#999999;--shiki-dark:#666666\">:</span></span>\n<span class=\"line\"><span style=\"color:#A65E2B;--shiki-dark:#C99076\">        self</span><span style=\"color:#999999;--shiki-dark:#666666\">.</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">data </span><span style=\"color:#999999;--shiki-dark:#666666\">=</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\"> data       </span><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\"># å­˜å‚¨ç‰¹å¾åˆ—è¡¨</span></span>\n<span class=\"line\"><span style=\"color:#A65E2B;--shiki-dark:#C99076\">        self</span><span style=\"color:#999999;--shiki-dark:#666666\">.</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">labels </span><span style=\"color:#999999;--shiki-dark:#666666\">=</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\"> labels   </span><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\"># å­˜å‚¨æ ‡ç­¾åˆ—è¡¨</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#AB5959;--shiki-dark:#CB7676\">    def</span><span style=\"color:#998418;--shiki-dark:#B8A965\"> __len__</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">self</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span><span style=\"color:#999999;--shiki-dark:#666666\">:</span></span>\n<span class=\"line\"><span style=\"color:#1E754F;--shiki-dark:#4D9375\">        return</span><span style=\"color:#998418;--shiki-dark:#B8A965\"> len</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#A65E2B;--shiki-dark:#C99076\">self</span><span style=\"color:#999999;--shiki-dark:#666666\">.</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">data</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\">  # è¿”å›æ ·æœ¬æ€»æ•°</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#AB5959;--shiki-dark:#CB7676\">    def</span><span style=\"color:#998418;--shiki-dark:#B8A965\"> __getitem__</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">self</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\"> index</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span><span style=\"color:#999999;--shiki-dark:#666666\">:</span></span>\n<span class=\"line\"><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">        x </span><span style=\"color:#999999;--shiki-dark:#666666\">=</span><span style=\"color:#A65E2B;--shiki-dark:#C99076\"> self</span><span style=\"color:#999999;--shiki-dark:#666666\">.</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">data</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">[</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">index</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">]</span><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\">  # å–ç¬¬ index ä¸ªç‰¹å¾</span></span>\n<span class=\"line\"><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">        y </span><span style=\"color:#999999;--shiki-dark:#666666\">=</span><span style=\"color:#A65E2B;--shiki-dark:#C99076\"> self</span><span style=\"color:#999999;--shiki-dark:#666666\">.</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">labels</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">[</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">index</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">]</span><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\">  # å–ç¬¬ index ä¸ªæ ‡ç­¾</span></span>\n<span class=\"line\"><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\">        # è½¬ä¸º tensor å¹¶æŒ‡å®šæ•°æ®ç±»å‹</span></span>\n<span class=\"line\"><span style=\"color:#1E754F;--shiki-dark:#4D9375\">        return</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\"> torch</span><span style=\"color:#999999;--shiki-dark:#666666\">.</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">tensor</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">x</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span><span style=\"color:#B07D48;--shiki-dark:#BD976A\"> dtype</span><span style=\"color:#999999;--shiki-dark:#666666\">=</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">torch</span><span style=\"color:#999999;--shiki-dark:#666666\">.</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">float32</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\"> torch</span><span style=\"color:#999999;--shiki-dark:#666666\">.</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">tensor</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">y</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span><span style=\"color:#B07D48;--shiki-dark:#BD976A\"> dtype</span><span style=\"color:#999999;--shiki-dark:#666666\">=</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">torch</span><span style=\"color:#999999;--shiki-dark:#666666\">.</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">long</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span></span></code></pre>\n<p><strong>è¯¦ç»†è§£æ</strong>ï¼š</p>\n<ol>\n<li>\n<p><code>__init__</code>ï¼šåˆå§‹åŒ– Dataset å¯¹è±¡ï¼Œå­˜å‚¨æ•°æ®å’Œæ ‡ç­¾ã€‚</p>\n</li>\n<li>\n<p><code>__len__</code>ï¼šDataset çš„é•¿åº¦ï¼ˆæ ·æœ¬æ•°ï¼‰ï¼ŒDataLoader å†…éƒ¨ä¼šç”¨å®ƒæ¥è®¡ç®— batch æ•°é‡ã€‚</p>\n</li>\n<li>\n<p><code>__getitem__</code>ï¼š</p>\n<ul>\n<li>\n<p>æ¥æ”¶ä¸€ä¸ªæ•´æ•° <code>index</code>ã€‚</p>\n</li>\n<li>\n<p>ä»åˆ—è¡¨ä¸­å–æ•°æ®å’Œæ ‡ç­¾ã€‚</p>\n</li>\n<li>\n<p>è½¬ä¸º PyTorch å¼ é‡ï¼š</p>\n<ul>\n<li><code>x</code> â†’ float32ï¼Œç”¨äºè®¡ç®—ã€‚</li>\n<li><code>y</code> â†’ longï¼Œç”¨äºåˆ†ç±»ä»»åŠ¡çš„ CrossEntropyLossã€‚</li>\n</ul>\n</li>\n<li>\n<p>è¿”å› <code>(x, y)</code> å…ƒç»„ã€‚</p>\n</li>\n</ul>\n</li>\n<li>\n<p><strong>å…³é”®ç‚¹</strong>ï¼šDataset æœ¬èº«ä¸å¤„ç† batchï¼Œä¹Ÿä¸å†³å®šé¡ºåºï¼Œå®ƒåªçŸ¥é“å¦‚ä½•æ ¹æ®ç´¢å¼•å–å•ä¸ªæ ·æœ¬ã€‚</p>\n</li>\n</ol>\n<hr>\n<h3 id=\"2ï¸âƒ£-å®šä¹‰-sampler\"><a class=\"anchor\" href=\"#2ï¸âƒ£-å®šä¹‰-sampler\">#</a> <strong>2ï¸âƒ£ å®šä¹‰ Sampler</strong></h3>\n<pre class=\"shiki shiki-themes vitesse-light vitesse-dark\" style=\"background-color:#ffffff;--shiki-dark-bg:#121212;color:#393a34;--shiki-dark:#dbd7caee\" tabindex=\"0\"><code class=\"language-python\"><span class=\"line\"><span style=\"color:#AB5959;--shiki-dark:#CB7676\">class</span><span style=\"color:#2E8F82;--shiki-dark:#5DA994\"> ReverseSampler</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#59873A;--shiki-dark:#80A665\">Sampler</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span><span style=\"color:#999999;--shiki-dark:#666666\">:</span></span>\n<span class=\"line\"><span style=\"color:#AB5959;--shiki-dark:#CB7676\">    def</span><span style=\"color:#998418;--shiki-dark:#B8A965\"> __init__</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">self</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\"> data_source</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span><span style=\"color:#999999;--shiki-dark:#666666\">:</span></span>\n<span class=\"line\"><span style=\"color:#A65E2B;--shiki-dark:#C99076\">        self</span><span style=\"color:#999999;--shiki-dark:#666666\">.</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">data_source </span><span style=\"color:#999999;--shiki-dark:#666666\">=</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\"> data_source  </span><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\"># Dataset å¯¹è±¡</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#AB5959;--shiki-dark:#CB7676\">    def</span><span style=\"color:#998418;--shiki-dark:#B8A965\"> __iter__</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">self</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span><span style=\"color:#999999;--shiki-dark:#666666\">:</span></span>\n<span class=\"line\"><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\">        # è¿”å›ç´¢å¼•è¿­ä»£å™¨ï¼šå€’åºå–æ ·</span></span>\n<span class=\"line\"><span style=\"color:#1E754F;--shiki-dark:#4D9375\">        return</span><span style=\"color:#998418;--shiki-dark:#B8A965\"> iter</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#998418;--shiki-dark:#B8A965\">range</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">(</span><span style=\"color:#998418;--shiki-dark:#B8A965\">len</span><span style=\"color:#a65e2b;--shiki-dark:#d4976c\">(</span><span style=\"color:#A65E2B;--shiki-dark:#C99076\">self</span><span style=\"color:#999999;--shiki-dark:#666666\">.</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">data_source</span><span style=\"color:#a65e2b;--shiki-dark:#d4976c\">)</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\">-</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\">1</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\"> -</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\">1</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\"> -</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\">1</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">)</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#AB5959;--shiki-dark:#CB7676\">    def</span><span style=\"color:#998418;--shiki-dark:#B8A965\"> __len__</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">self</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span><span style=\"color:#999999;--shiki-dark:#666666\">:</span></span>\n<span class=\"line\"><span style=\"color:#1E754F;--shiki-dark:#4D9375\">        return</span><span style=\"color:#998418;--shiki-dark:#B8A965\"> len</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#A65E2B;--shiki-dark:#C99076\">self</span><span style=\"color:#999999;--shiki-dark:#666666\">.</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">data_source</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\">  # æ ·æœ¬æ€»æ•°</span></span></code></pre>\n<p><strong>è¯¦ç»†è§£æ</strong>ï¼š</p>\n<ol>\n<li>\n<p><code>__iter__</code>ï¼š</p>\n<ul>\n<li>\n<p>è¿”å›ä¸€ä¸ªè¿­ä»£å™¨ï¼Œç”¨äºç”Ÿæˆç´¢å¼•åºåˆ—ã€‚</p>\n</li>\n<li>\n<p><code>range(len(self.data_source)-1, -1, -1)</code>ï¼š</p>\n<ul>\n<li>ä»æœ€å¤§ç´¢å¼•åˆ° 0</li>\n<li>ä¾‹å¦‚æ•°æ®æœ‰ 5 ä¸ªæ ·æœ¬ï¼Œç´¢å¼•é¡ºåºæ˜¯ <code>[4,3,2,1,0]</code></li>\n</ul>\n</li>\n</ul>\n</li>\n<li>\n<p><code>__len__</code>ï¼š</p>\n<ul>\n<li>è¿”å› Dataset é•¿åº¦</li>\n<li>DataLoader å†…éƒ¨å¯èƒ½ç”¨å®ƒè®¡ç®— batch æ€»æ•°æˆ–è¿›åº¦æ¡ã€‚</li>\n</ul>\n</li>\n<li>\n<p><strong>å…³é”®ç‚¹</strong>ï¼š</p>\n<ul>\n<li>Sampler åªè´Ÿè´£â€œç´¢å¼•é¡ºåºâ€ï¼Œä¸æ¶‰åŠæ•°æ®æœ¬èº«ã€‚</li>\n<li>å¯ä»¥ç”¨å®ƒå®ç°é¡ºåºã€éšæœºæˆ–è‡ªå®šä¹‰é‡‡æ ·ç­–ç•¥ã€‚</li>\n</ul>\n</li>\n</ol>\n<hr>\n<h3 id=\"3ï¸âƒ£-åˆå§‹åŒ–-dataset-å’Œ-sampler\"><a class=\"anchor\" href=\"#3ï¸âƒ£-åˆå§‹åŒ–-dataset-å’Œ-sampler\">#</a> <strong>3ï¸âƒ£ åˆå§‹åŒ– Dataset å’Œ Sampler</strong></h3>\n<pre class=\"shiki shiki-themes vitesse-light vitesse-dark\" style=\"background-color:#ffffff;--shiki-dark-bg:#121212;color:#393a34;--shiki-dark:#dbd7caee\" tabindex=\"0\"><code class=\"language-python\"><span class=\"line\"><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">data </span><span style=\"color:#999999;--shiki-dark:#666666\">=</span><span style=\"color:#999999;--shiki-dark:#666666\"> </span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">[</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">[</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\">1</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\">2</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">]</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span><span style=\"color:#999999;--shiki-dark:#666666\"> </span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">[</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\">3</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\">4</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">]</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span><span style=\"color:#999999;--shiki-dark:#666666\"> </span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">[</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\">5</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\">6</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">]</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span><span style=\"color:#999999;--shiki-dark:#666666\"> </span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">[</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\">7</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\">8</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">]</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span><span style=\"color:#999999;--shiki-dark:#666666\"> </span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">[</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\">9</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\">10</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">]</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">]</span></span>\n<span class=\"line\"><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">labels </span><span style=\"color:#999999;--shiki-dark:#666666\">=</span><span style=\"color:#999999;--shiki-dark:#666666\"> </span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">[</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\">0</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\"> 1</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\"> 0</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\"> 1</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\"> 0</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">]</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">dataset </span><span style=\"color:#999999;--shiki-dark:#666666\">=</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\"> MyDataset</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">data</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\"> labels</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span></span>\n<span class=\"line\"><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">sampler </span><span style=\"color:#999999;--shiki-dark:#666666\">=</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\"> ReverseSampler</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">dataset</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span></span></code></pre>\n<ul>\n<li>\n<p>Dataset ä¿å­˜åŸå§‹æ•°æ®ã€‚</p>\n</li>\n<li>\n<p>Sampler å®šä¹‰ç´¢å¼•é¡ºåºï¼ˆå€’åºï¼‰ã€‚</p>\n</li>\n<li>\n<p>æ­¤æ—¶æ•°æ®å’Œç´¢å¼•æ˜¯åˆ†å¼€çš„ï¼š</p>\n<pre class=\"shiki shiki-themes vitesse-light vitesse-dark\" style=\"background-color:#ffffff;--shiki-dark-bg:#121212;color:#393a34;--shiki-dark:#dbd7caee\" tabindex=\"0\"><code class=\"language-text\"><span class=\"line\"><span>Dataset: [ [1,2], [3,4], [5,6], [7,8], [9,10] ]</span></span>\n<span class=\"line\"><span>Sampler: [4,3,2,1,0]</span></span></code></pre>\n</li>\n</ul>\n<hr>\n<h3 id=\"4ï¸âƒ£-å®šä¹‰-dataloader\"><a class=\"anchor\" href=\"#4ï¸âƒ£-å®šä¹‰-dataloader\">#</a> <strong>4ï¸âƒ£ å®šä¹‰ DataLoader</strong></h3>\n<pre class=\"shiki shiki-themes vitesse-light vitesse-dark\" style=\"background-color:#ffffff;--shiki-dark-bg:#121212;color:#393a34;--shiki-dark:#dbd7caee\" tabindex=\"0\"><code class=\"language-python\"><span class=\"line\"><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">batch_size </span><span style=\"color:#999999;--shiki-dark:#666666\">=</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\"> 2</span></span>\n<span class=\"line\"><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">dataloader </span><span style=\"color:#999999;--shiki-dark:#666666\">=</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\"> DataLoader</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">dataset</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span><span style=\"color:#B07D48;--shiki-dark:#BD976A\"> batch_size</span><span style=\"color:#999999;--shiki-dark:#666666\">=</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">batch_size</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span><span style=\"color:#B07D48;--shiki-dark:#BD976A\"> sampler</span><span style=\"color:#999999;--shiki-dark:#666666\">=</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">sampler</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span></span></code></pre>\n<p><strong>è¯¦ç»†è§£æ</strong>ï¼š</p>\n<ul>\n<li>\n<p>DataLoader æ¥æ”¶ Dataset å¯¹è±¡ã€‚</p>\n</li>\n<li>\n<p><code>batch_size=2</code> â†’ æ¯ä¸ª batch 2 ä¸ªæ ·æœ¬ã€‚</p>\n</li>\n<li>\n<p><code>sampler=sampler</code> â†’ ä½¿ç”¨æˆ‘ä»¬è‡ªå®šä¹‰çš„å€’åºç´¢å¼•ã€‚</p>\n</li>\n<li>\n<p><strong>å†…éƒ¨æµç¨‹</strong>ï¼š</p>\n<ol>\n<li>\n<p>DataLoader è°ƒç”¨ <code>sampler.__iter__()</code> â†’ å¾—åˆ°ç´¢å¼•è¿­ä»£å™¨ <code>[4,3,2,1,0]</code></p>\n</li>\n<li>\n<p>æŒ‰ <code>batch_size=2</code> å°†ç´¢å¼•åˆ†æ‰¹ï¼š</p>\n<ul>\n<li>Batch 0 â†’ <code>[4,3]</code></li>\n<li>Batch 1 â†’ <code>[2,1]</code></li>\n<li>Batch 2 â†’ <code>[0]</code></li>\n</ul>\n</li>\n<li>\n<p>å¯¹æ¯ä¸ª batch è°ƒç”¨ <code>dataset.__getitem__</code>ï¼Œè·å– <code>(x, y)</code> å¼ é‡ã€‚</p>\n</li>\n<li>\n<p>è¿”å› batch å¼ é‡ï¼š</p>\n<ul>\n<li><code>x_batch.shape = [batch_size, feature_dim]</code></li>\n<li><code>y_batch.shape = [batch_size]</code></li>\n</ul>\n</li>\n</ol>\n</li>\n<li>\n<p>DataLoader å¯ä»¥å¤šçº¿ç¨‹åŠ è½½æ•°æ®ï¼ˆé€šè¿‡ <code>num_workers</code>ï¼‰ï¼Œæå‡æ•ˆç‡ã€‚</p>\n</li>\n</ul>\n<hr>\n<h3 id=\"5ï¸âƒ£-å®šä¹‰æ¨¡å‹å’Œä¼˜åŒ–å™¨\"><a class=\"anchor\" href=\"#5ï¸âƒ£-å®šä¹‰æ¨¡å‹å’Œä¼˜åŒ–å™¨\">#</a> <strong>5ï¸âƒ£ å®šä¹‰æ¨¡å‹å’Œä¼˜åŒ–å™¨</strong></h3>\n<pre class=\"shiki shiki-themes vitesse-light vitesse-dark\" style=\"background-color:#ffffff;--shiki-dark-bg:#121212;color:#393a34;--shiki-dark:#dbd7caee\" tabindex=\"0\"><code class=\"language-python\"><span class=\"line\"><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">model </span><span style=\"color:#999999;--shiki-dark:#666666\">=</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\"> nn</span><span style=\"color:#999999;--shiki-dark:#666666\">.</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">Linear</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\">2</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\"> 2</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\">  # è¾“å…¥2ç»´ï¼Œè¾“å‡º2ç±»</span></span>\n<span class=\"line\"><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">criterion </span><span style=\"color:#999999;--shiki-dark:#666666\">=</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\"> nn</span><span style=\"color:#999999;--shiki-dark:#666666\">.</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">CrossEntropyLoss</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\">  # åˆ†ç±»æŸå¤±</span></span>\n<span class=\"line\"><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">optimizer </span><span style=\"color:#999999;--shiki-dark:#666666\">=</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\"> optim</span><span style=\"color:#999999;--shiki-dark:#666666\">.</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">SGD</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">model</span><span style=\"color:#999999;--shiki-dark:#666666\">.</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">parameters</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">(</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">)</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span><span style=\"color:#B07D48;--shiki-dark:#BD976A\"> lr</span><span style=\"color:#999999;--shiki-dark:#666666\">=</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\">0.01</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span></span></code></pre>\n<ul>\n<li>\n<p><code>nn.Linear(2,2)</code>ï¼š</p>\n<ul>\n<li>è¾“å…¥ 2 ç»´ç‰¹å¾ <code>[x1,x2]</code></li>\n<li>è¾“å‡º 2 ç±»çš„ logits</li>\n</ul>\n</li>\n<li>\n<p><code>CrossEntropyLoss</code>ï¼š</p>\n<ul>\n<li>ç”¨äºåˆ†ç±»ä»»åŠ¡</li>\n<li>å†…éƒ¨ä¼šè‡ªåŠ¨åš softmax</li>\n</ul>\n</li>\n<li>\n<p><code>SGD</code>ï¼š</p>\n<ul>\n<li>éšæœºæ¢¯åº¦ä¸‹é™ä¼˜åŒ–å™¨</li>\n<li>æ›´æ–°æ¨¡å‹å‚æ•°</li>\n</ul>\n</li>\n</ul>\n<hr>\n<h3 id=\"6ï¸âƒ£-æ¨¡æ‹Ÿè®­ç»ƒå¾ªç¯\"><a class=\"anchor\" href=\"#6ï¸âƒ£-æ¨¡æ‹Ÿè®­ç»ƒå¾ªç¯\">#</a> <strong>6ï¸âƒ£ æ¨¡æ‹Ÿè®­ç»ƒå¾ªç¯</strong></h3>\n<pre class=\"shiki shiki-themes vitesse-light vitesse-dark\" style=\"background-color:#ffffff;--shiki-dark-bg:#121212;color:#393a34;--shiki-dark:#dbd7caee\" tabindex=\"0\"><code class=\"language-python\"><span class=\"line\"><span style=\"color:#1E754F;--shiki-dark:#4D9375\">for</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\"> epoch </span><span style=\"color:#1E754F;--shiki-dark:#4D9375\">in</span><span style=\"color:#998418;--shiki-dark:#B8A965\"> range</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\">1</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span><span style=\"color:#999999;--shiki-dark:#666666\">:</span></span>\n<span class=\"line\"><span style=\"color:#1E754F;--shiki-dark:#4D9375\">    for</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\"> x_batch</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\"> y_batch </span><span style=\"color:#1E754F;--shiki-dark:#4D9375\">in</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\"> dataloader</span><span style=\"color:#999999;--shiki-dark:#666666\">:</span></span>\n<span class=\"line\"><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\">        # å‰å‘ä¼ æ’­</span></span>\n<span class=\"line\"><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">        outputs </span><span style=\"color:#999999;--shiki-dark:#666666\">=</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\"> model</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">x_batch</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\">   # [batch_size, num_classes]</span></span>\n<span class=\"line\"><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">        loss </span><span style=\"color:#999999;--shiki-dark:#666666\">=</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\"> criterion</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">outputs</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\"> y_batch</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\">        # åå‘ä¼ æ’­</span></span>\n<span class=\"line\"><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">        optimizer</span><span style=\"color:#999999;--shiki-dark:#666666\">.</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">zero_grad</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span></span>\n<span class=\"line\"><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">        loss</span><span style=\"color:#999999;--shiki-dark:#666666\">.</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">backward</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span></span>\n<span class=\"line\"><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">        optimizer</span><span style=\"color:#999999;--shiki-dark:#666666\">.</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">step</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#998418;--shiki-dark:#B8A965\">        print</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">Batch x:</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\"> x_batch</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span></span>\n<span class=\"line\"><span style=\"color:#998418;--shiki-dark:#B8A965\">        print</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">Batch y:</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\"> y_batch</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span></span>\n<span class=\"line\"><span style=\"color:#998418;--shiki-dark:#B8A965\">        print</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">Loss:</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\"> loss</span><span style=\"color:#999999;--shiki-dark:#666666\">.</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">item</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">(</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">)</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span></span></code></pre>\n<p><strong>è¯¦ç»†è§£æ</strong>ï¼š</p>\n<ol>\n<li>\n<p><code>for x_batch, y_batch in dataloader</code>ï¼š</p>\n<ul>\n<li>DataLoader è¿­ä»£ batch</li>\n<li>æ¯ä¸ª batch æ˜¯ <code>(x_batch, y_batch)</code> å¼ é‡</li>\n</ul>\n</li>\n<li>\n<p><code>outputs = model(x_batch)</code>ï¼š</p>\n<ul>\n<li>å‰å‘ä¼ æ’­ï¼Œè¾“å‡º <code>[batch_size, num_classes]</code> å¼ é‡</li>\n</ul>\n</li>\n<li>\n<p><code>loss = criterion(outputs, y_batch)</code>ï¼š</p>\n<ul>\n<li>è®¡ç®— loss</li>\n</ul>\n</li>\n<li>\n<p><code>optimizer.zero_grad()</code>ï¼š</p>\n<ul>\n<li>æ¸…ç©ºæ¢¯åº¦ï¼Œå¦åˆ™æ¢¯åº¦ä¼šç´¯åŠ </li>\n</ul>\n</li>\n<li>\n<p><code>loss.backward()</code>ï¼š</p>\n<ul>\n<li>è‡ªåŠ¨è®¡ç®—æ¢¯åº¦</li>\n</ul>\n</li>\n<li>\n<p><code>optimizer.step()</code>ï¼š</p>\n<ul>\n<li>æ›´æ–°æ¨¡å‹å‚æ•°</li>\n</ul>\n</li>\n<li>\n<p>æ‰“å° batch ä¿¡æ¯ï¼Œè§‚å¯Ÿè®­ç»ƒæ•°æ®æµå’Œ loss</p>\n</li>\n</ol>\n<p><strong>ç¤ºä¾‹è¾“å‡º</strong>ï¼ˆå€’åº batchï¼‰ï¼š</p>\n<pre class=\"shiki shiki-themes vitesse-light vitesse-dark\" style=\"background-color:#ffffff;--shiki-dark-bg:#121212;color:#393a34;--shiki-dark:#dbd7caee\" tabindex=\"0\"><code class=\"language-text\"><span class=\"line\"><span>Batch x: tensor([[ 9., 10.],</span></span>\n<span class=\"line\"><span>                 [ 7.,  8.]])</span></span>\n<span class=\"line\"><span>Batch y: tensor([0,1])</span></span>\n<span class=\"line\"><span>Loss: 0.7378</span></span>\n<span class=\"line\"><span>Batch x: tensor([[5.,6.],</span></span>\n<span class=\"line\"><span>                 [3.,4.]])</span></span>\n<span class=\"line\"><span>Batch y: tensor([0,1])</span></span>\n<span class=\"line\"><span>Loss: 0.6923</span></span>\n<span class=\"line\"><span>Batch x: tensor([[1.,2.]])</span></span>\n<span class=\"line\"><span>Batch y: tensor([0])</span></span>\n<span class=\"line\"><span>Loss: 0.6789</span></span></code></pre>\n<hr>\n<h3 id=\"7ï¸âƒ£-æ•°æ®æµå¯è§†åŒ–\"><a class=\"anchor\" href=\"#7ï¸âƒ£-æ•°æ®æµå¯è§†åŒ–\">#</a> <strong>7ï¸âƒ£ æ•°æ®æµå¯è§†åŒ–</strong></h3>\n<pre class=\"shiki shiki-themes vitesse-light vitesse-dark\" style=\"background-color:#ffffff;--shiki-dark-bg:#121212;color:#393a34;--shiki-dark:#dbd7caee\" tabindex=\"0\"><code class=\"language-text\"><span class=\"line\"><span>åŸå§‹æ•°æ®</span></span>\n<span class=\"line\"><span>data = [[1,2],[3,4],[5,6],[7,8],[9,10]]</span></span>\n<span class=\"line\"><span>labels = [0,1,0,1,0]</span></span>\n<span class=\"line\"><span>        â”‚</span></span>\n<span class=\"line\"><span>        â–¼</span></span>\n<span class=\"line\"><span>Dataset (MyDataset)</span></span>\n<span class=\"line\"><span>  - __getitem__ è¿”å›å•ä¸ªæ ·æœ¬</span></span>\n<span class=\"line\"><span>        â”‚</span></span>\n<span class=\"line\"><span>        â–¼</span></span>\n<span class=\"line\"><span>Sampler (ReverseSampler)</span></span>\n<span class=\"line\"><span>  - è¿”å›ç´¢å¼•åºåˆ— [4,3,2,1,0]</span></span>\n<span class=\"line\"><span>        â”‚</span></span>\n<span class=\"line\"><span>        â–¼</span></span>\n<span class=\"line\"><span>DataLoader (batch_size=2)</span></span>\n<span class=\"line\"><span>  - Batch 0: idx=[4,3] â†’ x=[[9,10],[7,8]], y=[0,1]</span></span>\n<span class=\"line\"><span>  - Batch 1: idx=[2,1] â†’ x=[[5,6],[3,4]], y=[0,1]</span></span>\n<span class=\"line\"><span>  - Batch 2: idx=[0]   â†’ x=[[1,2]], y=[0]</span></span>\n<span class=\"line\"><span>        â”‚</span></span>\n<span class=\"line\"><span>        â–¼</span></span>\n<span class=\"line\"><span>æ¨¡å‹è®­ç»ƒ</span></span>\n<span class=\"line\"><span>  - å‰å‘ä¼ æ’­: y_pred = model(x_batch)</span></span>\n<span class=\"line\"><span>  - è®¡ç®— loss</span></span>\n<span class=\"line\"><span>  - åå‘ä¼ æ’­: loss.backward()</span></span>\n<span class=\"line\"><span>  - å‚æ•°æ›´æ–°: optimizer.step()</span></span></code></pre>\n<p>ğŸ’¡ <strong>å…³é”®ç‚¹</strong>ï¼š</p>\n<ol>\n<li>Dataset â†’ ç®¡ç†åŸå§‹æ•°æ®å’Œå–æ ·æ–¹æ³•</li>\n<li>Sampler â†’ å†³å®šç´¢å¼•é¡ºåº</li>\n<li>DataLoader â†’ æŒ‰ batch èšåˆæ•°æ®</li>\n<li>æ¨¡å‹è®­ç»ƒ â†’ æ¥æ”¶ batchï¼Œè®¡ç®—æ¢¯åº¦ï¼Œæ›´æ–°å‚æ•°</li>\n</ol>\n",
            "tags": [
                "deeplearning",
                "pytorch",
                "dataset",
                "dataloader"
            ]
        },
        {
            "id": "http://example.com/2025/07/26/pytorch/",
            "url": "http://example.com/2025/07/26/pytorch/",
            "title": "Pytorchï¼Œæ·±åº¦å­¦ä¹ ä¸ç¥ç»ç½‘ç»œç¯‡",
            "date_published": "2025-07-26T08:06:04.469Z",
            "content_html": "<p>é¦–å…ˆç»™å¤§å®¶ä»‹ç»ä¸€ä¸‹æ·±åº¦å­¦ä¹ çš„åŸºæœ¬æ¡†æ¶</p>\n<p>æ·±åº¦å­¦ä¹ æ˜¯ä»¥ç¥ç»ç½‘ç»œä¸ºåŸºç¡€çš„æœºå™¨å­¦ä¹ æ–¹æ³•ï¼Œå…¶ä¸­åŒ…æ‹¬å¤šç§ç½‘ç»œç»“æ„ï¼ˆå¦‚ FNNã€CNNã€RNNã€Transformer ç­‰ï¼‰ï¼Œ<br>\nè¿™äº›åŸºç¡€ç»“æ„æ„æˆäº†å®ç°å„ç§åŠŸèƒ½æ€§æ¨¡å‹çš„æ ¸å¿ƒæ¨¡å—ï¼Œä¾‹å¦‚ï¼š</p>\n<p><img loading=\"lazy\" src=\"/images/pytorch/GAN.png\" alt=\"GANï¼ˆç”Ÿæˆå¯¹æŠ—ç½‘ç»œï¼‰\"></p>\n<p><img loading=\"lazy\" src=\"/images/pytorch/Auto-encoder.png\" alt=\"Auto-Encoderï¼ˆè‡ªç¼–ç å™¨ï¼‰\"></p>\n<p>VAEï¼ˆå˜åˆ†è‡ªç¼–ç å™¨ï¼‰</p>\n<p>BERTã€GPT ç­‰é¢„è®­ç»ƒæ¨¡å‹</p>\n<p>åŸºç¡€ç»“æ„ï¼ˆNetwork Architecturesï¼‰</p>\n<ul>\n<li>FNNï¼ˆå‰é¦ˆç¥ç»ç½‘ç»œï¼‰</li>\n<li>CNNï¼ˆå·ç§¯ç¥ç»ç½‘ç»œï¼‰</li>\n<li>RNNï¼ˆå¾ªç¯ç¥ç»ç½‘ç»œï¼‰</li>\n<li>Transformerï¼ˆæ³¨æ„åŠ›æœºåˆ¶ä¸ºæ ¸å¿ƒï¼‰</li>\n</ul>\n<p>åŠŸèƒ½æ€§æ¨¡å‹ï¼ˆFunctional Models / Applicationsï¼‰</p>\n<ul>\n<li>è‡ªç¼–ç å™¨ Auto-Encoderï¼ˆFNN/CNNï¼‰</li>\n<li>ç”Ÿæˆå¯¹æŠ—ç½‘ç»œ GANï¼ˆFNN/CNNï¼‰</li>\n<li>å˜åˆ†è‡ªç¼–ç å™¨ VAEï¼ˆFNNï¼‰</li>\n<li>å¼ºåŒ–å­¦ä¹ ç­–ç•¥ç½‘ç»œï¼ˆFNN/RNNï¼‰</li>\n<li>GPTã€BERT ç­‰ NLP æ¨¡å‹ï¼ˆTransformerï¼‰</li>\n<li>å…¶ä»–ä»»åŠ¡æ¨¡å‹\n<ul>\n<li>UNet</li>\n<li>ResNet</li>\n<li>YOLO</li>\n</ul>\n</li>\n</ul>\n<h2 id=\"ä¸€-autograd\"><a class=\"anchor\" href=\"#ä¸€-autograd\">#</a> ä¸€ã€AutoGrad</h2>\n<p>autograd åŒ…æ˜¯ PyTorch ä¸­æ‰€æœ‰ç¥ç»ç½‘ç»œçš„æ ¸å¿ƒã€‚é¦–å…ˆè®©æˆ‘ä»¬ç®€è¦åœ°ä»‹ç»å®ƒï¼Œç„¶åæˆ‘ä»¬å°†ä¼šå»è®­ç»ƒæˆ‘ä»¬çš„ç¬¬ä¸€ä¸ªç¥ç»ç½‘ç»œã€‚è¯¥ autograd è½¯ä»¶åŒ…ä¸º Tensors ä¸Šçš„æ‰€æœ‰æ“ä½œæä¾›è‡ªåŠ¨å¾®åˆ†ã€‚å®ƒæ˜¯ä¸€ä¸ªç”±è¿è¡Œå®šä¹‰çš„æ¡†æ¶ï¼Œè¿™æ„å‘³ç€ä»¥ä»£ç è¿è¡Œæ–¹å¼å®šä¹‰ä½ çš„åå‘ä¼ æ’­ï¼Œå¹¶ä¸”æ¯æ¬¡è¿­ä»£éƒ½å¯ä»¥ä¸åŒ</p>\n<p>å…ˆä¸¢å¼ æ€ç»´å¯¼å›¾å­ï¼š<br>\n<img loading=\"lazy\" src=\"/images/pytorch/autograd.png\" alt=\"autograd\"></p>\n<p>é¦–å…ˆè¦ç»™xå®šä¹‰ <code>requires_grad=True</code> å±æ€§</p>\n<p>å…¶æ¬¡è¦æ³¨æ„è¢«<code>backward()</code>çš„å¼ é‡éœ€è¦æ˜¯å¼ é‡æ ‡é‡ï¼Œå³éœ€è¦è¢«<code>mean()</code>æˆ–è€…æ˜¯<code>sum()</code></p>\n<p>æœ€åxçš„æ¢¯åº¦å°±æ˜¯<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mfrac><mrow><mi>d</mi><mi>z</mi></mrow><mrow><mi>d</mi><mi>x</mi></mrow></mfrac></mrow><annotation encoding=\"application/x-tex\">\\frac{dz}{dx}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.2251em;vertical-align:-0.345em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8801em;\"><span style=\"top:-2.655em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">d</span><span class=\"mord mathnormal mtight\">x</span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.394em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">d</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.04398em;\">z</span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.345em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span></span></span></span></p>\n<p>å°†ä»£ç å—åŒ…è£¹åœ¨ <code>with torch.no_grad()ï¼š</code> ä¸­ä»¥åœæ­¢è‡ªåŠ¨å¾®åˆ†</p>\n<pre class=\"shiki shiki-themes vitesse-light vitesse-dark\" style=\"background-color:#ffffff;--shiki-dark-bg:#121212;color:#393a34;--shiki-dark:#dbd7caee\" tabindex=\"0\"><code class=\"language-bash\"><span class=\"line\"><span style=\"color:#998418;--shiki-dark:#B8A965\">print</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">x.requires_grad</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span></span>\n<span class=\"line\"><span style=\"color:#998418;--shiki-dark:#B8A965\">print</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">(</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">x</span><span style=\"color:#A65E2B;--shiki-dark:#C99076\"> **</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\"> 2</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">)</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">.requires_grad</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">with</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> torch.no_grad</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">:</span></span>\n<span class=\"line\"><span style=\"color:#998418;--shiki-dark:#B8A965\">    print</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">(</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">x</span><span style=\"color:#A65E2B;--shiki-dark:#C99076\"> **</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\"> 2</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">)</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">.requires_grad</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span></span></code></pre>\n<p>output:</p>\n<pre class=\"shiki shiki-themes vitesse-light vitesse-dark\" style=\"background-color:#ffffff;--shiki-dark-bg:#121212;color:#393a34;--shiki-dark:#dbd7caee\" tabindex=\"0\"><code class=\"language-bash\"><span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">True</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">True</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">False</span></span></code></pre>\n<hr>\n<h2 id=\"äºŒ-ç¥ç»ç½‘ç»œåŸºç¡€\"><a class=\"anchor\" href=\"#äºŒ-ç¥ç»ç½‘ç»œåŸºç¡€\">#</a> äºŒã€ç¥ç»ç½‘ç»œåŸºç¡€</h2>\n<h3 id=\"21-äº†è§£ç¥ç»ç½‘ç»œç»“æ„çš„åˆ†ç±»\"><a class=\"anchor\" href=\"#21-äº†è§£ç¥ç»ç½‘ç»œç»“æ„çš„åˆ†ç±»\">#</a> 2.1 äº†è§£ç¥ç»ç½‘ç»œç»“æ„çš„åˆ†ç±»</h3>\n<table>\n<thead>\n<tr>\n<th>åºå·</th>\n<th>ç½‘ç»œç±»å‹</th>\n<th>ç®€ä»‹</th>\n<th>é€‚ç”¨åœºæ™¯</th>\n<th>ä»£è¡¨æ¨¡å‹ / ç‰¹ç‚¹</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>1</td>\n<td>å‰é¦ˆç¥ç»ç½‘ç»œï¼ˆFNNï¼‰</td>\n<td>æœ€åŸºç¡€çš„ç¥ç»ç½‘ç»œï¼Œä¿¡æ¯å•å‘ä¼ æ’­ï¼Œæ— ç¯</td>\n<td>é€šç”¨åœºæ™¯</td>\n<td>å¤šå±‚æ„ŸçŸ¥å™¨ï¼ˆMLPï¼‰</td>\n</tr>\n<tr>\n<td>2</td>\n<td>å·ç§¯ç¥ç»ç½‘ç»œï¼ˆCNNï¼‰</td>\n<td>æå–å›¾åƒå±€éƒ¨ç‰¹å¾ï¼Œå‚æ•°æ›´å°‘</td>\n<td>å›¾åƒè¯†åˆ«ã€ç›®æ ‡æ£€æµ‹</td>\n<td>LeNetã€AlexNetã€VGGã€ResNetã€EfficientNet</td>\n</tr>\n<tr>\n<td>3</td>\n<td>å¾ªç¯ç¥ç»ç½‘ç»œï¼ˆRNNï¼‰</td>\n<td>å¤„ç†åºåˆ—æ•°æ®ï¼Œæœ‰â€œè®°å¿†â€ç»“æ„</td>\n<td>æ–‡æœ¬ã€è¯­éŸ³ã€æ—¶é—´åºåˆ—</td>\n<td>RNNã€LSTMã€GRU</td>\n</tr>\n<tr>\n<td>4</td>\n<td>æ®‹å·®ç¥ç»ç½‘ç»œï¼ˆResNetï¼‰</td>\n<td>ä½¿ç”¨æ®‹å·®è¿æ¥é¿å…æ¢¯åº¦æ¶ˆå¤±</td>\n<td>æ·±å±‚ç½‘ç»œè®­ç»ƒ</td>\n<td>ResNetã€è¾“å‡º=F(x)+x</td>\n</tr>\n<tr>\n<td>5</td>\n<td>å›¾ç¥ç»ç½‘ç»œï¼ˆGNNï¼‰</td>\n<td>é€‚ç”¨äºå›¾ç»“æ„æ•°æ®</td>\n<td>ç¤¾äº¤ç½‘ç»œã€çŸ¥è¯†å›¾è°±</td>\n<td>GCNã€GATã€GraphSAGE</td>\n</tr>\n</tbody>\n</table>\n<h3 id=\"22-äº†è§£ç¥ç»ç½‘ç»œçš„æ•´ä¸ªè¿‡ç¨‹\"><a class=\"anchor\" href=\"#22-äº†è§£ç¥ç»ç½‘ç»œçš„æ•´ä¸ªè¿‡ç¨‹\">#</a> 2.2 äº†è§£ç¥ç»ç½‘ç»œçš„æ•´ä¸ªè¿‡ç¨‹</h3>\n<p><code>è¾“å…¥æ•°æ® x                    è¾“å…¥å±‚æœ‰å‡ ä¸ªç¥ç»å…ƒå°±è¾“å…¥å‡ ä¸ªæ•°æ®ï¼ˆå‡ ç»´ï¼‰</code></p>\n<p><code>æ­£å‘ä¼ æ’­ï¼ˆLinear + æ¿€æ´»å‡½æ•°ï¼‰  éšè—å±‚=çº¿æ€§å±‚+æ¿€æ´»å‡½æ•°ï¼ˆæ¨¡æ‹Ÿå¤æ‚çš„æ•°æ®åˆ†å¸ƒï¼‰</code></p>\n<p><code>è¾“å‡ºç»“æœï¼ˆé¢„æµ‹å€¼ï¼‰</code></p>\n<p><code>è®¡ç®—æŸå¤±ï¼ˆLoss ä¸çœŸå®å€¼æ¯”è¾ƒï¼‰</code></p>\n<p><code>åå‘ä¼ æ’­ï¼ˆé“¾å¼æ³•åˆ™æ±‚å¯¼ï¼‰</code></p>\n<p><code>å‚æ•°æ¢¯åº¦æ›´æ–°ï¼ˆOptimizerï¼‰</code></p>\n<p><code>ä¸‹ä¸€è½®è®­ç»ƒ</code></p>\n<p>æŸå¤±å‡½æ•°ï¼šè®¡ç®—\"åå·®\"</p>\n<p>ä¼˜åŒ–å™¨ï¼šè¿™ä¸ªâ€œåå·®â€é€šè¿‡æŸå¤±å‡½æ•°è®¡ç®—å‡ºæ¥ï¼Œè€Œä¼˜åŒ–å™¨çš„å·¥ä½œï¼Œå°±æ˜¯ é€šè¿‡åå‘ä¼ æ’­å¾—åˆ°çš„æ¢¯åº¦ï¼Œæ›´æ–°å‚æ•°ï¼Œä½¿æŸå¤±è¶Šæ¥è¶Šå°</p>\n<p>ç»™å‡ºä¸€ä¸ªç®€å•çš„å‰é¦ˆç¥ç»ç½‘ç»œä½œä¸ºå®ä¾‹è¿›è¡Œè®²è§£</p>\n<pre class=\"shiki shiki-themes vitesse-light vitesse-dark\" style=\"background-color:#ffffff;--shiki-dark-bg:#121212;color:#393a34;--shiki-dark:#dbd7caee\" tabindex=\"0\"><code class=\"language-bash\"><span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">import</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> torch</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">import</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> torch.nn</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> as</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> nn</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">import</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> torch.optim</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> as</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> optim</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\"># å®šä¹‰ä¸€ä¸ªç®€å•çš„å‰é¦ˆç¥ç»ç½‘ç»œï¼ŒåŒ…å«ä¸€ä¸ªéšè—å±‚</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">class</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> SimpleFNN</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#59873A;--shiki-dark:#80A665\">nn.Module</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">:</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">    def</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> __init__</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#59873A;--shiki-dark:#80A665\">self</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">:</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">        super</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#59873A;--shiki-dark:#80A665\">SimpleFNN,</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> self</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span><span style=\"color:#59873A;--shiki-dark:#80A665\">.__init__</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">        self.fc1</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> =</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> nn.Linear</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#59873A;--shiki-dark:#80A665\">4,</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\"> 8</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\">   # è¾“å…¥å±‚4ä¸ªç‰¹å¾ï¼Œéšè—å±‚8ä¸ªç¥ç»å…ƒ</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">        self.relu</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> =</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> nn.ReLU</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\">        # æ¿€æ´»å‡½æ•°</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">        self.fc2</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> =</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> nn.Linear</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#59873A;--shiki-dark:#80A665\">8,</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\"> 3</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\">   # è¾“å‡ºå±‚3ä¸ªç±»åˆ«ï¼ˆæ¯”å¦‚3åˆ†ç±»é—®é¢˜ï¼‰</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">    def</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> forward</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#59873A;--shiki-dark:#80A665\">self,</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> x</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">:</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">        x</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> =</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> self.fc1</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#59873A;--shiki-dark:#80A665\">x</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">        x</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> =</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> self.relu</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#59873A;--shiki-dark:#80A665\">x</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">        x</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> =</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> self.fc2</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#59873A;--shiki-dark:#80A665\">x</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span></span>\n<span class=\"line\"><span style=\"color:#1E754F;--shiki-dark:#4D9375\">        return</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> x</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\"># åˆ›å»ºæ¨¡å‹</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">model</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> =</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> SimpleFNN</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span></span>\n<span class=\"line\"><span style=\"color:#998418;--shiki-dark:#B8A965\">print</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">model</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\"># å‡è®¾è¾“å…¥æ˜¯4ç»´ç‰¹å¾</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">sample_input</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> =</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> torch.randn</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#59873A;--shiki-dark:#80A665\">2,</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\"> 4</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\">  # batch_size=2ï¼Œ4ä¸ªç‰¹å¾</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">output</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> =</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> model</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#59873A;--shiki-dark:#80A665\">sample_input</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span></span>\n<span class=\"line\"><span style=\"color:#998418;--shiki-dark:#B8A965\">print</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">output</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span></span>\n<span class=\"line\"></span></code></pre>\n<p><code>__init__ </code>å‡½æ•° â€” ç½‘ç»œç»“æ„çš„â€œæ­å»ºå·¥å‚â€</p>\n<p>ä½œç”¨ï¼š<br>\nåˆå§‹åŒ–ç¥ç»ç½‘ç»œçš„å±‚å’Œç»„ä»¶,ç›¸å½“äºåœ¨è¿™é‡Œå®šä¹‰å¥½ç½‘ç»œçš„â€œéª¨æ¶â€å’Œâ€œé›¶ä»¶â€ã€‚</p>\n<p>ä¸€èˆ¬<code>_init_</code>å†…åŒ…å«å¦‚ä¸‹å†…å®¹:</p>\n<table>\n<thead>\n<tr>\n<th>ç±»å‹</th>\n<th>å†…å®¹</th>\n<th>è¯´æ˜</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>ğŸ”· ç½‘ç»œå±‚</td>\n<td><code>nn.Linear</code>, <code>nn.Conv2d</code>, <code>nn.LSTM</code> ç­‰</td>\n<td>å®šä¹‰è¾“å…¥å±‚ã€éšè—å±‚ã€è¾“å‡ºå±‚ç»“æ„</td>\n</tr>\n<tr>\n<td>ğŸ”¶ æ¿€æ´»å‡½æ•°</td>\n<td><code>nn.ReLU()</code>, <code>nn.Sigmoid()</code> ç­‰</td>\n<td>å¯ä»¥ä½œä¸ºç±»æˆå‘˜ï¼Œä¹Ÿå¯ä»¥ç›´æ¥åœ¨ <code>forward()</code> é‡Œç”¨</td>\n</tr>\n<tr>\n<td>ğŸ”¸ Dropout / BatchNorm</td>\n<td><code>nn.Dropout</code>, <code>nn.BatchNorm1d</code> ç­‰</td>\n<td>ç”¨äºæ­£åˆ™åŒ–ã€åŠ é€Ÿæ”¶æ•›</td>\n</tr>\n<tr>\n<td>ğŸ”» æœ‰æ—¶ä¼šæ”¾ä¼˜åŒ–å™¨ / æŸå¤±å‡½æ•°ï¼ˆä½†ä¸æ¨èï¼‰</td>\n<td><code>optim.SGD</code>, <code>nn.CrossEntropyLoss</code></td>\n<td>ä¸€èˆ¬åœ¨æ¨¡å‹å¤–å•ç‹¬å†™æ›´æ¸…æ™°</td>\n</tr>\n</tbody>\n</table>\n<p>æ¯”å¦‚åœ¨ä¸Šè¿°ç¤ºä¾‹ä»£ç ä¸­çš„å…·ä½“å†…å®¹ï¼š</p>\n<ul>\n<li>\n<p><code>super(SimpleFNN, self).__init__()</code><br>\nè°ƒç”¨çˆ¶ç±» nn.Module çš„åˆå§‹åŒ–æ–¹æ³•ï¼Œç¡®ä¿ç½‘ç»œèƒ½æ­£å¸¸å·¥ä½œå’Œæ³¨å†Œæ‰€æœ‰å­æ¨¡å—ã€‚</p>\n</li>\n<li>\n<p><code>self.fc1 = nn.Linear(4, 8)</code><br>\nå®šä¹‰ç¬¬ä¸€ä¸ªå…¨è¿æ¥å±‚ï¼ˆçº¿æ€§å±‚ï¼‰ï¼Œå®ƒæ¥å—4ç»´è¾“å…¥ï¼Œè¾“å‡º8ç»´æ•°æ®ã€‚<br>\nè¿™å±‚ä¼šå­¦ä¹ ä¸€ä¸ª 4Ã—8 çš„æƒé‡çŸ©é˜µå’Œåç½®å‘é‡ã€‚</p>\n</li>\n<li>\n<p><code>self.relu = nn.ReLU()</code><br>\nå®šä¹‰äº†ä¸€ä¸ªæ¿€æ´»å‡½æ•°ReLUï¼Œå¢åŠ ç½‘ç»œçš„éçº¿æ€§è¡¨è¾¾èƒ½åŠ›ã€‚<br>\nè¿™é‡Œæ˜¯å…ˆå®šä¹‰å¥½ï¼Œå¯ä»¥åœ¨ forward ä¸­è°ƒç”¨ã€‚</p>\n</li>\n<li>\n<p><code>self.fc2 = nn.Linear(8, 3)</code><br>\nå®šä¹‰ç¬¬äºŒä¸ªå…¨è¿æ¥å±‚ï¼Œæ¥å—8ç»´è¾“å…¥ï¼Œè¾“å‡º3ç»´ç»“æœã€‚<br>\nè¿™å¸¸ç”¨ä½œåˆ†ç±»ä»»åŠ¡çš„è¾“å‡ºå±‚ï¼Œè¾“å‡º3ä¸ªç±»åˆ«çš„åˆ†æ•°ã€‚</p>\n</li>\n</ul>\n<p><code>forward</code> å‡½æ•° â€” æ•°æ®çš„â€œè¿è¡Œæµç¨‹â€,é‡Œé¢å®šä¹‰çš„æ˜¯ä»\"è¾“å…¥åˆ°è¾“å‡º\"çš„è¿™ä¸€æ•´æ¡è·¯çº¿</p>\n<p>ä½œç”¨ï¼š<br>\nå®šä¹‰è¾“å…¥æ•°æ®å¦‚ä½•é€šè¿‡ç½‘ç»œè®¡ç®—å¾—åˆ°è¾“å‡ºã€‚<br>\nç›¸å½“äºç½‘ç»œçš„â€œè¿è¡Œæ­¥éª¤â€ï¼Œå‘Šè¯‰ PyTorch å…·ä½“æ‰§è¡Œä»€ä¹ˆæ“ä½œã€‚</p>\n<p>å…·ä½“æµç¨‹ï¼š</p>\n<ul>\n<li>\n<p><code>x = self.fc1(x)</code><br>\nè¾“å…¥æ•°æ® x å…ˆç»è¿‡ç¬¬ä¸€ä¸ªå…¨è¿æ¥å±‚ï¼Œå˜æˆ8ç»´çš„å‘é‡ã€‚</p>\n</li>\n<li>\n<p><code>x = self.relu(x)</code><br>\nå°†åˆšå¾—åˆ°çš„8ç»´æ•°æ®é€šè¿‡ ReLU æ¿€æ´»å‡½æ•°ï¼Œå¢åŠ éçº¿æ€§ã€‚<br>\nReLUçš„ä½œç”¨æ˜¯æŠŠè´Ÿæ•°å˜ä¸º0ï¼Œæ­£æ•°ä¿æŒä¸å˜ã€‚</p>\n</li>\n<li>\n<p><code>x = self.fc2(x)</code><br>\nå†æŠŠæ¿€æ´»åçš„ç»“æœè¾“å…¥åˆ°ç¬¬äºŒä¸ªå…¨è¿æ¥å±‚ï¼Œå˜æˆ3ç»´è¾“å‡ºã€‚</p>\n</li>\n<li>\n<p><code>return x</code><br>\nè¿”å›æœ€ç»ˆè¾“å‡ºï¼Œé€šå¸¸æ˜¯â€œåˆ†ç±»åˆ†æ•°â€æˆ–â€œå›å½’é¢„æµ‹å€¼â€ã€‚</p>\n</li>\n</ul>\n<h3 id=\"23æ¿€æ´»å‡½æ•°\"><a class=\"anchor\" href=\"#23æ¿€æ´»å‡½æ•°\">#</a> 2.3æ¿€æ´»å‡½æ•°</h3>\n<table>\n<thead>\n<tr>\n<th>æ¿€æ´»å‡½æ•°</th>\n<th>æ•°å­¦å½¢å¼</th>\n<th>ç‰¹ç‚¹</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td><strong>ReLU</strong></td>\n<td><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>f</mi><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo><mo>=</mo><mi>max</mi><mo>â¡</mo><mo stretchy=\"false\">(</mo><mn>0</mn><mo separator=\"true\">,</mo><mi>x</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">f(x) = \\max(0, x)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mop\">max</span><span class=\"mopen\">(</span><span class=\"mord\">0</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">)</span></span></span></span></td>\n<td>ç®€å•é«˜æ•ˆï¼Œæ¢¯åº¦ä¼ æ’­å¥½ï¼Œä½†ä¼šæœ‰\"æ­»ç¥ç»å…ƒ\"é—®é¢˜</td>\n</tr>\n<tr>\n<td><strong>Sigmoid</strong></td>\n<td><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>f</mi><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo><mo>=</mo><mfrac><mn>1</mn><mrow><mn>1</mn><mo>+</mo><msup><mi>e</mi><mrow><mo>âˆ’</mo><mi>x</mi></mrow></msup></mrow></mfrac></mrow><annotation encoding=\"application/x-tex\">f(x) = \\frac{1}{1 + e^{-x}}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.2484em;vertical-align:-0.4033em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8451em;\"><span style=\"top:-2.655em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">1</span><span class=\"mbin mtight\">+</span><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">e</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7027em;\"><span style=\"top:-2.786em;margin-right:0.0714em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">âˆ’</span><span class=\"mord mathnormal mtight\">x</span></span></span></span></span></span></span></span></span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.394em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">1</span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.4033em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span></span></span></span></td>\n<td>è¾“å‡ºåœ¨(0,1)ï¼Œå®¹æ˜“æ¢¯åº¦æ¶ˆå¤±</td>\n</tr>\n<tr>\n<td><strong>Tanh</strong></td>\n<td><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>f</mi><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo><mo>=</mo><mfrac><mrow><msup><mi>e</mi><mi>x</mi></msup><mo>âˆ’</mo><msup><mi>e</mi><mrow><mo>âˆ’</mo><mi>x</mi></mrow></msup></mrow><mrow><msup><mi>e</mi><mi>x</mi></msup><mo>+</mo><msup><mi>e</mi><mrow><mo>âˆ’</mo><mi>x</mi></mrow></msup></mrow></mfrac></mrow><annotation encoding=\"application/x-tex\">f(x) = \\frac{e^x - e^{-x}}{e^x + e^{-x}}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.3907em;vertical-align:-0.4033em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.9874em;\"><span style=\"top:-2.655em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">e</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.5935em;\"><span style=\"top:-2.786em;margin-right:0.0714em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mathnormal mtight\">x</span></span></span></span></span></span></span></span><span class=\"mbin mtight\">+</span><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">e</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7027em;\"><span style=\"top:-2.786em;margin-right:0.0714em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">âˆ’</span><span class=\"mord mathnormal mtight\">x</span></span></span></span></span></span></span></span></span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.394em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">e</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7385em;\"><span style=\"top:-2.931em;margin-right:0.0714em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mathnormal mtight\">x</span></span></span></span></span></span></span></span><span class=\"mbin mtight\">âˆ’</span><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">e</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8477em;\"><span style=\"top:-2.931em;margin-right:0.0714em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">âˆ’</span><span class=\"mord mathnormal mtight\">x</span></span></span></span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.4033em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span></span></span></span></td>\n<td>è¾“å‡ºåœ¨(-1,1)ï¼Œæ¯”Sigmoidå¯¹ç§°ï¼Œä½†ä¹Ÿå¯èƒ½æ¢¯åº¦æ¶ˆå¤±</td>\n</tr>\n<tr>\n<td><strong>Leaky ReLU</strong></td>\n<td><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>f</mi><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo><mo>=</mo><mi>max</mi><mo>â¡</mo><mo stretchy=\"false\">(</mo><mn>0.01</mn><mi>x</mi><mo separator=\"true\">,</mo><mi>x</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">f(x) = \\max(0.01x, x)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mop\">max</span><span class=\"mopen\">(</span><span class=\"mord\">0.01</span><span class=\"mord mathnormal\">x</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">)</span></span></span></span></td>\n<td>è§£å†³ReLUæ­»åŒºé—®é¢˜</td>\n</tr>\n<tr>\n<td><strong>ELU</strong></td>\n<td>æŒ‡æ•°çº¿æ€§å•å…ƒ</td>\n<td>æ›´å¹³æ»‘çš„æ¢¯åº¦æµ</td>\n</tr>\n</tbody>\n</table>\n<p>ä½œç”¨ï¼šæ¿€æ´»å‡½æ•°è®©éšè—å±‚æ‹¥æœ‰è¡¨è¾¾å¤æ‚æ¨¡å¼çš„èƒ½åŠ›ï¼Œæ˜¯ç¥ç»ç½‘ç»œâ€œèªæ˜èµ·æ¥â€çš„å…³é”®ã€‚</p>\n<h3 id=\"24æŸå¤±å‡½æ•°\"><a class=\"anchor\" href=\"#24æŸå¤±å‡½æ•°\">#</a> 2.4æŸå¤±å‡½æ•°</h3>\n<table>\n<thead>\n<tr>\n<th>åç§°</th>\n<th>é€‚ç”¨ä»»åŠ¡</th>\n<th>PyTorch å¯¹åº”å‡½æ•°</th>\n<th>å…¬å¼/æè¿°</th>\n<th>ç‰¹ç‚¹ä¸ä½¿ç”¨åœºæ™¯</th>\n<th></th>\n<th></th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td><strong>å‡æ–¹è¯¯å·®ï¼ˆMSEï¼‰</strong></td>\n<td>å›å½’</td>\n<td><code>nn.MSELoss</code></td>\n<td><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mfrac><mn>1</mn><mi>n</mi></mfrac><mo>âˆ‘</mo><mo stretchy=\"false\">(</mo><msub><mi>y</mi><mi>i</mi></msub><mo>âˆ’</mo><msub><mover accent=\"true\"><mi>y</mi><mo>^</mo></mover><mi>i</mi></msub><msup><mo stretchy=\"false\">)</mo><mn>2</mn></msup></mrow><annotation encoding=\"application/x-tex\">\\frac{1}{n} \\sum (y_i - \\hat{y}_i)^2</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.1901em;vertical-align:-0.345em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8451em;\"><span style=\"top:-2.655em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">n</span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.394em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">1</span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.345em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mop op-symbol small-op\" style=\"position:relative;top:0em;\">âˆ‘</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">âˆ’</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.0641em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord accent\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6944em;\"><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span></span><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"accent-body\" style=\"left:-0.1944em;\"><span class=\"mord\">^</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1944em;\"><span></span></span></span></span></span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\"><span class=\"mclose\">)</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span></span></span></span></td>\n<td>å¯¹å¼‚å¸¸å€¼æ•æ„Ÿï¼›å¸¸ç”¨äºå›å½’</td>\n<td></td>\n<td></td>\n</tr>\n<tr>\n<td><strong>å¹³å‡ç»å¯¹è¯¯å·®ï¼ˆMAEï¼‰</strong></td>\n<td>å›å½’</td>\n<td><code>nn.L1Loss</code></td>\n<td><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mfrac><mn>1</mn><mi>n</mi></mfrac><mo>âˆ‘</mo><msub><mi>y</mi><mi>i</mi></msub><mo>âˆ’</mo><msub><mover accent=\"true\"><mi>y</mi><mo>^</mo></mover><mi>i</mi></msub></mrow><annotation encoding=\"application/x-tex\">\\frac{1}{n} \\sum y_i - \\hat{y}_i</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.1901em;vertical-align:-0.345em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8451em;\"><span style=\"top:-2.655em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">n</span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.394em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">1</span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.345em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mop op-symbol small-op\" style=\"position:relative;top:0em;\">âˆ‘</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">âˆ’</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord\"><span class=\"mord accent\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6944em;\"><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span></span><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"accent-body\" style=\"left:-0.1944em;\"><span class=\"mord\">^</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1944em;\"><span></span></span></span></span></span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span></td>\n<td>æŠ—å¼‚å¸¸å€¼èƒ½åŠ›å¼ºï¼Œæ”¶æ•›é€Ÿåº¦æ…¢</td>\n</tr>\n<tr>\n<td><strong>äº¤å‰ç†µæŸå¤±ï¼ˆCross Entropyï¼‰</strong></td>\n<td>åˆ†ç±»</td>\n<td><code>nn.CrossEntropyLoss</code></td>\n<td><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo>âˆ’</mo><mo>âˆ‘</mo><msub><mi>y</mi><mi>i</mi></msub><mi>log</mi><mo>â¡</mo><mo stretchy=\"false\">(</mo><msub><mover accent=\"true\"><mi>y</mi><mo>^</mo></mover><mi>i</mi></msub><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">-\\sum y_i \\log(\\hat{y}_i)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\">âˆ’</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mop op-symbol small-op\" style=\"position:relative;top:0em;\">âˆ‘</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mop\">lo<span style=\"margin-right:0.01389em;\">g</span></span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord accent\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6944em;\"><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span></span><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"accent-body\" style=\"left:-0.1944em;\"><span class=\"mord\">^</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1944em;\"><span></span></span></span></span></span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span></span></td>\n<td>å¤šåˆ†ç±»å¸¸ç”¨ï¼Œå†…ç½®äº† <code>LogSoftmax</code> + <code>NLLLoss</code></td>\n<td></td>\n<td></td>\n</tr>\n<tr>\n<td><strong>äºŒåˆ†ç±»äº¤å‰ç†µï¼ˆBCEï¼‰</strong></td>\n<td>äºŒåˆ†ç±»</td>\n<td><code>nn.BCELoss</code> or <code>nn.BCEWithLogitsLoss</code></td>\n<td><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo>âˆ’</mo><mo stretchy=\"false\">[</mo><mi>y</mi><mi>log</mi><mo>â¡</mo><mo stretchy=\"false\">(</mo><mover accent=\"true\"><mi>y</mi><mo>^</mo></mover><mo stretchy=\"false\">)</mo><mo>+</mo><mo stretchy=\"false\">(</mo><mn>1</mn><mo>âˆ’</mo><mi>y</mi><mo stretchy=\"false\">)</mo><mi>log</mi><mo>â¡</mo><mo stretchy=\"false\">(</mo><mn>1</mn><mo>âˆ’</mo><mover accent=\"true\"><mi>y</mi><mo>^</mo></mover><mo stretchy=\"false\">)</mo><mo stretchy=\"false\">]</mo></mrow><annotation encoding=\"application/x-tex\">-[y \\log(\\hat{y}) + (1-y)\\log(1-\\hat{y})]</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\">âˆ’</span><span class=\"mopen\">[</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mop\">lo<span style=\"margin-right:0.01389em;\">g</span></span><span class=\"mopen\">(</span><span class=\"mord accent\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6944em;\"><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span></span><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"accent-body\" style=\"left:-0.1944em;\"><span class=\"mord\">^</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1944em;\"><span></span></span></span></span></span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">(</span><span class=\"mord\">1</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">âˆ’</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mop\">lo<span style=\"margin-right:0.01389em;\">g</span></span><span class=\"mopen\">(</span><span class=\"mord\">1</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">âˆ’</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord accent\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6944em;\"><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span></span><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"accent-body\" style=\"left:-0.1944em;\"><span class=\"mord\">^</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1944em;\"><span></span></span></span></span></span><span class=\"mclose\">)]</span></span></span></span></td>\n<td>äºŒåˆ†ç±»å¸¸ç”¨ï¼›<code>BCEWithLogitsLoss</code>æ›´ç¨³å®šï¼Œå†…éƒ¨è‡ªå¸¦sigmoid</td>\n<td></td>\n<td></td>\n</tr>\n<tr>\n<td><strong>KLæ•£åº¦ï¼ˆKL Divergenceï¼‰</strong></td>\n<td>åˆ†å¸ƒåŒ¹é…</td>\n<td><code>nn.KLDivLoss</code></td>\n<td><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo>âˆ‘</mo><mi>p</mi><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo><mi>log</mi><mo>â¡</mo><mrow><mo fence=\"true\">(</mo><mfrac><mrow><mi>p</mi><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo></mrow><mrow><mi>q</mi><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo></mrow></mfrac><mo fence=\"true\">)</mo></mrow></mrow><annotation encoding=\"application/x-tex\">\\sum p(x) \\log\\left(\\frac{p(x)}{q(x)}\\right)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.8em;vertical-align:-0.65em;\"></span><span class=\"mop op-symbol small-op\" style=\"position:relative;top:0em;\">âˆ‘</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">p</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mop\">lo<span style=\"margin-right:0.01389em;\">g</span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"minner\"><span class=\"mopen delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size2\">(</span></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.01em;\"><span style=\"top:-2.655em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03588em;\">q</span><span class=\"mopen mtight\">(</span><span class=\"mord mathnormal mtight\">x</span><span class=\"mclose mtight\">)</span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.485em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">p</span><span class=\"mopen mtight\">(</span><span class=\"mord mathnormal mtight\">x</span><span class=\"mclose mtight\">)</span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.52em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mclose delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size2\">)</span></span></span></span></span></span></td>\n<td>ç”¨äºè¡¡é‡ä¸¤ä¸ªæ¦‚ç‡åˆ†å¸ƒä¹‹é—´çš„å·®è·</td>\n<td></td>\n<td></td>\n</tr>\n<tr>\n<td><strong>è´Ÿå¯¹æ•°ä¼¼ç„¶æŸå¤±ï¼ˆNLLï¼‰</strong></td>\n<td>åˆ†ç±»</td>\n<td><code>nn.NLLLoss</code></td>\n<td><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo>âˆ’</mo><mi>log</mi><mo>â¡</mo><mo stretchy=\"false\">(</mo><msub><mi>p</mi><mtext>true</mtext></msub><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">-\\log(p_{\\text{true}})</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\">âˆ’</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mop\">lo<span style=\"margin-right:0.01389em;\">g</span></span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\">p</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2806em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord text mtight\"><span class=\"mord mtight\">true</span></span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span></span></td>\n<td>é€šå¸¸å’Œ <code>LogSoftmax</code> ä¸€èµ·ç”¨</td>\n<td></td>\n<td></td>\n</tr>\n<tr>\n<td><strong>Huber æŸå¤±</strong></td>\n<td>å›å½’ï¼ˆç¨³å¥ï¼‰</td>\n<td><code>nn.SmoothL1Loss</code></td>\n<td>ç»“åˆ MAE å’Œ MSE çš„ä¼˜ç‚¹</td>\n<td>å¯¹ç¦»ç¾¤å€¼é²æ£’ï¼Œé€‚åˆæœ‰å™ªå£°çš„å›å½’é—®é¢˜</td>\n<td></td>\n<td></td>\n</tr>\n<tr>\n<td><strong>å¤šæ ‡ç­¾ Soft Margin æŸå¤±</strong></td>\n<td>å¤šæ ‡ç­¾åˆ†ç±»</td>\n<td><code>nn.MultiLabelSoftMarginLoss</code></td>\n<td>åŸºäºæ¯ä¸ªæ ‡ç­¾çš„ sigmoid + binary cross-entropy</td>\n<td>å¤šæ ‡ç­¾å¤šåˆ†ç±»ï¼ˆæ¯ä¸ªæ ·æœ¬å¯ä»¥å±äºå¤šä¸ªç±»ï¼‰</td>\n<td></td>\n<td></td>\n</tr>\n<tr>\n<td><strong>CTC æŸå¤±ï¼ˆConnectionist Temporal Classificationï¼‰</strong></td>\n<td>åºåˆ—å­¦ä¹ </td>\n<td><code>nn.CTCLoss</code></td>\n<td>è§£å†³è¾“å…¥è¾“å‡ºé•¿åº¦ä¸å¯¹é½çš„é—®é¢˜ï¼ˆå¦‚è¯­éŸ³è¯†åˆ«ï¼‰</td>\n<td>ä¸éœ€è¦å¯¹é½çš„æ ‡ç­¾ï¼Œé€‚åˆè¯­éŸ³ã€OCRç­‰</td>\n<td></td>\n<td></td>\n</tr>\n<tr>\n<td><strong>Triplet Loss</strong></td>\n<td>åº¦é‡å­¦ä¹ </td>\n<td><code>nn.TripletMarginLoss</code></td>\n<td>è®© anchor æ›´æ¥è¿‘ positiveï¼Œè¿œç¦» negative</td>\n<td>å¸¸ç”¨äºäººè„¸è¯†åˆ«ã€å›¾åƒæ£€ç´¢ç­‰</td>\n<td></td>\n<td></td>\n</tr>\n<tr>\n<td><strong>Cosine Embedding Loss</strong></td>\n<td>åº¦é‡å­¦ä¹ </td>\n<td><code>nn.CosineEmbeddingLoss</code></td>\n<td>åŸºäºä½™å¼¦ç›¸ä¼¼åº¦çš„æ­£è´Ÿæ ·æœ¬å¯¹å­¦ä¹ </td>\n<td>å­¦ä¹ è¯­ä¹‰ç›¸ä¼¼çš„åµŒå…¥è¡¨ç¤ºï¼ˆembeddingï¼‰</td>\n<td></td>\n<td></td>\n</tr>\n</tbody>\n</table>\n<h3 id=\"25ä¼˜åŒ–å™¨\"><a class=\"anchor\" href=\"#25ä¼˜åŒ–å™¨\">#</a> 2.5ä¼˜åŒ–å™¨</h3>\n<table>\n<thead>\n<tr>\n<th>ä¼˜åŒ–å™¨åç§°</th>\n<th>PyTorch ç±»</th>\n<th>ç‰¹ç‚¹</th>\n<th>å¤‡æ³¨</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td><strong>SGDï¼ˆéšæœºæ¢¯åº¦ä¸‹é™ï¼‰</strong></td>\n<td><code>torch.optim.SGD</code></td>\n<td>æœ€åŸºç¡€çš„ä¼˜åŒ–å™¨</td>\n<td>å¯æ­é… Momentum ä½¿ç”¨</td>\n</tr>\n<tr>\n<td><strong>SGD + Momentum</strong></td>\n<td><code>torch.optim.SGD(momentum=0.9)</code></td>\n<td>ç¼“å†²æ¢¯åº¦æ–¹å‘ï¼Œå‡å°‘éœ‡è¡</td>\n<td>æ¯”å•çº¯ SGD æ›´å¿«æ”¶æ•›</td>\n</tr>\n<tr>\n<td><strong>Adagrad</strong></td>\n<td><code>torch.optim.Adagrad</code></td>\n<td>å¯¹ç¨€ç–æ¢¯åº¦å‚æ•°æœ‰ä¼˜åŠ¿</td>\n<td>å¯èƒ½å­¦ä¹ ç‡è¿‡æ—©å˜å°</td>\n</tr>\n<tr>\n<td><strong>RMSprop</strong></td>\n<td><code>torch.optim.RMSprop</code></td>\n<td>æ§åˆ¶å­¦ä¹ ç‡è¡°å‡</td>\n<td>æ¨èç”¨äº RNN</td>\n</tr>\n<tr>\n<td><strong>Adam</strong></td>\n<td><code>torch.optim.Adam</code></td>\n<td>è‡ªé€‚åº” + åŠ¨é‡</td>\n<td>æœ€å¸¸ç”¨ä¼˜åŒ–å™¨ä¹‹ä¸€</td>\n</tr>\n<tr>\n<td><strong>AdamW</strong></td>\n<td><code>torch.optim.AdamW</code></td>\n<td>æ”¹è¿›çš„ Adamï¼ŒåŠ æƒè¡°å‡æ›´ç§‘å­¦</td>\n<td>æ¨èç”¨äº Transformer</td>\n</tr>\n<tr>\n<td><strong>Adadelta</strong></td>\n<td><code>torch.optim.Adadelta</code></td>\n<td>æ”¹è¿› Adagradï¼Œé¿å…å­¦ä¹ ç‡æ¶ˆå¤±</td>\n<td>å°‘ç”¨ä½†å¯é€‰</td>\n</tr>\n<tr>\n<td><strong>NAdam</strong></td>\n<td><code>torch.optim.NAdam</code></td>\n<td>Adam + Nesterov åŠ¨é‡</td>\n<td>æ›´å¿«çš„æ”¶æ•›æ€§</td>\n</tr>\n<tr>\n<td><strong>RAdam</strong></td>\n<td><code>torch.optim.RAdam</code></td>\n<td>ä¿®æ­£åˆå§‹è®­ç»ƒé˜¶æ®µä¸ç¨³å®š</td>\n<td>æ›´é²æ£’äºè®­ç»ƒåˆæœŸ</td>\n</tr>\n<tr>\n<td><strong>LAMB</strong></td>\n<td>æ— å®˜æ–¹æ”¯æŒï¼ˆç”¨ HuggingFace ä¼˜åŒ–å™¨ï¼‰</td>\n<td>å¤§æ¨¡å‹ï¼ˆå¦‚ BERTï¼‰é€‚ç”¨</td>\n<td>ç”¨äºå¤§ batch è®­ç»ƒ</td>\n</tr>\n<tr>\n<td><strong>AdaBelief</strong></td>\n<td>ç¬¬ä¸‰æ–¹åº“</td>\n<td>æ”¹è¿› Adamï¼Œä½¿æ›´æ–°æ›´åƒ SGD</td>\n<td>æ”¶æ•›å¿« + æ³›åŒ–å¼º</td>\n</tr>\n</tbody>\n</table>\n<hr>\n<h3 id=\"26æ•´ä¸ªç¥ç»ç½‘ç»œè¿‡ç¨‹\"><a class=\"anchor\" href=\"#26æ•´ä¸ªç¥ç»ç½‘ç»œè¿‡ç¨‹\">#</a> 2.6æ•´ä¸ªç¥ç»ç½‘ç»œè¿‡ç¨‹</h3>\n<p>ç»¼ä¸Šæ‰€è¿°ï¼Œæˆ‘ä»¬å¾—åˆ°ä¸€ä¸ªç¥ç»ç½‘ç»œçš„æ•´ä¸ªè¿‡ç¨‹ï¼Œæ ¹æ®ä¸Šé¢å·²ç»å®šä¹‰å¥½çš„å‰é¦ˆç¥ç»ç½‘ç»œè¿›è¡Œä¸€ä¸ªç®€å•è¡¥å……</p>\n<pre class=\"shiki shiki-themes vitesse-light vitesse-dark\" style=\"background-color:#ffffff;--shiki-dark-bg:#121212;color:#393a34;--shiki-dark:#dbd7caee\" tabindex=\"0\"><code class=\"language-bash\"><span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">import</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> torch</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">import</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> torch.nn</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> as</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> nn</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">import</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> torch.optim</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> as</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> optim</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\"># å®šä¹‰ä¸€ä¸ªç®€å•çš„å‰é¦ˆç¥ç»ç½‘ç»œï¼ˆè¾“å…¥å±‚ â†’ éšè—å±‚ â†’ è¾“å‡ºå±‚ï¼‰</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">class</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> SimpleFNN</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#59873A;--shiki-dark:#80A665\">nn.Module</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">:</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">    def</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> __init__</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#59873A;--shiki-dark:#80A665\">self</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">:</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">        super</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#59873A;--shiki-dark:#80A665\">SimpleFNN,</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> self</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span><span style=\"color:#59873A;--shiki-dark:#80A665\">.__init__</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">        self.fc1</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> =</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> nn.Linear</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#59873A;--shiki-dark:#80A665\">4,</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\"> 8</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\">   # è¾“å…¥å±‚4ä¸ªç‰¹å¾ï¼Œéšè—å±‚8ä¸ªç¥ç»å…ƒ</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">        self.relu</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> =</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> nn.ReLU</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\">        # æ¿€æ´»å‡½æ•°</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">        self.fc2</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> =</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> nn.Linear</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#59873A;--shiki-dark:#80A665\">8,</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\"> 3</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\">   # è¾“å‡ºå±‚3ä¸ªç±»åˆ«ï¼ˆé€‚åˆåšåˆ†ç±»ï¼‰</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">    def</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> forward</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#59873A;--shiki-dark:#80A665\">self,</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> x</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">:</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">        x</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> =</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> self.fc1</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#59873A;--shiki-dark:#80A665\">x</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">        x</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> =</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> self.relu</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#59873A;--shiki-dark:#80A665\">x</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">        x</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> =</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> self.fc2</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#59873A;--shiki-dark:#80A665\">x</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span></span>\n<span class=\"line\"><span style=\"color:#1E754F;--shiki-dark:#4D9375\">        return</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> x</span><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\">  # è¾“å‡ºä¸º logitsï¼Œæœªç»è¿‡ softmax</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\"># åˆ›å»ºæ¨¡å‹å®ä¾‹</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">model</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> =</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> SimpleFNN</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span></span>\n<span class=\"line\"><span style=\"color:#998418;--shiki-dark:#B8A965\">print</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">model</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\"># åˆ›å»ºä¸€ä¸ªæ ·æœ¬è¾“å…¥ï¼šbatch_size=2ï¼Œ4ä¸ªç‰¹å¾,2ä¸ªæ ·æœ¬+4ä¸ªç‰¹å¾</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">sample_input</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> =</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> torch.randn</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#59873A;--shiki-dark:#80A665\">2,</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\"> 4</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span></span>\n<span class=\"line\"><span style=\"color:#998418;--shiki-dark:#B8A965\">print</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#59873A;--shiki-dark:#80A665\">\"Input:\\n\"</span><span style=\"color:#59873A;--shiki-dark:#80A665\">,</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> sample_input</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\"># å‡è®¾çœŸå®æ ‡ç­¾ï¼ˆground truthï¼‰ï¼Œbatch ä¸­ä¸¤ä¸ªæ ·æœ¬åˆ†åˆ«æ˜¯ç±» 1 å’Œç±» 2</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">labels</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> =</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> torch.tensor</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">[</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">1, 2</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">]</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\"># å®šä¹‰æŸå¤±å‡½æ•°ï¼šäº¤å‰ç†µæŸå¤±ç”¨äºå¤šåˆ†ç±»é—®é¢˜</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">criterion</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> =</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> nn.CrossEntropyLoss</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\"># å®šä¹‰ä¼˜åŒ–å™¨ï¼šSGDä¼˜åŒ–å™¨ï¼Œå­¦ä¹ ç‡ä¸º0.01</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">optimizer</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> =</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> optim.SGD</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#59873A;--shiki-dark:#80A665\">model.parameters</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">(</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">)</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">, </span><span style=\"color:#B07D48;--shiki-dark:#BD976A\">lr</span><span style=\"color:#999999;--shiki-dark:#666666\">=</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">0.01</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\"># ----------- æ¨¡æ‹Ÿä¸€æ¬¡è®­ç»ƒæ­¥éª¤ -----------</span></span>\n<span class=\"line\"><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\"># å‰å‘ä¼ æ’­ï¼šå°†è¾“å…¥é€å…¥æ¨¡å‹</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">outputs</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> =</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> model</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#59873A;--shiki-dark:#80A665\">sample_input</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span></span>\n<span class=\"line\"><span style=\"color:#998418;--shiki-dark:#B8A965\">print</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#59873A;--shiki-dark:#80A665\">\"Model raw output (logits):\\n\"</span><span style=\"color:#59873A;--shiki-dark:#80A665\">,</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> outputs</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\"># è®¡ç®—æŸå¤±ï¼ˆCrossEntropyLosså†…éƒ¨åŒ…å«äº†softmaxï¼‰</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">loss</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> =</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> criterion</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#59873A;--shiki-dark:#80A665\">outputs,</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> labels</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span></span>\n<span class=\"line\"><span style=\"color:#998418;--shiki-dark:#B8A965\">print</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#59873A;--shiki-dark:#80A665\">\"Loss:\"</span><span style=\"color:#59873A;--shiki-dark:#80A665\">,</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> loss.item</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">(</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">)</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\"># æ¸…ç©ºä¹‹å‰çš„æ¢¯åº¦</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">optimizer.zero_grad</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\"># åå‘ä¼ æ’­ï¼šè‡ªåŠ¨è®¡ç®—æ¢¯åº¦</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">loss.backward</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\"># æ›´æ–°æƒé‡å’Œåç½®</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">optimizer.step</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span></span>\n<span class=\"line\"></span></code></pre>\n<hr>\n<h2 id=\"ä¸‰-æ•°æ®çš„å¤„ç†å’ŒåŠ è½½\"><a class=\"anchor\" href=\"#ä¸‰-æ•°æ®çš„å¤„ç†å’ŒåŠ è½½\">#</a> ä¸‰ã€æ•°æ®çš„å¤„ç†å’ŒåŠ è½½</h2>\n<h3 id=\"31datasetå’Œdataloader\"><a class=\"anchor\" href=\"#31datasetå’Œdataloader\">#</a> 3.1Datasetå’ŒDataLoader</h3>\n<p>Datasetæœ¬èº«æ˜¯ä¸€ä¸ªæŠ½è±¡ç±»ï¼Œå…è®¸ä½ ä»¥å®ƒä¸ºçˆ¶ç±»å®šä¹‰ä¸€ä¸ªè‡ªå·±çš„æ•°æ®é›†</p>\n<pre class=\"shiki shiki-themes vitesse-light vitesse-dark\" style=\"background-color:#ffffff;--shiki-dark-bg:#121212;color:#393a34;--shiki-dark:#dbd7caee\" tabindex=\"0\"><code class=\"language-bash\"><span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">import</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> torch</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">from</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> torch.utils.data</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> import</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> Dataset</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\"># è‡ªå®šä¹‰æ•°æ®é›†ç±»</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">class</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> MyDataset</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#59873A;--shiki-dark:#80A665\">Dataset</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">:</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">    def</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> __init__</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#59873A;--shiki-dark:#80A665\">self,</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> X_data,</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> Y_data</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">:</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">        \"\"\"</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">        åˆå§‹åŒ–æ•°æ®é›†ï¼ŒX_data å’Œ Y_data æ˜¯ä¸¤ä¸ªåˆ—è¡¨æˆ–æ•°ç»„</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">        X_data: è¾“å…¥ç‰¹å¾</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">        Y_data: ç›®æ ‡æ ‡ç­¾</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">        \"\"\"</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">        self.X_data</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> =</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> X_data</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">        self.Y_data</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> =</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> Y_data</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">    def</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> __len__</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#59873A;--shiki-dark:#80A665\">self</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">:</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">        \"\"\"è¿”å›æ•°æ®é›†çš„å¤§å°\"\"\"</span></span>\n<span class=\"line\"><span style=\"color:#1E754F;--shiki-dark:#4D9375\">        return</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> len</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#59873A;--shiki-dark:#80A665\">self.X_data</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">    def</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> __getitem__</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#59873A;--shiki-dark:#80A665\">self,</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> idx</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">:</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">        \"\"\"è¿”å›æŒ‡å®šç´¢å¼•çš„æ•°æ®\"\"\"</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">        x</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> =</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> torch.tensor</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#59873A;--shiki-dark:#80A665\">self.X_data</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">[</span><span style=\"color:#59873A;--shiki-dark:#80A665\">idx</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">]</span><span style=\"color:#59873A;--shiki-dark:#80A665\">,</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> dtype=torch.float32</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\">  # è½¬æ¢ä¸º Tensor</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">        y</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> =</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> torch.tensor</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#59873A;--shiki-dark:#80A665\">self.Y_data</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">[</span><span style=\"color:#59873A;--shiki-dark:#80A665\">idx</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">]</span><span style=\"color:#59873A;--shiki-dark:#80A665\">,</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> dtype=torch.float32</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span></span>\n<span class=\"line\"><span style=\"color:#1E754F;--shiki-dark:#4D9375\">        return</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> x,</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> y</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\"># ç¤ºä¾‹æ•°æ®</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">X_data</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> =</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\"> </span><span style=\"color:rgba(255, 18, 18, 0.8);--shiki-dark:rgba(255, 18, 18, 0.8)\">[</span><span style=\"color:rgba(255, 18, 18, 0.8);--shiki-dark:rgba(255, 18, 18, 0.8)\">[</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">1, </span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">2],</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\"> </span><span style=\"color:rgba(255, 18, 18, 0.8);--shiki-dark:rgba(255, 18, 18, 0.8)\">[</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">3, </span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">4],</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\"> </span><span style=\"color:rgba(255, 18, 18, 0.8);--shiki-dark:rgba(255, 18, 18, 0.8)\">[</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">5, </span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">6],</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\"> </span><span style=\"color:rgba(255, 18, 18, 0.8);--shiki-dark:rgba(255, 18, 18, 0.8)\">[</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">7, </span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">8]]</span><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\">  # è¾“å…¥ç‰¹å¾</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">Y_data</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> =</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\"> </span><span style=\"color:rgba(255, 18, 18, 0.8);--shiki-dark:rgba(255, 18, 18, 0.8)\">[</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">1, </span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">0,</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> 1,</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> 0]</span><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\">  # ç›®æ ‡æ ‡ç­¾</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\"># åˆ›å»ºæ•°æ®é›†å®ä¾‹    </span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">dataset</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> =</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> MyDataset</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#59873A;--shiki-dark:#80A665\">X_data,</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> Y_data</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span></span></code></pre>\n<p>DataLoaderå¯ä»¥ç”¨äºæŒ‰æ‰¹æ¬¡(batch)ä»Datasetä¸­åŠ è½½æ•°æ®</p>\n<pre class=\"shiki shiki-themes vitesse-light vitesse-dark\" style=\"background-color:#ffffff;--shiki-dark-bg:#121212;color:#393a34;--shiki-dark:#dbd7caee\" tabindex=\"0\"><code class=\"language-bash\"><span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">from</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> torch.utils.data</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> import</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> DataLoader</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\"># åˆ›å»º DataLoader å®ä¾‹ï¼Œbatch_size è®¾ç½®æ¯æ¬¡åŠ è½½çš„æ ·æœ¬æ•°é‡,å…¶ä¸­shuffleè¡¨ç¤ºæ˜¯å¦å¯¹æ•°æ®è¿›è¡Œæ´—ç‰Œï¼Œé€šå¸¸è®­ç»ƒæ—¶éœ€è¦å°†æ•°æ®æ‰“ä¹±ã€‚</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">dataloader</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> =</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> DataLoader</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#59873A;--shiki-dark:#80A665\">dataset,</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> batch_size=2,</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> shuffle=True</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\"># æ‰“å°åŠ è½½çš„æ•°æ®</span></span>\n<span class=\"line\"><span style=\"color:#1E754F;--shiki-dark:#4D9375\">for</span><span style=\"color:#B07D48;--shiki-dark:#BD976A\"> epoch</span><span style=\"color:#1E754F;--shiki-dark:#4D9375\"> in</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> range</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#59873A;--shiki-dark:#80A665\">1</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">:</span></span>\n<span class=\"line\"><span style=\"color:#1E754F;--shiki-dark:#4D9375\">    for</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\"> batch_idx, </span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#59873A;--shiki-dark:#80A665\">inputs,</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> labels</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\"> in enumerate</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#59873A;--shiki-dark:#80A665\">dataloader</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">:</span></span>\n<span class=\"line\"><span style=\"color:#998418;--shiki-dark:#B8A965\">        print</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">f</span><span style=\"color:#59873A;--shiki-dark:#80A665\">'Batch {batch_idx + 1}:'</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span></span>\n<span class=\"line\"><span style=\"color:#998418;--shiki-dark:#B8A965\">        print</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">f</span><span style=\"color:#59873A;--shiki-dark:#80A665\">'Inputs: {inputs}'</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span></span>\n<span class=\"line\"><span style=\"color:#998418;--shiki-dark:#B8A965\">        print</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">f</span><span style=\"color:#59873A;--shiki-dark:#80A665\">'Labels: {labels}'</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span></span></code></pre>\n<pre class=\"shiki shiki-themes vitesse-light vitesse-dark\" style=\"background-color:#ffffff;--shiki-dark-bg:#121212;color:#393a34;--shiki-dark:#dbd7caee\" tabindex=\"0\"><code class=\"language-bash\"><span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">Batch</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> 1:</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">Inputs:</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> tensor</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">[</span><span style=\"color:#a65e2b;--shiki-dark:#d4976c\">[</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">3., 4.</span><span style=\"color:#a65e2b;--shiki-dark:#d4976c\">]</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">, </span><span style=\"color:#a65e2b;--shiki-dark:#d4976c\">[</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">1., 2.</span><span style=\"color:#a65e2b;--shiki-dark:#d4976c\">]</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">]</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span></span>\n<span class=\"line\"><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">Labels: tensor</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">[</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\">0</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">.</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\">,</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\"> 1</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">.</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">]</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span></span>\n<span class=\"line\"><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">Batch 2:</span></span>\n<span class=\"line\"><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">Inputs: tensor</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">[</span><span style=\"color:#a65e2b;--shiki-dark:#d4976c\">[</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\">7</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">.</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\">,</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\"> 8</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">.</span><span style=\"color:#a65e2b;--shiki-dark:#d4976c\">]</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\">,</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\"> </span><span style=\"color:#a65e2b;--shiki-dark:#d4976c\">[</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\">5</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">.</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\">,</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\"> 6</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">.</span><span style=\"color:#a65e2b;--shiki-dark:#d4976c\">]</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">]</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span></span>\n<span class=\"line\"><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">Labels: tensor</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">[</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\">0</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">.</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\">,</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\"> 1</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">.</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">]</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span></span></code></pre>\n<h3 id=\"32å¯¹å›¾åƒæ•°æ®é¢„å¤„ç†å’Œå¢å¼º\"><a class=\"anchor\" href=\"#32å¯¹å›¾åƒæ•°æ®é¢„å¤„ç†å’Œå¢å¼º\">#</a> 3.2å¯¹å›¾åƒæ•°æ®é¢„å¤„ç†å’Œå¢å¼º</h3>\n<p>åœ¨pytorchä¸­æˆ‘ä»¬ç»å¸¸åˆ©ç”¨ <code>torchvision.transforms</code>æ¨¡å—å¯¹å›¾åƒæ•°æ®è¿›è¡Œé¢„å¤„ç†å’Œå¢å¼º</p>\n<pre class=\"shiki shiki-themes vitesse-light vitesse-dark\" style=\"background-color:#ffffff;--shiki-dark-bg:#121212;color:#393a34;--shiki-dark:#dbd7caee\" tabindex=\"0\"><code class=\"language-bash\"><span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">import</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> torchvision.transforms</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> as</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> transforms</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">from</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> PIL</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> import</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> Image</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\"># å®šä¹‰æ•°æ®é¢„å¤„ç†çš„æµæ°´çº¿</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">transform</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> =</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> transforms.Compose</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">[</span></span>\n<span class=\"line\"><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">    transforms.Resize</span><span style=\"color:#a65e2b;--shiki-dark:#d4976c\">(</span><span style=\"color:#a13865;--shiki-dark:#d9739f\">(</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\">128</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\">,</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\"> 128</span><span style=\"color:#a13865;--shiki-dark:#d9739f\">)</span><span style=\"color:#a65e2b;--shiki-dark:#d4976c\">)</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">,  </span><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\"># å°†å›¾åƒè°ƒæ•´ä¸º 128x128</span></span>\n<span class=\"line\"><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">    transforms.ToTensor</span><span style=\"color:#a65e2b;--shiki-dark:#d4976c\">(</span><span style=\"color:#a65e2b;--shiki-dark:#d4976c\">)</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">,  </span><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\"># å°†å›¾åƒè½¬æ¢ä¸ºå¼ é‡</span></span>\n<span class=\"line\"><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">    transforms.Normalize</span><span style=\"color:#a65e2b;--shiki-dark:#d4976c\">(</span><span style=\"color:#B07D48;--shiki-dark:#BD976A\">mean</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\">=</span><span style=\"color:#a13865;--shiki-dark:#d9739f\">[</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\">0</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">.</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\">485</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\">,</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\"> 0</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">.</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\">456</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\">,</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\"> 0</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">.</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\">406</span><span style=\"color:#a13865;--shiki-dark:#d9739f\">]</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\">,</span><span style=\"color:#B07D48;--shiki-dark:#BD976A\"> std</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\">=</span><span style=\"color:#a13865;--shiki-dark:#d9739f\">[</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\">0</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">.</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\">229</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\">,</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\"> 0</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">.</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\">224</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\">,</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\"> 0</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">.</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\">225</span><span style=\"color:#a13865;--shiki-dark:#d9739f\">]</span><span style=\"color:#a65e2b;--shiki-dark:#d4976c\">)</span><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\">  # æ ‡å‡†åŒ–</span></span>\n<span class=\"line\"><span style=\"color:#1e754f;--shiki-dark:#4d9375\">]</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\"># åŠ è½½å›¾åƒ</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">image</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> =</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> Image.open</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#59873A;--shiki-dark:#80A665\">'image.jpg'</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\"># åº”ç”¨é¢„å¤„ç†</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">image_tensor</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> =</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> transform</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#59873A;--shiki-dark:#80A665\">image</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span></span>\n<span class=\"line\"><span style=\"color:#998418;--shiki-dark:#B8A965\">print</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">image_tensor.shape</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">  </span><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\"># è¾“å‡ºå¼ é‡çš„å½¢çŠ¶</span></span></code></pre>\n<p>å¸¸è§é¢„å¤„ç†æ–¹å¼ï¼š</p>\n<table>\n<thead>\n<tr>\n<th>æ–¹æ³•</th>\n<th>è¯´æ˜</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td><code>transforms.Resize(size)</code></td>\n<td>è°ƒæ•´å›¾åƒå¤§å°ä¸ºå›ºå®šå°ºå¯¸ï¼Œä¾‹å¦‚ <code>(128, 128)</code></td>\n</tr>\n<tr>\n<td><code>transforms.CenterCrop(size)</code></td>\n<td>ä»ä¸­å¿ƒè£å‰ªå›ºå®šå¤§å°</td>\n</tr>\n<tr>\n<td><code>transforms.ToTensor()</code></td>\n<td>å°† PIL.Image æˆ– numpy.ndarray è½¬ä¸º <code>[0, 1]</code> çš„å¼ é‡</td>\n</tr>\n<tr>\n<td><code>transforms.Normalize(mean, std)</code></td>\n<td>æŒ‰é€šé“æ ‡å‡†åŒ–ï¼Œå¸¸ç”¨äºé¢„è®­ç»ƒæ¨¡å‹è¾“å…¥è¦æ±‚</td>\n</tr>\n</tbody>\n</table>\n<p>å¸¸è§æ•°æ®å¢å¼ºæ–¹å¼ï¼š</p>\n<table>\n<thead>\n<tr>\n<th></th>\n<th>æ–¹æ³•</th>\n<th>è¯´æ˜</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td><code>transforms.RandomHorizontalFlip(p=0.5)</code></td>\n<td>ä»¥æ¦‚ç‡ <code>p</code> æ°´å¹³ç¿»è½¬å›¾åƒ</td>\n</tr>\n<tr>\n<td><code>transforms.RandomVerticalFlip()</code></td>\n<td>å‚ç›´ç¿»è½¬</td>\n</tr>\n<tr>\n<td><code>transforms.RandomRotation(degrees)</code></td>\n<td>éšæœºæ—‹è½¬å›¾åƒï¼ˆè§’åº¦èŒƒå›´ï¼‰</td>\n</tr>\n<tr>\n<td><code>transforms.ColorJitter()</code></td>\n<td>æ”¹å˜å›¾åƒçš„äº®åº¦ã€å¯¹æ¯”åº¦ã€é¥±å’Œåº¦ç­‰</td>\n</tr>\n<tr>\n<td><code>transforms.RandomResizedCrop(size)</code></td>\n<td>éšæœºè£å‰ªåç¼©æ”¾åˆ°å›ºå®šå°ºå¯¸</td>\n</tr>\n<tr>\n<td><code>transforms.RandomAffine(degrees, translate, scale, shear)</code></td>\n<td>éšæœºä»¿å°„å˜æ¢</td>\n</tr>\n</tbody>\n</table>\n<p>å¦‚ä½•å¯¹å›¾åƒæ•°æ®é›†è¿›è¡ŒåŠ è½½å‘¢ï¼Œæˆ‘ä»¬å¸¸åˆ©ç”¨<code>torchvision.datasets</code>å¯¹å›¾åƒæ•°æ®é›†è¿›è¡ŒåŠ è½½</p>\n<p>å¯¹äºå›¾åƒæ•°æ®é›†ï¼Œ<code>torchvision.datasets</code> æä¾›äº†è®¸å¤šå¸¸è§æ•°æ®é›†ï¼ˆå¦‚ CIFAR-10ã€ImageNetã€MNIST ç­‰ï¼‰ä»¥åŠç”¨äºåŠ è½½å›¾åƒæ•°æ®çš„å·¥å…·</p>\n<pre class=\"shiki shiki-themes vitesse-light vitesse-dark\" style=\"background-color:#ffffff;--shiki-dark-bg:#121212;color:#393a34;--shiki-dark:#dbd7caee\" tabindex=\"0\"><code class=\"language-bash\"><span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">import</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> torchvision.datasets</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> as</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> datasets</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">import</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> torchvision.transforms</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> as</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> transforms</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\"># å®šä¹‰é¢„å¤„ç†æ“ä½œ</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">transform</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> =</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> transforms.Compose</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">[</span></span>\n<span class=\"line\"><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">    transforms.ToTensor</span><span style=\"color:#a65e2b;--shiki-dark:#d4976c\">(</span><span style=\"color:#a65e2b;--shiki-dark:#d4976c\">)</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">,</span></span>\n<span class=\"line\"><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">    transforms.Normalize</span><span style=\"color:#a65e2b;--shiki-dark:#d4976c\">(</span><span style=\"color:#a13865;--shiki-dark:#d9739f\">(</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\">0</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">.</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\">5</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\">,</span><span style=\"color:#a13865;--shiki-dark:#d9739f\">)</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">, </span><span style=\"color:#a13865;--shiki-dark:#d9739f\">(</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\">0</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">.</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\">5</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\">,</span><span style=\"color:#a13865;--shiki-dark:#d9739f\">)</span><span style=\"color:#a65e2b;--shiki-dark:#d4976c\">)</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">  </span><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\"># å¯¹ç°åº¦å›¾åƒè¿›è¡Œæ ‡å‡†åŒ–</span></span>\n<span class=\"line\"><span style=\"color:#1e754f;--shiki-dark:#4d9375\">]</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\"># ä¸‹è½½å¹¶åŠ è½½ MNIST æ•°æ®é›†</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">train_dataset</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> =</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> datasets.MNIST</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#B07D48;--shiki-dark:#BD976A\">root</span><span style=\"color:#999999;--shiki-dark:#666666\">=</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\">'</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">./data</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\">'</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">,</span><span style=\"color:#B07D48;--shiki-dark:#BD976A\"> train</span><span style=\"color:#999999;--shiki-dark:#666666\">=</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">True,</span><span style=\"color:#B07D48;--shiki-dark:#BD976A\"> download</span><span style=\"color:#999999;--shiki-dark:#666666\">=</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">True,</span><span style=\"color:#B07D48;--shiki-dark:#BD976A\"> transform</span><span style=\"color:#999999;--shiki-dark:#666666\">=</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">transform</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">test_dataset</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> =</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> datasets.MNIST</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#B07D48;--shiki-dark:#BD976A\">root</span><span style=\"color:#999999;--shiki-dark:#666666\">=</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\">'</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">./data</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\">'</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">,</span><span style=\"color:#B07D48;--shiki-dark:#BD976A\"> train</span><span style=\"color:#999999;--shiki-dark:#666666\">=</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">False,</span><span style=\"color:#B07D48;--shiki-dark:#BD976A\"> download</span><span style=\"color:#999999;--shiki-dark:#666666\">=</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">True,</span><span style=\"color:#B07D48;--shiki-dark:#BD976A\"> transform</span><span style=\"color:#999999;--shiki-dark:#666666\">=</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">transform</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\"># åˆ›å»º DataLoader</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">train_loader</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> =</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> DataLoader</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#59873A;--shiki-dark:#80A665\">train_dataset,</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> batch_size=64,</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> shuffle=True</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">test_loader</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> =</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> DataLoader</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#59873A;--shiki-dark:#80A665\">test_dataset,</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> batch_size=64,</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> shuffle=False</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\"># è¿­ä»£è®­ç»ƒæ•°æ®</span></span>\n<span class=\"line\"><span style=\"color:#1E754F;--shiki-dark:#4D9375\">for</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\"> inputs, labels in train_loader:</span></span>\n<span class=\"line\"><span style=\"color:#998418;--shiki-dark:#B8A965\">    print</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">inputs.shape</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">  </span><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\"># æ¯ä¸ªæ‰¹æ¬¡çš„è¾“å…¥æ•°æ®å½¢çŠ¶</span></span>\n<span class=\"line\"><span style=\"color:#998418;--shiki-dark:#B8A965\">    print</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">labels.shape</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">  </span><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\"># æ¯ä¸ªæ‰¹æ¬¡çš„æ ‡ç­¾å½¢çŠ¶</span></span></code></pre>\n<h3 id=\"33-pytorch-transforms\"><a class=\"anchor\" href=\"#33-pytorch-transforms\">#</a> 3.3 pytorch---transforms</h3>\n<table>\n<thead>\n<tr>\n<th>ç±»åˆ«</th>\n<th>å˜æ¢å‡½æ•°</th>\n<th>æè¿°è¯´æ˜</th>\n<th>ç¤ºä¾‹ä»£ç </th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td><strong>é¢„å¤„ç†</strong></td>\n<td><code>transforms.ToTensor()</code></td>\n<td>å°† PIL å›¾åƒæˆ– NumPy æ•°ç»„è½¬æ¢ä¸ºå¼ é‡ï¼Œå¹¶å°†åƒç´ å€¼å½’ä¸€åŒ–åˆ° <code>[0, 1]</code></td>\n<td><code>transforms.ToTensor()</code></td>\n</tr>\n<tr>\n<td></td>\n<td><code>transforms.Normalize(mean, std)</code></td>\n<td>å¯¹å›¾åƒå¼ é‡è¿›è¡Œæ ‡å‡†åŒ–ï¼ˆé›¶å‡å€¼ã€å•ä½æ–¹å·®ï¼‰</td>\n<td><code>transforms.Normalize(mean=[0.5], std=[0.5])</code></td>\n</tr>\n<tr>\n<td></td>\n<td><code>transforms.Resize(size)</code></td>\n<td>å°†å›¾åƒç¼©æ”¾åˆ°æŒ‡å®šå¤§å°ï¼ˆå®½ã€é«˜ï¼‰</td>\n<td><code>transforms.Resize((128, 128))</code></td>\n</tr>\n<tr>\n<td></td>\n<td><code>transforms.CenterCrop(size)</code></td>\n<td>ä»å›¾åƒä¸­å¿ƒè£å‰ªæŒ‡å®šå¤§å°åŒºåŸŸ</td>\n<td><code>transforms.CenterCrop(128)</code></td>\n</tr>\n<tr>\n<td><strong>å¢å¼º</strong></td>\n<td><code>transforms.RandomHorizontalFlip(p)</code></td>\n<td>ä»¥æ¦‚ç‡ <code>p</code> éšæœºæ°´å¹³ç¿»è½¬å›¾åƒ</td>\n<td><code>transforms.RandomHorizontalFlip(p=0.5)</code></td>\n</tr>\n<tr>\n<td></td>\n<td><code>transforms.RandomRotation(degrees)</code></td>\n<td>åœ¨ <code>[-degrees, +degrees]</code> èŒƒå›´å†…éšæœºæ—‹è½¬å›¾åƒ</td>\n<td><code>transforms.RandomRotation(30)</code></td>\n</tr>\n<tr>\n<td></td>\n<td><code>transforms.ColorJitter(brightness, contrast, saturation, hue)</code></td>\n<td>éšæœºè°ƒæ•´å›¾åƒçš„äº®åº¦ã€å¯¹æ¯”åº¦ã€é¥±å’Œåº¦ã€è‰²è°ƒ</td>\n<td><code>transforms.ColorJitter(brightness=0.5, contrast=0.5)</code></td>\n</tr>\n<tr>\n<td></td>\n<td><code>transforms.RandomCrop(size)</code></td>\n<td>éšæœºä»å›¾åƒä¸­è£å‰ªå‡ºæŒ‡å®šå¤§å°åŒºåŸŸ</td>\n<td><code>transforms.RandomCrop(128)</code></td>\n</tr>\n<tr>\n<td></td>\n<td><code>transforms.RandomResizedCrop(size)</code></td>\n<td>éšæœºè£å‰ªå›¾åƒçš„ä¸€éƒ¨åˆ†å¹¶ç¼©æ”¾åˆ°ç»™å®šå¤§å°</td>\n<td><code>transforms.RandomResizedCrop(224)</code></td>\n</tr>\n<tr>\n<td><strong>ç»„åˆ</strong></td>\n<td><code>transforms.Compose([...])</code></td>\n<td>å°†å¤šä¸ªå˜æ¢æŒ‰é¡ºåºç»„åˆä½¿ç”¨</td>\n<td><code>transforms.Compose([ToTensor(), Normalize(...)])</code></td>\n</tr>\n</tbody>\n</table>\n<p>è°ƒç”¨å®ä¾‹</p>\n<pre class=\"shiki shiki-themes vitesse-light vitesse-dark\" style=\"background-color:#ffffff;--shiki-dark-bg:#121212;color:#393a34;--shiki-dark:#dbd7caee\" tabindex=\"0\"><code class=\"language-bash\"><span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">transform</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> =</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> transforms.Compose</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">[</span></span>\n<span class=\"line\"><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">    transforms.Resize</span><span style=\"color:#a65e2b;--shiki-dark:#d4976c\">(</span><span style=\"color:#a13865;--shiki-dark:#d9739f\">(</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\">128</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\">,</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\"> 128</span><span style=\"color:#a13865;--shiki-dark:#d9739f\">)</span><span style=\"color:#a65e2b;--shiki-dark:#d4976c\">)</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">,</span></span>\n<span class=\"line\"><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">    transforms.RandomHorizontalFlip</span><span style=\"color:#a65e2b;--shiki-dark:#d4976c\">(</span><span style=\"color:#B07D48;--shiki-dark:#BD976A\">p</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\">=</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\">0</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">.</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\">5</span><span style=\"color:#a65e2b;--shiki-dark:#d4976c\">)</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">,</span></span>\n<span class=\"line\"><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">    transforms.RandomRotation</span><span style=\"color:#a65e2b;--shiki-dark:#d4976c\">(</span><span style=\"color:#B07D48;--shiki-dark:#BD976A\">degrees</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\">=</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\">15</span><span style=\"color:#a65e2b;--shiki-dark:#d4976c\">)</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">,</span></span>\n<span class=\"line\"><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">    transforms.ToTensor</span><span style=\"color:#a65e2b;--shiki-dark:#d4976c\">(</span><span style=\"color:#a65e2b;--shiki-dark:#d4976c\">)</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">,</span></span>\n<span class=\"line\"><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">    transforms.Normalize</span><span style=\"color:#a65e2b;--shiki-dark:#d4976c\">(</span><span style=\"color:#B07D48;--shiki-dark:#BD976A\">mean</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\">=</span><span style=\"color:#a13865;--shiki-dark:#d9739f\">[</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\">0</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">.</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\">5</span><span style=\"color:#a13865;--shiki-dark:#d9739f\">]</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\">,</span><span style=\"color:#B07D48;--shiki-dark:#BD976A\"> std</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\">=</span><span style=\"color:#a13865;--shiki-dark:#d9739f\">[</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\">0</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">.</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\">5</span><span style=\"color:#a13865;--shiki-dark:#d9739f\">]</span><span style=\"color:#a65e2b;--shiki-dark:#d4976c\">)</span></span>\n<span class=\"line\"><span style=\"color:#1e754f;--shiki-dark:#4d9375\">]</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span></span></code></pre>\n<hr>\n<h2 id=\"å››-çº¿æ€§å›å½’\"><a class=\"anchor\" href=\"#å››-çº¿æ€§å›å½’\">#</a> å››ã€çº¿æ€§å›å½’</h2>\n<p>é¦–å…ˆä»€ä¹ˆæ˜¯çº¿æ€§å›å½’ï¼Œå¯ä»¥è¯´çº¿æ€§å›å½’æ˜¯ä¸€ä¸ªæ²¡æœ‰éšè—å±‚çš„å‰é¦ˆç¥ç»ç½‘ç»œï¼Œéå¸¸åŸºç¡€çš„å†…å®¹ï¼Œå¯¹äºä¸€ä¸ªç®€å•çš„çº¿æ€§å›å½’é—®é¢˜å’Œæ¨¡å‹é€šå¸¸å¯ä»¥è¡¨ç¤ºæˆï¼š</p>\n<p><span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mi>y</mi><mo>=</mo><msub><mi>a</mi><mn>1</mn></msub><mo>Ã—</mo><mi>x</mi><mo>+</mo><msub><mi>a</mi><mn>2</mn></msub><mo>Ã—</mo><mi>x</mi><mo>+</mo><mi mathvariant=\"normal\">.</mi><mi mathvariant=\"normal\">.</mi><mi mathvariant=\"normal\">.</mi><mo>+</mo><mi>b</mi></mrow><annotation encoding=\"application/x-tex\">y=a_1 \\times x+a_2 \\times x+...+b\n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.7333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">a</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">Ã—</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6667em;vertical-align:-0.0833em;\"></span><span class=\"mord mathnormal\">x</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.7333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">a</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">Ã—</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6667em;vertical-align:-0.0833em;\"></span><span class=\"mord mathnormal\">x</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6667em;vertical-align:-0.0833em;\"></span><span class=\"mord\">...</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\">b</span></span></span></span></span></p>\n<p>å¯¹æ•°æ®é›†è¿›è¡Œè®­ç»ƒï¼Œå¯¹Yè¿›è¡Œæ‹Ÿåˆ</p>\n<p>é¦–å…ˆæˆ‘ä»¬çº¿å…ˆå®šä¹‰ä¸€ä¸ªæ•°æ®é›†</p>\n<pre class=\"shiki shiki-themes vitesse-light vitesse-dark\" style=\"background-color:#ffffff;--shiki-dark-bg:#121212;color:#393a34;--shiki-dark:#dbd7caee\" tabindex=\"0\"><code class=\"language-bash\"><span class=\"line\"><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\"># éšæœºç§å­ï¼Œç¡®ä¿æ¯æ¬¡è¿è¡Œç»“æœä¸€è‡´</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">torch.manual_seed</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#59873A;--shiki-dark:#80A665\">42</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\"># ç”Ÿæˆè®­ç»ƒæ•°æ®</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">X</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> =</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> torch.randn</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#59873A;--shiki-dark:#80A665\">100,</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\"> 2</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\">  # 100 ä¸ªæ ·æœ¬ï¼Œæ¯ä¸ªæ ·æœ¬ 2 ä¸ªç‰¹å¾</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">true_w</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> =</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> torch.tensor</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">[</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">2.0, 3.0</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">]</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\">  # å‡è®¾çœŸå®æƒé‡</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">true_b</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> =</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\"> 4.0</span><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\">  # åç½®é¡¹</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">Y</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> =</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> X</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> @</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> true_w</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> +</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> true_b</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> +</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> torch.randn</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#59873A;--shiki-dark:#80A665\">100</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span><span style=\"color:#A65E2B;--shiki-dark:#C99076\"> *</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\"> 0.1</span><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\">  # åŠ å…¥ä¸€äº›å™ªå£°</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\"># æ‰“å°éƒ¨åˆ†æ•°æ®</span></span>\n<span class=\"line\"><span style=\"color:#998418;--shiki-dark:#B8A965\">print</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">X[:5]</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span></span>\n<span class=\"line\"><span style=\"color:#998418;--shiki-dark:#B8A965\">print</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">Y[:5]</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span></span></code></pre>\n<p>ä¹‹åæˆ‘ä»¬å†å®šä¹‰ä¸€ä¸ªçº¿æ€§å›å½’çš„æ¨¡å‹ç±»</p>\n<pre class=\"shiki shiki-themes vitesse-light vitesse-dark\" style=\"background-color:#ffffff;--shiki-dark-bg:#121212;color:#393a34;--shiki-dark:#dbd7caee\" tabindex=\"0\"><code class=\"language-bash\"><span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">class</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> LinearRegressionModel</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#59873A;--shiki-dark:#80A665\">nn.Module</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">:</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">    def</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> __init__</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#59873A;--shiki-dark:#80A665\">self</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">:</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">        super</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#59873A;--shiki-dark:#80A665\">LinearRegressionModel,self</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span><span style=\"color:#59873A;--shiki-dark:#80A665\">.__init__</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">        self.linear</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> =</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> nn.Linear</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#59873A;--shiki-dark:#80A665\">2,</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\"> 1</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">    def</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> forward</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#59873A;--shiki-dark:#80A665\">self,</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> x</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">:</span></span>\n<span class=\"line\"><span style=\"color:#1E754F;--shiki-dark:#4D9375\">        return</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> self.linear</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#59873A;--shiki-dark:#80A665\">x</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span></span></code></pre>\n<p>å…¶ä¸­<code>super(LinearRegressionModel,self).__init__()</code>è¿™ç‚¹æ˜¯å…³é”®ï¼šå­ç±»ç»§æ‰¿çˆ¶ç±»æ—¶ï¼Œä¸è‡ªåŠ¨è°ƒç”¨çˆ¶ç±»çš„æ„é€ å‡½æ•°ï¼Œä½ å¿…é¡»æ˜¾å¼è°ƒç”¨å®ƒã€‚PyTorch ä¸­æ‰€æœ‰è‡ªå®šä¹‰æ¨¡å‹éƒ½è¦ç»§æ‰¿è‡ª nn.Moduleã€‚nn.Module æä¾›äº†å¾ˆå¤šæ ¸å¿ƒåŠŸèƒ½ã€‚</p>\n<p>ä¹‹åæˆ‘ä»¬å®ä¾‹åŒ–è¯¥æ¨¡å‹ï¼Œå¹¶å®šä¹‰åç»­éœ€è¦çš„æŸå¤±å‡½æ•°å’Œä¼˜åŒ–å™¨</p>\n<pre class=\"shiki shiki-themes vitesse-light vitesse-dark\" style=\"background-color:#ffffff;--shiki-dark-bg:#121212;color:#393a34;--shiki-dark:#dbd7caee\" tabindex=\"0\"><code class=\"language-bash\"><span class=\"line\"><span style=\"color:#B07D48;--shiki-dark:#BD976A\">model</span><span style=\"color:#999999;--shiki-dark:#666666\">=</span><span style=\"color:#59873A;--shiki-dark:#80A665\"> LinearRegressionModel</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">criterion</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> =</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> nn.MSELoss</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">optimizer</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> =</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> optim.SGD</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#59873A;--shiki-dark:#80A665\">model.parameters</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">(</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">)</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">, </span><span style=\"color:#B07D48;--shiki-dark:#BD976A\">lr</span><span style=\"color:#999999;--shiki-dark:#666666\">=</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">0.01</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span></span></code></pre>\n<p>æ¥ä¸‹æ¥ä¾¿å¯ä»¥å¯¹æ¨¡å‹è¿›è¡Œè®­ç»ƒäº†</p>\n<pre class=\"shiki shiki-themes vitesse-light vitesse-dark\" style=\"background-color:#ffffff;--shiki-dark-bg:#121212;color:#393a34;--shiki-dark:#dbd7caee\" tabindex=\"0\"><code class=\"language-bash\"><span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">num_epochs</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> =</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\"> 100</span></span>\n<span class=\"line\"><span style=\"color:#1E754F;--shiki-dark:#4D9375\">for</span><span style=\"color:#B07D48;--shiki-dark:#BD976A\"> epoch</span><span style=\"color:#1E754F;--shiki-dark:#4D9375\"> in</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> range</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#59873A;--shiki-dark:#80A665\">num_epochs</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">:</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">    model.train</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span></span>\n<span class=\"line\"><span style=\"color:#B07D48;--shiki-dark:#BD976A\">    predictions</span><span style=\"color:#999999;--shiki-dark:#666666\">=</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">model</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#59873A;--shiki-dark:#80A665\">X</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span></span>\n<span class=\"line\"><span style=\"color:#B07D48;--shiki-dark:#BD976A\">    loss</span><span style=\"color:#999999;--shiki-dark:#666666\">=</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">criterion</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#59873A;--shiki-dark:#80A665\">predictions.squeeze</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">(</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">)</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">, Y</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span></span>\n<span class=\"line\"><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\">        # åå‘ä¼ æ’­</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">    optimizer.zero_grad</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\">  # æ¸…ç©ºä¹‹å‰çš„æ¢¯åº¦</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">    loss.backward</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\">  # è®¡ç®—æ¢¯åº¦</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">    optimizer.step</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\">  # æ›´æ–°æ¨¡å‹å‚æ•°</span></span></code></pre>\n<p>æœ€åå°†æ•°æ®å¯è§†åŒ–æŸ¥çœ‹åˆ†æç»“æœ</p>\n<pre class=\"shiki shiki-themes vitesse-light vitesse-dark\" style=\"background-color:#ffffff;--shiki-dark-bg:#121212;color:#393a34;--shiki-dark:#dbd7caee\" tabindex=\"0\"><code class=\"language-bash\"><span class=\"line\"><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\"># æŸ¥çœ‹è®­ç»ƒåçš„æƒé‡å’Œåç½®</span></span>\n<span class=\"line\"><span style=\"color:#998418;--shiki-dark:#B8A965\">print</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">f</span><span style=\"color:#59873A;--shiki-dark:#80A665\">'Predicted weight: {model.linear.weight.data.numpy()}'</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span></span>\n<span class=\"line\"><span style=\"color:#998418;--shiki-dark:#B8A965\">print</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">f</span><span style=\"color:#59873A;--shiki-dark:#80A665\">'Predicted bias: {model.linear.bias.data.numpy()}'</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\"># åœ¨æ–°æ•°æ®ä¸Šåšé¢„æµ‹</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">with</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> torch.no_grad</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">:</span><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\">  # è¯„ä¼°æ—¶ä¸éœ€è¦è®¡ç®—æ¢¯åº¦</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">    predictions</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> =</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> model</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#59873A;--shiki-dark:#80A665\">X</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\"># å¯è§†åŒ–é¢„æµ‹ä¸å®é™…å€¼</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">plt.scatter</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#59873A;--shiki-dark:#80A665\">X</span><span style=\"color:rgba(255, 18, 18, 0.8);--shiki-dark:rgba(255, 18, 18, 0.8)\">[</span><span style=\"color:#59873A;--shiki-dark:#80A665\">:,</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> 0],</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> Y,</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> color=</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\">'</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">blue</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\">'</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">,</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> label=</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\">'</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">True values</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\">'</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">plt.scatter</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#59873A;--shiki-dark:#80A665\">X</span><span style=\"color:rgba(255, 18, 18, 0.8);--shiki-dark:rgba(255, 18, 18, 0.8)\">[</span><span style=\"color:#59873A;--shiki-dark:#80A665\">:,</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> 0],</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> predictions,</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> color=</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\">'</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">red</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\">'</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">,</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> label=</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\">'</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">Predictions</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\">'</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">plt.legend</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">plt.show</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span></span></code></pre>\n<p><img loading=\"lazy\" src=\"/images/pytorch/linearRgression.png\" alt=\"ex4\"></p>\n<p>è®­ç»ƒè¿‡ç¨‹ï¼Œéšç€losså‡å°ï¼Œæ¨¡å‹çš„æƒé‡å’Œåç½®å°†ä¸æ–­å’Œtrue_wå’Œtrue_bç›¸æ¥è¿‘</p>\n<hr>\n<h2 id=\"äº”-å·ç§¯ç¥ç»ç½‘ç»œ\"><a class=\"anchor\" href=\"#äº”-å·ç§¯ç¥ç»ç½‘ç»œ\">#</a> äº”ã€å·ç§¯ç¥ç»ç½‘ç»œ</h2>\n<p>æ˜¯ç”¨äºå¤„ç†å…·æœ‰ç½‘æ ¼çŠ¶æ‹“æ‰‘ç»“æ„æ•°æ®(ç½‘æ ¼çŠ¶ç»“æ„æ˜¯ä¸€ç§å°†æ•°æ®ç‚¹æŒ‰ç…§è¡Œåˆ—ï¼ˆäºŒç»´åæ ‡ï¼‰æ–¹å¼æ’åˆ—çš„æ•°æ®ç»“æ„ã€‚æ¯ä¸ªç‚¹çš„é‚»å±…æ˜¯å®ƒä¸Šä¸‹å·¦å³çš„èŠ‚ç‚¹ï¼Œç±»ä¼¼äºæ£‹ç›˜ã€å›¾åƒåƒç´ æ’åˆ—ã€æˆ–åœ°ç†æ …æ ¼ã€‚)</p>\n<pre class=\"shiki shiki-themes vitesse-light vitesse-dark\" style=\"background-color:#ffffff;--shiki-dark-bg:#121212;color:#393a34;--shiki-dark:#dbd7caee\" tabindex=\"0\"><code class=\"language-bash\"><span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">A11</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">  A12</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">  A13</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">A21</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">  A22</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">  A23</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">A31</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">  A32</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">  A33</span></span></code></pre>\n<p>è¿™æ˜¯ä¸€å¼ æ•´ä¸ªå·ç§¯ç¥ç»ç½‘ç»œè¿‡ç¨‹çš„æ€ç»´å¯¼å›¾<br>\n<img loading=\"lazy\" src=\"/images/pytorch/CNN.png\" alt=\"CNN\"></p>\n<p>å¯¹ä¸€äº›æ¦‚å¿µçš„è§£æï¼š</p>\n<ul>\n<li>æ± åŒ–å±‚ï¼šæ± åŒ–ç›¸å½“äºæŠŠä¸€ä¸ªå›¾çš„åˆ†è¾¨ç‡ç»™é™ä½ï¼Œè®©å›¾å˜å°ï¼Œå‡å°éœ€è¦å¤„ç†çš„æ•°æ®é‡åŒæ—¶ä¸æ”¹å˜å›¾çš„ç‰¹å¾</li>\n<li>å·ç§¯å±‚: æ˜¯åˆ©ç”¨å·ç§¯æ ¸åœ¨å›¾ä¸Šè¿›è¡Œç‰¹å¾æå–ï¼Œç”Ÿæˆç‰¹å¾å›¾åƒï¼Œå¦‚sobelç®—å­å°±æ˜¯æå–å›¾åƒè¾¹ç¼˜ä¿¡æ¯çš„å·ç§¯æ ¸</li>\n<li>å±•å¹³å±‚ï¼šå°†å¤šç»´çš„ç‰¹å¾å›¾è½¬æ¢ä¸ºä¸€ç»´å‘é‡ï¼Œä»¥ä¾¿è¾“å…¥åˆ°å…¨è¿æ¥å±‚\n<ul>\n<li>åœ¨ CNN çš„å‰é¢éƒ¨åˆ†ï¼Œé€šå¸¸åŒ…å«å¤šä¸ªå·ç§¯å±‚ï¼ˆConv2dï¼‰ã€æ± åŒ–å±‚ï¼ˆMaxPool2dï¼‰ï¼Œè¿™äº›æ“ä½œå¤„ç†çš„æ˜¯ 3D çš„å¼ é‡ï¼ˆå½¢çŠ¶ä¸€èˆ¬æ˜¯ [batch_size, channels, height, width]ï¼‰ã€‚ä½†å…¨è¿æ¥å±‚ï¼ˆnn.Linearï¼‰åªèƒ½æ¥æ”¶äºŒç»´çš„å¼ é‡ï¼ˆå½¢çŠ¶ [batch_size, feature_dim]ï¼‰ï¼Œæ‰€ä»¥å¿…é¡»å…ˆâ€œå±•å¹³â€å·ç§¯è¾“å‡ºã€‚</li>\n</ul>\n</li>\n<li>å…¨è¿æ¥å±‚ï¼šç±»ä¼¼äºä¼ ç»Ÿçš„ç¥ç»ç½‘ç»œå±‚ï¼Œç”¨äºå°†æå–çš„ç‰¹å¾æ˜ å°„åˆ°è¾“å‡ºç±»åˆ«</li>\n</ul>\n<p>çŸ¥é“ä¸Šé¢è¿™äº›çŸ¥è¯†ä¹‹åæ¥ä¸‹æ¥ä¾¿å¯ä»¥å®ç°ä¸€ä¸ªCNN\tæ‰‹å†™æ•°å­—å›¾åƒè¯†åˆ«çš„å®ä¾‹äº†</p>\n<p>å®šä¹‰ä¸€ä¸ªç®€å•çš„CNNæ¨¡å‹</p>\n<pre class=\"shiki shiki-themes vitesse-light vitesse-dark\" style=\"background-color:#ffffff;--shiki-dark-bg:#121212;color:#393a34;--shiki-dark:#dbd7caee\" tabindex=\"0\"><code class=\"language-bash\"><span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">class</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> SimpleCNN</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#59873A;--shiki-dark:#80A665\">nn.Module</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">:</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">    def</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> __init__</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#59873A;--shiki-dark:#80A665\">self</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">:</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">        super</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#59873A;--shiki-dark:#80A665\">SimpleCNN,</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> self</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span><span style=\"color:#59873A;--shiki-dark:#80A665\">.__init__</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span></span>\n<span class=\"line\"><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\">        # å®šä¹‰å·ç§¯å±‚ï¼šè¾“å…¥1é€šé“ï¼Œè¾“å‡º32é€šé“ï¼Œå·ç§¯æ ¸å¤§å°3x3</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">        self.conv1</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> =</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> nn.Conv2d</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#59873A;--shiki-dark:#80A665\">1,</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> 32,</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> kernel_size=3,</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> stride=1,</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> padding=</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\">1</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span></span>\n<span class=\"line\"><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\">        # å®šä¹‰å·ç§¯å±‚ï¼šè¾“å…¥32é€šé“ï¼Œè¾“å‡º64é€šé“</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">        self.conv2</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> =</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> nn.Conv2d</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#59873A;--shiki-dark:#80A665\">32,</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> 64,</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> kernel_size=3,</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> stride=1,</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> padding=</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\">1</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span></span>\n<span class=\"line\"><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\">        # å®šä¹‰å…¨è¿æ¥å±‚</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">        self.fc1</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> =</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> nn.Linear</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#59873A;--shiki-dark:#80A665\">64</span><span style=\"color:#A65E2B;--shiki-dark:#C99076\"> *</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\"> 7</span><span style=\"color:#A65E2B;--shiki-dark:#C99076\"> *</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> 7,</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\"> 128</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\">  # è¾“å…¥å¤§å° = ç‰¹å¾å›¾å¤§å° * é€šé“æ•°</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">        self.fc2</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> =</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> nn.Linear</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#59873A;--shiki-dark:#80A665\">128,</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\"> 10</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\">  # 10 ä¸ªç±»åˆ«</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">    def</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> forward</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#59873A;--shiki-dark:#80A665\">self,</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> x</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">:</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">        x</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> =</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> F.relu</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#59873A;--shiki-dark:#80A665\">self.conv1</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">(</span><span style=\"color:#59873A;--shiki-dark:#80A665\">x</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">)</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">  </span><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\"># ç¬¬ä¸€å±‚å·ç§¯ + ReLU</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">        x</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> =</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> F.max_pool2d</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#59873A;--shiki-dark:#80A665\">x,</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\"> 2</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\">     # æœ€å¤§æ± åŒ–</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">        x</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> =</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> F.relu</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#59873A;--shiki-dark:#80A665\">self.conv2</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">(</span><span style=\"color:#59873A;--shiki-dark:#80A665\">x</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">)</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">  </span><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\"># ç¬¬äºŒå±‚å·ç§¯ + ReLU</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">        x</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> =</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> F.max_pool2d</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#59873A;--shiki-dark:#80A665\">x,</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\"> 2</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\">     # æœ€å¤§æ± åŒ–</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">        x</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> =</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> x.view</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#59873A;--shiki-dark:#80A665\">-1,</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\"> 64</span><span style=\"color:#A65E2B;--shiki-dark:#C99076\"> *</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\"> 7</span><span style=\"color:#A65E2B;--shiki-dark:#C99076\"> *</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\"> 7</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\"> # å±•å¹³æ“ä½œ</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">        x</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> =</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> F.relu</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#59873A;--shiki-dark:#80A665\">self.fc1</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">(</span><span style=\"color:#59873A;--shiki-dark:#80A665\">x</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">)</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">    </span><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\"># å…¨è¿æ¥å±‚ + ReLU</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">        x</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> =</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> self.fc2</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#59873A;--shiki-dark:#80A665\">x</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\">            # å…¨è¿æ¥å±‚è¾“å‡º</span></span>\n<span class=\"line\"><span style=\"color:#1E754F;--shiki-dark:#4D9375\">        return</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> x</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\"># åˆ›å»ºæ¨¡å‹å®ä¾‹</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">model</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> =</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> SimpleCNN</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span></span></code></pre>\n<hr>\n<h2 id=\"å…­-å¾ªç¯ç¥ç»ç½‘ç»œ\"><a class=\"anchor\" href=\"#å…­-å¾ªç¯ç¥ç»ç½‘ç»œ\">#</a> å…­ã€å¾ªç¯ç¥ç»ç½‘ç»œ</h2>\n<h3 id=\"61ç†è§£å¾ªç¯rnn\"><a class=\"anchor\" href=\"#61ç†è§£å¾ªç¯rnn\">#</a> 6.1ç†è§£å¾ªç¯RNN</h3>\n<p>é¦–å…ˆä¸¢å¼ RNNå›¾æ–¹ä¾¿ç†è§£ä»€ä¹ˆæ˜¯RNN</p>\n<p><img loading=\"lazy\" src=\"/images/pytorch/RNN.png\" alt=\"RNN\"></p>\n<p>ä»ä¸Šå›¾å¯ä»¥éå¸¸ç›´è§‚çš„çœ‹ï¼Œåœ¨ RNN ä¸­ï¼Œæ•°æ®ä¸ä»…æ²¿ç€ç½‘ç»œå±‚çº§æµåŠ¨ï¼Œè¿˜ä¼šåœ¨æ¯ä¸ªæ—¶é—´æ­¥éª¤ä¸Šä¼ æ’­åˆ°å½“å‰çš„éšå±‚çŠ¶æ€ï¼Œä»è€Œå°†ä¹‹å‰çš„ä¿¡æ¯ä¼ é€’åˆ°ä¸‹ä¸€ä¸ªæ—¶é—´æ­¥éª¤ã€‚</p>\n<p>äºæ˜¯æˆ‘ä»¬å¯ä»¥å¯ä»¥å¾—åˆ°å¦‚ä¸‹ä¸¤ä¸ªå¼å­</p>\n<p><span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><msub><mi>h</mi><mi>t</mi></msub><mo>=</mo><mi>f</mi><mo stretchy=\"false\">(</mo><msub><mi>W</mi><mrow><mi>h</mi><mi>h</mi></mrow></msub><msub><mi>h</mi><mrow><mi>t</mi><mo>âˆ’</mo><mn>1</mn></mrow></msub><mo>+</mo><msub><mi>W</mi><mrow><mi>x</mi><mi>h</mi></mrow></msub><msub><mi>x</mi><mi>t</mi></msub><mo>+</mo><msub><mi>b</mi><mi>h</mi></msub><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">h_t=f(W_{hh}h_{t-1} +W_{xh}x_t+b_h)\n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8444em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">h</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2806em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">t</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">W</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">hh</span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord\"><span class=\"mord mathnormal\">h</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">t</span><span class=\"mbin mtight\">âˆ’</span><span class=\"mord mtight\">1</span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2083em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">W</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">x</span><span class=\"mord mathnormal mtight\">h</span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2806em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">t</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">b</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">h</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span></span></span></p>\n<p><span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><msub><mi>y</mi><mi>t</mi></msub><mo>=</mo><msub><mi>W</mi><mrow><mi>h</mi><mi>y</mi></mrow></msub><msub><mi>h</mi><mi>t</mi></msub><mo>+</mo><msub><mi>b</mi><mi>y</mi></msub></mrow><annotation encoding=\"application/x-tex\">y_t=W_{hy}h_t+b_y\n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2806em;\"><span style=\"top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">t</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.9805em;vertical-align:-0.2861em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">W</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">h</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03588em;\">y</span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span><span class=\"mord\"><span class=\"mord mathnormal\">h</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2806em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">t</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.9805em;vertical-align:-0.2861em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">b</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03588em;\">y</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span></span></span></span></span></p>\n<p>å…¶ä¸­:</p>\n<ul>\n<li>\n<p><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>W</mi><mrow><mi>x</mi><mi>h</mi></mrow></msub></mrow><annotation encoding=\"application/x-tex\">W_{xh}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">W</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">x</span><span class=\"mord mathnormal mtight\">h</span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>:è¾“å…¥åˆ°éšè—çŠ¶æ€çš„æƒé‡çŸ©é˜µï¼Œç”¨äºå°†è¾“å…¥<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>X</mi><mi>t</mi></msub></mrow><annotation encoding=\"application/x-tex\">X_t</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">X</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2806em;\"><span style=\"top:-2.55em;margin-left:-0.0785em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">t</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>è½¬æ¢ä¸ºéšè—çŠ¶æ€çš„ä¸€éƒ¨åˆ†</p>\n</li>\n<li>\n<p><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>W</mi><mrow><mi>h</mi><mi>h</mi></mrow></msub></mrow><annotation encoding=\"application/x-tex\">W_{hh}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">W</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">hh</span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>:éšè—çŠ¶æ€åˆ°éšè—çŠ¶æ€çš„æƒé‡çŸ©é˜µï¼Œç”¨äºå°†å‰ä¸€æ—¶é—´æ­¥çš„éšè—çŠ¶æ€<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>h</mi><mrow><mi>t</mi><mo>âˆ’</mo><mn>1</mn></mrow></msub></mrow><annotation encoding=\"application/x-tex\">h_{t-1}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.9028em;vertical-align:-0.2083em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">h</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">t</span><span class=\"mbin mtight\">âˆ’</span><span class=\"mord mtight\">1</span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2083em;\"><span></span></span></span></span></span></span></span></span></span>è½¬æ¢ä¸ºå½“å‰æ—¶é—´æ­¥éšè—çŠ¶æ€çš„ä¸€éƒ¨åˆ†ã€‚</p>\n</li>\n<li>\n<p><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>W</mi><mrow><mi>h</mi><mi>y</mi></mrow></msub></mrow><annotation encoding=\"application/x-tex\">W_{hy}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.9694em;vertical-align:-0.2861em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">W</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">h</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03588em;\">y</span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span></span></span></span>:éšè—çŠ¶æ€åˆ°è¾“å‡ºçš„æƒé‡çŸ©é˜µï¼Œç”¨äºå°†éšè—çŠ¶æ€<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>h</mi><mi>t</mi></msub></mrow><annotation encoding=\"application/x-tex\">h_t</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8444em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">h</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2806em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">t</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>è½¬æ¢ä¸ºè¾“å‡º<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>y</mi><mi>t</mi></msub></mrow><annotation encoding=\"application/x-tex\">y_t</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2806em;\"><span style=\"top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">t</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>ã€‚</p>\n</li>\n<li>\n<p>f:æ¿€æ´»å‡½æ•°(å¦‚ Tanh æˆ– ReLU)</p>\n</li>\n<li>\n<p>éšè—çŠ¶æ€ (ht,ht-1,....): å®ƒåœ¨æ¯ä¸ªæ—¶é—´æ­¥å­˜å‚¨æœ‰å…³åºåˆ—çš„ä¿¡æ¯ã€‚<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>h</mi><mi>t</mi></msub></mrow><annotation encoding=\"application/x-tex\">h_t</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8444em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">h</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2806em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">t</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>æ˜¯å½“å‰æ—¶é—´æ­¥çš„éšè—çŠ¶æ€ï¼Œ<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>h</mi><mrow><mi>t</mi><mo>âˆ’</mo><mn>1</mn></mrow></msub></mrow><annotation encoding=\"application/x-tex\">h_{t-1}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.9028em;vertical-align:-0.2083em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">h</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">t</span><span class=\"mbin mtight\">âˆ’</span><span class=\"mord mtight\">1</span></span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2083em;\"><span></span></span></span></span></span></span></span></span></span>æ˜¯å‰ä¸€ä¸ªæ—¶é—´æ­¥çš„éšè—çŠ¶æ€ã€‚</p>\n</li>\n</ul>\n<h3 id=\"62rnnå®é™…å®ç°\"><a class=\"anchor\" href=\"#62rnnå®é™…å®ç°\">#</a> 6.2RNNå®é™…å®ç°</h3>\n<p>åœ¨pytorchå†…æœ‰å‡ ç§RNNæ¨¡å—</p>\n<ol>\n<li>torch.nn.RNNï¼šåŸºæœ¬çš„RNNå•å…ƒ</li>\n<li>torch.nn.LSTMï¼šé•¿çŸ­æœŸè®°å¿†å•å…ƒï¼Œèƒ½å¤Ÿå­¦ä¹ é•¿æœŸä¾èµ–å…³ç³»</li>\n<li>torch.nn.GRUï¼šé—¨æ§å¾ªç¯å•å…ƒï¼Œæ˜¯LSTMçš„ç®€åŒ–ç‰ˆæœ¬ï¼Œä½†é€šå¸¸æ›´å®¹æ˜“è®­ç»ƒ</li>\n</ol>\n<p>å¦‚ä¸‹æ˜¯ä¸€ä¸ªç®€å•çš„RNNæ¨¡å‹</p>\n<pre class=\"shiki shiki-themes vitesse-light vitesse-dark\" style=\"background-color:#ffffff;--shiki-dark-bg:#121212;color:#393a34;--shiki-dark:#dbd7caee\" tabindex=\"0\"><code class=\"language-bash\"><span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">class</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> SimpleRNN</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#59873A;--shiki-dark:#80A665\">nn.Module</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">:</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">    def</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> __init__</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#59873A;--shiki-dark:#80A665\">self,</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> input_size,</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> hidden_size,</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> output_size</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">:</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">        super</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#59873A;--shiki-dark:#80A665\">SimpleRNN,</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> self</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span><span style=\"color:#59873A;--shiki-dark:#80A665\">.__init__</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span></span>\n<span class=\"line\"><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\">        # å®šä¹‰ RNN å±‚</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">        self.rnn</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> =</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> nn.RNN</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#59873A;--shiki-dark:#80A665\">input_size,</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> hidden_size,</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> batch_first=True</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span></span>\n<span class=\"line\"><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\">        # å®šä¹‰å…¨è¿æ¥å±‚</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">        self.fc</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> =</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> nn.Linear</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#59873A;--shiki-dark:#80A665\">hidden_size,</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> output_size</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">    def</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> forward</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#59873A;--shiki-dark:#80A665\">self,</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> x</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">:</span></span>\n<span class=\"line\"><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\">        # x: (batch_size, seq_len, input_size)</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">        out,</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> _</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> =</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> self.rnn</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#59873A;--shiki-dark:#80A665\">x</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\">  # out: (batch_size, seq_len, hidden_size)</span></span>\n<span class=\"line\"><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\">        # å–åºåˆ—æœ€åä¸€ä¸ªæ—¶é—´æ­¥çš„è¾“å‡ºä½œä¸ºæ¨¡å‹çš„è¾“å‡º</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">        out</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> =</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> out[:,</span><span style=\"color:#A65E2B;--shiki-dark:#C99076\"> -1,</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> :]</span><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\">  # (batch_size, hidden_size)</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">        out</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> =</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> self.fc</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#59873A;--shiki-dark:#80A665\">out</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\">  # å…¨è¿æ¥å±‚</span></span>\n<span class=\"line\"><span style=\"color:#1E754F;--shiki-dark:#4D9375\">        return</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> out</span></span></code></pre>\n<p>å…¶ä¸­</p>\n<table>\n<thead>\n<tr>\n<th>ç»´åº¦å</th>\n<th>å«ä¹‰</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td><code>batch_size</code></td>\n<td>ä¸€æ¬¡å–‚ç»™æ¨¡å‹çš„æœ¬ä¸ªæ•°ï¼ˆç”¨äºåŠ é€Ÿè®­ç»ƒï¼‰</td>\n</tr>\n<tr>\n<td><code>seq_len</code></td>\n<td>æ¯ä¸ªæ ·æœ¬æœ‰å¤šå°‘ä¸ªæ—¶é—´æ­¥ï¼ˆå³åºåˆ—é•¿åº¦ï¼‰</td>\n</tr>\n<tr>\n<td><code>input_size</code></td>\n<td>æ¯ä¸ªæ—¶é—´æ­¥è¾“å…¥çš„ç‰¹å¾ç»´åº¦ï¼ˆå¦‚è¯å‘é‡ç»´åº¦ï¼‰</td>\n</tr>\n</tbody>\n</table>\n<hr>\n<h2 id=\"ä¸ƒ-transformeræ¶æ„\"><a class=\"anchor\" href=\"#ä¸ƒ-transformeræ¶æ„\">#</a> ä¸ƒã€ Transformeræ¶æ„</h2>\n<h3 id=\"71-ä»€ä¹ˆæ˜¯transformeræ¶æ„\"><a class=\"anchor\" href=\"#71-ä»€ä¹ˆæ˜¯transformeræ¶æ„\">#</a> 7.1 ä»€ä¹ˆæ˜¯transformeræ¶æ„</h3>\n<p>å¦‚ä¸‹æ˜¯ä¸€å¼ è®ºæ–‡ä¸­çš„è§£é‡Štransformerçš„å›¾</p>\n<p><img loading=\"lazy\" src=\"/images/pytorch/transformer.jpg\" alt=\"\"></p>\n<p>transformeræ¶æ„å°±æ˜¯åˆ©ç”¨æ³¨æ„åŠ›æœºåˆ¶æ¥è·å–åºåˆ—ä¹‹é—´è”ç³»çš„ç¥ç»ç½‘ç»œæ¨¡å‹</p>\n<h3 id=\"72-æ³¨æ„åŠ›æœºåˆ¶\"><a class=\"anchor\" href=\"#72-æ³¨æ„åŠ›æœºåˆ¶\">#</a> 7.2 æ³¨æ„åŠ›æœºåˆ¶</h3>\n<p>å¯ä»¥ç†è§£ä¸ºattentionæœºåˆ¶å®è´¨ä¸Šå°±æ˜¯æƒé‡çš„é—®é¢˜</p>\n<p><img loading=\"lazy\" src=\"/images/pytorch/attention.png\" alt=\"attention\"></p>\n<p><img loading=\"lazy\" src=\"/images/pytorch/self-attention.png\" alt=\"self-attention\"></p>\n<h3 id=\"73-transformeræ¶æ„çš„å®ç°æœºç†\"><a class=\"anchor\" href=\"#73-transformeræ¶æ„çš„å®ç°æœºç†\">#</a> 7.3 transformeræ¶æ„çš„å®ç°æœºç†</h3>\n<p><img loading=\"lazy\" src=\"/images/pytorch/transformer1.png\" alt=\"\"></p>\n<p><img loading=\"lazy\" src=\"/images/pytorch/transformer2.png\" alt=\"\"></p>\n<ul>\n<li>\n<p>Position Encoding:ç»™æ¯ä¸ªè¯ä¸€ä¸ªä½ç½®ç¼–ç ï¼Œè¡¨ç¤ºè¯¥è¯åœ¨å¥å­ä¸­çš„ä½ç½®ä¿¡æ¯</p>\n</li>\n<li>\n<p>Multi-Head Attension:å¯¹ä¸åŒæ¨¡å—é—´äº§ç”Ÿçš„æ³¨æ„åŠ›æœºåˆ¶</p>\n</li>\n</ul>\n<hr>\n<h2 id=\"å…«-torchå†…å¸¸è§å‡½æ•°\"><a class=\"anchor\" href=\"#å…«-torchå†…å¸¸è§å‡½æ•°\">#</a> å…«ã€torchå†…å¸¸è§å‡½æ•°</h2>\n<p>å¼ é‡ç±»å‹æ£€æŸ¥å’Œé…ç½®ï¼š</p>\n<table>\n<thead>\n<tr>\n<th>å‡½æ•°</th>\n<th>æè¿°</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td><code>torch.is_tensor(obj)</code></td>\n<td>æ£€æŸ¥æ˜¯å¦ä¸ºå¼ é‡</td>\n</tr>\n<tr>\n<td><code>torch.is_storage(obj)</code></td>\n<td>æ£€æŸ¥æ˜¯å¦ä¸ºå­˜å‚¨å¯¹è±¡</td>\n</tr>\n<tr>\n<td><code>torch.is_complex(input)</code></td>\n<td>æ˜¯å¦ä¸ºå¤æ•°ç±»å‹</td>\n</tr>\n<tr>\n<td><code>torch.is_conj(input)</code></td>\n<td>æ˜¯å¦ä¸ºå…±è½­å¼ é‡</td>\n</tr>\n<tr>\n<td><code>torch.is_floating_point(input)</code></td>\n<td>æ˜¯å¦ä¸ºæµ®ç‚¹ç±»å‹</td>\n</tr>\n<tr>\n<td><code>torch.is_nonzero(input)</code></td>\n<td>æ˜¯å¦ä¸ºéé›¶å•å…ƒç´ å¼ é‡</td>\n</tr>\n<tr>\n<td><code>torch.set_default_dtype(d)</code></td>\n<td>è®¾ç½®é»˜è®¤æµ®ç‚¹æ•°æ®ç±»å‹</td>\n</tr>\n<tr>\n<td><code>torch.get_default_dtype()</code></td>\n<td>è·å–å½“å‰é»˜è®¤æµ®ç‚¹æ•°æ®ç±»å‹</td>\n</tr>\n<tr>\n<td><code>torch.set_default_device(device)</code></td>\n<td>è®¾ç½®é»˜è®¤å¼ é‡è®¾å¤‡</td>\n</tr>\n<tr>\n<td><code>torch.get_default_device()</code></td>\n<td>è·å–é»˜è®¤å¼ é‡è®¾å¤‡</td>\n</tr>\n<tr>\n<td><code>torch.numel(input)</code></td>\n<td>è·å–å…ƒç´ æ€»æ•°</td>\n</tr>\n</tbody>\n</table>\n<p>Tensor åˆ›å»ºï¼š</p>\n<table>\n<thead>\n<tr>\n<th>å‡½æ•°</th>\n<th>æè¿°</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td><code>torch.tensor(data)</code></td>\n<td>ä»æ•°æ®åˆ›å»ºå¼ é‡</td>\n</tr>\n<tr>\n<td><code>torch.as_tensor(data)</code></td>\n<td>è½¬æ¢ä¸ºå¼ é‡ï¼Œå…±äº«æ•°æ®</td>\n</tr>\n<tr>\n<td><code>torch.from_numpy(ndarray)</code></td>\n<td>ä» NumPy åˆ›å»ºå¼ é‡ï¼Œå…±äº«æ•°æ®</td>\n</tr>\n<tr>\n<td><code>torch.zeros(size)</code></td>\n<td>åˆ›å»ºå…¨é›¶å¼ é‡</td>\n</tr>\n<tr>\n<td><code>torch.ones(size)</code></td>\n<td>åˆ›å»ºå…¨ä¸€å¼ é‡</td>\n</tr>\n<tr>\n<td><code>torch.empty(size)</code></td>\n<td>åˆ›å»ºæœªåˆå§‹åŒ–å¼ é‡</td>\n</tr>\n<tr>\n<td><code>torch.arange(start, end, step)</code></td>\n<td>åˆ›å»ºç­‰å·®åºåˆ—å¼ é‡</td>\n</tr>\n<tr>\n<td><code>torch.linspace(start, end, steps)</code></td>\n<td>åˆ›å»ºçº¿æ€§é—´éš”å¼ é‡</td>\n</tr>\n<tr>\n<td><code>torch.logspace(start, end, steps, base)</code></td>\n<td>åˆ›å»ºå¯¹æ•°é—´éš”å¼ é‡</td>\n</tr>\n<tr>\n<td><code>torch.eye(n, m)</code></td>\n<td>åˆ›å»ºå•ä½çŸ©é˜µ</td>\n</tr>\n<tr>\n<td><code>torch.full(size, fill_value)</code></td>\n<td>åˆ›å»ºå¡«å……æŒ‡å®šå€¼çš„å¼ é‡</td>\n</tr>\n<tr>\n<td><code>torch.rand(size)</code></td>\n<td>å‡åŒ€åˆ†å¸ƒéšæœºå¼ é‡</td>\n</tr>\n<tr>\n<td><code>torch.randn(size)</code></td>\n<td>æ ‡å‡†æ­£æ€åˆ†å¸ƒå¼ é‡</td>\n</tr>\n<tr>\n<td><code>torch.randint(low, high, size)</code></td>\n<td>æ•´æ•°éšæœºå¼ é‡</td>\n</tr>\n<tr>\n<td><code>torch.randperm(n)</code></td>\n<td>0 åˆ° n-1 çš„éšæœºæ’åˆ—</td>\n</tr>\n</tbody>\n</table>\n<p>Tensor æ“ä½œï¼š</p>\n<table>\n<thead>\n<tr>\n<th>å‡½æ•°</th>\n<th>æè¿°</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td><code>torch.cat(tensors, dim)</code></td>\n<td>æ²¿æŒ‡å®šç»´åº¦æ‹¼æ¥å¼ é‡</td>\n</tr>\n<tr>\n<td><code>torch.stack(tensors, dim)</code></td>\n<td>æ²¿æ–°ç»´åº¦å †å å¼ é‡</td>\n</tr>\n<tr>\n<td><code>torch.split(tensor, split_size, dim)</code></td>\n<td>æŒ‰å¤§å°åˆ†å‰²å¼ é‡</td>\n</tr>\n<tr>\n<td><code>torch.chunk(tensor, chunks, dim)</code></td>\n<td>æŒ‰å—åˆ†å‰²å¼ é‡</td>\n</tr>\n<tr>\n<td><code>torch.reshape(input, shape)</code></td>\n<td>æ”¹å˜å½¢çŠ¶</td>\n</tr>\n<tr>\n<td><code>torch.transpose(input, dim0, dim1)</code></td>\n<td>è½¬ç½®ä¸¤ä¸ªç»´åº¦</td>\n</tr>\n<tr>\n<td><code>torch.squeeze(input, dim)</code></td>\n<td>å»é™¤ 1 ç»´åº¦</td>\n</tr>\n<tr>\n<td><code>torch.unsqueeze(input, dim)</code></td>\n<td>æ·»åŠ  1 ç»´åº¦</td>\n</tr>\n<tr>\n<td><code>torch.expand(input, size)</code></td>\n<td>æ‰©å±•ç»´åº¦</td>\n</tr>\n<tr>\n<td><code>torch.narrow(input, dim, start, length)</code></td>\n<td>å¼ é‡åˆ‡ç‰‡</td>\n</tr>\n<tr>\n<td><code>torch.permute(input, dims)</code></td>\n<td>ç»´åº¦é‡æ’</td>\n</tr>\n<tr>\n<td><code>torch.masked_select(input, mask)</code></td>\n<td>å¸ƒå°”æ©ç é€‰æ‹©</td>\n</tr>\n<tr>\n<td><code>torch.index_select(input, dim, index)</code></td>\n<td>ç´¢å¼•é€‰æ‹©å…ƒç´ </td>\n</tr>\n<tr>\n<td><code>torch.gather(input, dim, index)</code></td>\n<td>æŒ‰ç´¢å¼•æ”¶é›†æ•°æ®</td>\n</tr>\n<tr>\n<td><code>torch.scatter(input, dim, index, src)</code></td>\n<td>æŒ‰ç´¢å¼•å†™å…¥æ•°æ®</td>\n</tr>\n<tr>\n<td><code>torch.nonzero(input)</code></td>\n<td>è·å–éé›¶ç´¢å¼•</td>\n</tr>\n</tbody>\n</table>\n<p>æ•°å­¦è¿ç®—ï¼š</p>\n<table>\n<thead>\n<tr>\n<th>å‡½æ•°</th>\n<th>æè¿°</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td><code>torch.add(input, other)</code></td>\n<td>åŠ æ³•</td>\n</tr>\n<tr>\n<td><code>torch.sub(input, other)</code></td>\n<td>å‡æ³•</td>\n</tr>\n<tr>\n<td><code>torch.mul(input, other)</code></td>\n<td>ä¹˜æ³•</td>\n</tr>\n<tr>\n<td><code>torch.div(input, other)</code></td>\n<td>é™¤æ³•</td>\n</tr>\n<tr>\n<td><code>torch.pow(input, exponent)</code></td>\n<td>å¹‚è¿ç®—</td>\n</tr>\n<tr>\n<td><code>torch.sqrt(input)</code></td>\n<td>å¹³æ–¹æ ¹</td>\n</tr>\n<tr>\n<td><code>torch.exp(input)</code></td>\n<td>æŒ‡æ•°å‡½æ•°</td>\n</tr>\n<tr>\n<td><code>torch.log(input)</code></td>\n<td>è‡ªç„¶å¯¹æ•°</td>\n</tr>\n<tr>\n<td><code>torch.sum(input, dim)</code></td>\n<td>æ±‚å’Œ</td>\n</tr>\n<tr>\n<td><code>torch.mean(input, dim)</code></td>\n<td>æ±‚å‡å€¼</td>\n</tr>\n<tr>\n<td><code>torch.max(input, dim)</code></td>\n<td>æœ€å¤§å€¼</td>\n</tr>\n<tr>\n<td><code>torch.min(input, dim)</code></td>\n<td>æœ€å°å€¼</td>\n</tr>\n<tr>\n<td><code>torch.abs(input)</code></td>\n<td>ç»å¯¹å€¼</td>\n</tr>\n<tr>\n<td><code>torch.clamp(input, min, max)</code></td>\n<td>é™åˆ¶èŒƒå›´</td>\n</tr>\n<tr>\n<td><code>torch.round(input)</code></td>\n<td>å››èˆäº”å…¥</td>\n</tr>\n<tr>\n<td><code>torch.floor(input)</code></td>\n<td>å‘ä¸‹å–æ•´</td>\n</tr>\n<tr>\n<td><code>torch.ceil(input)</code></td>\n<td>å‘ä¸Šå–æ•´</td>\n</tr>\n</tbody>\n</table>\n<p>éšæœºæ•°ç”Ÿæˆï¼š</p>\n<table>\n<thead>\n<tr>\n<th>å‡½æ•°</th>\n<th>æè¿°</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td><code>torch.manual_seed(seed)</code></td>\n<td>è®¾ç½®éšæœºç§å­</td>\n</tr>\n<tr>\n<td><code>torch.initial_seed()</code></td>\n<td>è·å–å½“å‰ç§å­</td>\n</tr>\n<tr>\n<td><code>torch.rand(size)</code></td>\n<td>å‡åŒ€åˆ†å¸ƒå¼ é‡</td>\n</tr>\n<tr>\n<td><code>torch.randn(size)</code></td>\n<td>æ­£æ€åˆ†å¸ƒå¼ é‡</td>\n</tr>\n<tr>\n<td><code>torch.randint(low, high, size)</code></td>\n<td>æ•´æ•°éšæœºå¼ é‡</td>\n</tr>\n<tr>\n<td><code>torch.randperm(n)</code></td>\n<td>éšæœºæ’åˆ—åºåˆ—</td>\n</tr>\n</tbody>\n</table>\n<p>çº¿æ€§ä»£æ•°ï¼š</p>\n<table>\n<thead>\n<tr>\n<th>å‡½æ•°</th>\n<th>æè¿°</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td><code>torch.dot(input, other)</code></td>\n<td>å‘é‡ç‚¹ç§¯</td>\n</tr>\n<tr>\n<td><code>torch.mm(input, mat2)</code></td>\n<td>çŸ©é˜µä¹˜æ³•</td>\n</tr>\n<tr>\n<td><code>torch.bmm(input, mat2)</code></td>\n<td>æ‰¹é‡çŸ©é˜µä¹˜æ³•</td>\n</tr>\n<tr>\n<td><code>torch.eig(input)</code></td>\n<td>ç‰¹å¾å€¼å’Œç‰¹å¾å‘é‡</td>\n</tr>\n<tr>\n<td><code>torch.svd(input)</code></td>\n<td>å¥‡å¼‚å€¼åˆ†è§£</td>\n</tr>\n<tr>\n<td><code>torch.inverse(input)</code></td>\n<td>çŸ©é˜µé€†</td>\n</tr>\n<tr>\n<td><code>torch.det(input)</code></td>\n<td>è¡Œåˆ—å¼</td>\n</tr>\n<tr>\n<td><code>torch.trace(input)</code></td>\n<td>çŸ©é˜µè¿¹</td>\n</tr>\n</tbody>\n</table>\n<p>è®¾å¤‡ç®¡ç†ï¼š</p>\n<table>\n<thead>\n<tr>\n<th>å‡½æ•°</th>\n<th>æè¿°</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td><code>torch.cuda.is_available()</code></td>\n<td>æ˜¯å¦æ”¯æŒ CUDA</td>\n</tr>\n<tr>\n<td><code>torch.device(device)</code></td>\n<td>åˆ›å»ºè®¾å¤‡å¯¹è±¡</td>\n</tr>\n<tr>\n<td><code>tensor.to(device)</code></td>\n<td>å¼ é‡è¿ç§»è®¾å¤‡</td>\n</tr>\n</tbody>\n</table>\n<hr>\n<h2 id=\"ç•ªå¤–ä¸€-pyplot\"><a class=\"anchor\" href=\"#ç•ªå¤–ä¸€-pyplot\">#</a> ç•ªå¤–ä¸€ã€pyplot</h2>\n<h3 id=\"1åŸºæœ¬ç»˜å›¾æµç¨‹\"><a class=\"anchor\" href=\"#1åŸºæœ¬ç»˜å›¾æµç¨‹\">#</a> 1.åŸºæœ¬ç»˜å›¾æµç¨‹</h3>\n<pre class=\"shiki shiki-themes vitesse-light vitesse-dark\" style=\"background-color:#ffffff;--shiki-dark-bg:#121212;color:#393a34;--shiki-dark:#dbd7caee\" tabindex=\"0\"><code class=\"language-bash\"><span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">import</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> matplotlib.pyplot</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> as</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> plt</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\"># 1. å‡†å¤‡æ•°æ®</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">x</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> =</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\"> </span><span style=\"color:rgba(255, 18, 18, 0.8);--shiki-dark:rgba(255, 18, 18, 0.8)\">[</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">1, </span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">2,</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> 3,</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> 4,</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> 5]</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">y</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> =</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\"> </span><span style=\"color:rgba(255, 18, 18, 0.8);--shiki-dark:rgba(255, 18, 18, 0.8)\">[</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">1, </span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">4,</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> 9,</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> 16,</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> 25]</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\"># 2. ç»˜å›¾</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">plt.plot</span><span style=\"color:#a65e2b;--shiki-dark:#d4976c\">(</span><span style=\"color:#59873A;--shiki-dark:#80A665\">x,</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> y</span><span style=\"color:#a65e2b;--shiki-dark:#d4976c\">)</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\"># 3. æ·»åŠ æ ‡é¢˜å’Œæ ‡ç­¾</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">plt.title</span><span style=\"color:#a65e2b;--shiki-dark:#d4976c\">(</span><span style=\"color:#59873A;--shiki-dark:#80A665\">\"æŠ˜çº¿å›¾ç¤ºä¾‹\"</span><span style=\"color:#a65e2b;--shiki-dark:#d4976c\">)</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">plt.xlabel</span><span style=\"color:#a65e2b;--shiki-dark:#d4976c\">(</span><span style=\"color:#59873A;--shiki-dark:#80A665\">\"Xè½´\"</span><span style=\"color:#a65e2b;--shiki-dark:#d4976c\">)</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">plt.ylabel</span><span style=\"color:#a65e2b;--shiki-dark:#d4976c\">(</span><span style=\"color:#59873A;--shiki-dark:#80A665\">\"Yè½´\"</span><span style=\"color:#a65e2b;--shiki-dark:#d4976c\">)</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\"># 4. æ˜¾ç¤ºå›¾åƒ</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">plt.show</span><span style=\"color:#a65e2b;--shiki-dark:#d4976c\">(</span><span style=\"color:#a65e2b;--shiki-dark:#d4976c\">)</span></span>\n<span class=\"line\"></span></code></pre>\n<ol>\n<li>å‡†å¤‡å¥½yå…³äºxå‡½æ•°å…³ç³»çš„æ•°æ®</li>\n<li>åˆ©ç”¨plotå‡½æ•°è¿›è¡Œå›¾åƒç»˜åˆ¶ï¼Œå¹¶å¯¹ç›¸å…³å±æ€§è¿›è¡Œå®šä¹‰</li>\n<li>å¯¹è½´è¿›è¡Œå¤„ç†</li>\n</ol>\n<p>ç›¸å…³å‚æ•°exï¼š</p>\n<p><img loading=\"lazy\" src=\"/images/pytorch/pyplot-fmt.png\" alt=\"fmt\"></p>\n<table>\n<thead>\n<tr>\n<th><code>marker</code> å€¼</th>\n<th>å«ä¹‰</th>\n<th>æ˜¾ç¤ºæ•ˆæœ</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td><code>'o'</code></td>\n<td>åœ†åœˆ</td>\n<td>â—</td>\n</tr>\n<tr>\n<td><code>'s'</code></td>\n<td>æ–¹å½¢</td>\n<td>â– </td>\n</tr>\n<tr>\n<td><code>'^'</code></td>\n<td>ä¸Šä¸‰è§’</td>\n<td>â–²</td>\n</tr>\n<tr>\n<td><code>'v'</code></td>\n<td>ä¸‹ä¸‰è§’</td>\n<td>â–¼</td>\n</tr>\n<tr>\n<td><code>'&gt;'</code></td>\n<td>å³ä¸‰è§’</td>\n<td>â–¶</td>\n</tr>\n<tr>\n<td><code>'&lt;'</code></td>\n<td>å·¦ä¸‰è§’</td>\n<td>â—€</td>\n</tr>\n<tr>\n<td><code>'x'</code></td>\n<td>åå­—å‰</td>\n<td>âœ•</td>\n</tr>\n<tr>\n<td><code>'+'</code></td>\n<td>åŠ å·</td>\n<td>ï¼‹</td>\n</tr>\n<tr>\n<td><code>'*'</code></td>\n<td>æ˜Ÿå·</td>\n<td>â˜…</td>\n</tr>\n<tr>\n<td><code>'.'</code></td>\n<td>ç‚¹</td>\n<td>Â·</td>\n</tr>\n<tr>\n<td><code>'D'</code></td>\n<td>è±å½¢</td>\n<td>â—†</td>\n</tr>\n<tr>\n<td><code>'p'</code></td>\n<td>äº”è¾¹å½¢</td>\n<td>â¬Ÿ</td>\n</tr>\n<tr>\n<td><code>'h'</code></td>\n<td>å…­è¾¹å½¢1</td>\n<td>â¬¢</td>\n</tr>\n<tr>\n<td><code>'H'</code></td>\n<td>å…­è¾¹å½¢2</td>\n<td>â¬£</td>\n</tr>\n<tr>\n<td><code>None</code></td>\n<td>æ— æ ‡è®°</td>\n<td>æ— </td>\n</tr>\n</tbody>\n</table>\n<table>\n<thead>\n<tr>\n<th><code>linestyle</code> å€¼</th>\n<th>å«ä¹‰</th>\n<th>ç¤ºä¾‹æ ·å¼</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td><code>'-'</code></td>\n<td>å®çº¿</td>\n<td>â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€</td>\n</tr>\n<tr>\n<td><code>'--'</code></td>\n<td>è™šçº¿</td>\n<td>â€“ â€“ â€“ â€“ â€“ â€“ â€“ â€“</td>\n</tr>\n<tr>\n<td><code>'-.'</code></td>\n<td>ç‚¹åˆ’çº¿</td>\n<td>â€“ Â· â€“ Â· â€“ Â· â€“ Â·</td>\n</tr>\n<tr>\n<td><code>':'</code></td>\n<td>ç‚¹çº¿</td>\n<td>Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·</td>\n</tr>\n<tr>\n<td><code>''</code> or <code>None</code></td>\n<td>æ— çº¿æ¡</td>\n<td>æ— </td>\n</tr>\n</tbody>\n</table>\n<h3 id=\"2ç½‘æ ¼çº¿\"><a class=\"anchor\" href=\"#2ç½‘æ ¼çº¿\">#</a> 2.ç½‘æ ¼çº¿</h3>\n<pre class=\"shiki shiki-themes vitesse-light vitesse-dark\" style=\"background-color:#ffffff;--shiki-dark-bg:#121212;color:#393a34;--shiki-dark:#dbd7caee\" tabindex=\"0\"><code class=\"language-bash\"><span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">import</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> numpy</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> as</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> np</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">import</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> matplotlib.pyplot</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> as</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> plt</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">x</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> =</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> np.array</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">[</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">1, 2, 3, 4</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">]</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">y</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> =</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> np.array</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">[</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">1, 4, 9, 16</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">]</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">plt.title</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#59873A;--shiki-dark:#80A665\">\"RUNOOB grid() Test\"</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">plt.xlabel</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#59873A;--shiki-dark:#80A665\">\"x - label\"</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">plt.ylabel</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#59873A;--shiki-dark:#80A665\">\"y - label\"</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">plt.plot</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#59873A;--shiki-dark:#80A665\">x,</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> y</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">plt.grid</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#59873A;--shiki-dark:#80A665\">color</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> =</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\"> '</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">r</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\">'</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">,</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> linestyle</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> =</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\"> '</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">--</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\">'</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">,</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> linewidth</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> =</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\"> 0.5</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">plt.show</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span></span></code></pre>\n<p><img loading=\"lazy\" src=\"/images/pytorch/ex1.png\" alt=\"ex1\"></p>\n<p>gridå†…è¿˜æœ‰axiså±æ€§ï¼Œè‹¥è®¾ç½®axis=xåˆ™ç½‘æ ¼çº¿å°±åœ¨yæ–¹å‘ä¸Šå‡ºç°</p>\n<h3 id=\"3ç»˜åˆ¶å¤šå›¾\"><a class=\"anchor\" href=\"#3ç»˜åˆ¶å¤šå›¾\">#</a> 3.ç»˜åˆ¶å¤šå›¾</h3>\n<p>åŸºç¡€çš„ç”¨subplotæ–¹æ³•ç»˜å›¾ï¼š</p>\n<pre class=\"shiki shiki-themes vitesse-light vitesse-dark\" style=\"background-color:#ffffff;--shiki-dark-bg:#121212;color:#393a34;--shiki-dark:#dbd7caee\" tabindex=\"0\"><code class=\"language-bash\"><span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">import</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> matplotlib.pyplot</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> as</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> plt</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">import</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> numpy</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> as</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> np</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\">#plot 1:</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">xpoints</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> =</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> np.array</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">[</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">0, 6</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">]</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">ypoints</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> =</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> np.array</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">[</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">0, 100</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">]</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">plt.subplot</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#59873A;--shiki-dark:#80A665\">1,</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> 2,</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\"> 1</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">plt.plot</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#59873A;--shiki-dark:#80A665\">xpoints,ypoints</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">plt.title</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#59873A;--shiki-dark:#80A665\">\"plot 1\"</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\">#plot 2:</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">x</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> =</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> np.array</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">[</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">1, 2, 3, 4</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">]</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">y</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> =</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> np.array</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">[</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">1, 4, 9, 16</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">]</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">plt.subplot</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#59873A;--shiki-dark:#80A665\">1,</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> 2,</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\"> 2</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">plt.plot</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#59873A;--shiki-dark:#80A665\">x,y</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">plt.title</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#59873A;--shiki-dark:#80A665\">\"plot 2\"</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">plt.suptitle</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#59873A;--shiki-dark:#80A665\">\"RUNOOB subplot Test\"</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">plt.show</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span></span></code></pre>\n<p><img loading=\"lazy\" src=\"/images/pytorch/ex2.png\" alt=\"ex2\"></p>\n<p>å…¶ä¸­suplot(a,b,c)è¿™ä¸‰ä¸ªå‚æ•°åˆ†åˆ«è¯´æ˜ï¼Œæœ‰aè¡Œbåˆ—ä¸ªå›¾ï¼Œå½“å‰è¯¥å›¾æ’åœ¨ç¬¬cä½</p>\n<h3 id=\"3æ•£ç‚¹æŸ±å½¢ç›´æ–¹å›¾å’Œé¥¼å›¾s\"><a class=\"anchor\" href=\"#3æ•£ç‚¹æŸ±å½¢ç›´æ–¹å›¾å’Œé¥¼å›¾s\">#</a> 3.æ•£ç‚¹ï¼ŒæŸ±å½¢,ç›´æ–¹å›¾å’Œé¥¼å›¾s</h3>\n<h4 id=\"1æ•£ç‚¹å›¾\"><a class=\"anchor\" href=\"#1æ•£ç‚¹å›¾\">#</a> 1.æ•£ç‚¹å›¾</h4>\n<p>æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ pyplot ä¸­çš„ scatter() æ–¹æ³•æ¥ç»˜åˆ¶æ•£ç‚¹å›¾ã€‚</p>\n<p>åŸºç¡€è°ƒç”¨æ–¹å¼ï¼š</p>\n<pre class=\"shiki shiki-themes vitesse-light vitesse-dark\" style=\"background-color:#ffffff;--shiki-dark-bg:#121212;color:#393a34;--shiki-dark:#dbd7caee\" tabindex=\"0\"><code class=\"language-bash\"><span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">import</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> matplotlib.pyplot</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> as</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> plt</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">import</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> numpy</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> as</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> np</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">x</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> =</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> np.array</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">[</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">1, 2, 3, 4, 5, 6, 7, 8</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">]</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">y</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> =</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> np.array</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">[</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">1, 4, 9, 16, 7, 11, 23, 18</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">]</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">plt.scatter</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#59873A;--shiki-dark:#80A665\">x,</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> y</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">plt.show</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span></span></code></pre>\n<p>scatter() æ–¹æ³•è¯­æ³•æ ¼å¼å¦‚ä¸‹ï¼š</p>\n<pre class=\"shiki shiki-themes vitesse-light vitesse-dark\" style=\"background-color:#ffffff;--shiki-dark-bg:#121212;color:#393a34;--shiki-dark:#dbd7caee\" tabindex=\"0\"><code class=\"language-bash\"><span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">matplotlib.pyplot.scatter</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#59873A;--shiki-dark:#80A665\">x,</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> y,</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> s=None,</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> c=None,</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> marker=None,</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> cmap=None,</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> norm=None,</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> vmin=None,</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> vmax=None,</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> alpha=None,</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> linewidths=None,</span><span style=\"color:#A65E2B;--shiki-dark:#C99076\"> *</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">,</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> edgecolors=None,</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> plotnonfinite=False,</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> data=None,</span><span style=\"color:#A65E2B;--shiki-dark:#C99076\"> **</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">kwargs</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span></span></code></pre>\n<table>\n<thead>\n<tr>\n<th>å‚æ•°å</th>\n<th>ç±»å‹</th>\n<th>ä½œç”¨è¯´æ˜</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td><code>x</code></td>\n<td>array-like</td>\n<td>æ¯ä¸ªç‚¹çš„ x åæ ‡ï¼ˆå¿…é¡»ï¼‰</td>\n</tr>\n<tr>\n<td><code>y</code></td>\n<td>array-like</td>\n<td>æ¯ä¸ªç‚¹çš„ y åæ ‡ï¼ˆå¿…é¡»ï¼‰</td>\n</tr>\n<tr>\n<td><code>s</code></td>\n<td>float æˆ– array</td>\n<td>ç‚¹çš„<strong>å¤§å°</strong>ï¼Œé»˜è®¤ä¸º 20ï¼›å¯è®¾ç½®ä¸ºæ•°ç»„ä½¿æ¯ä¸ªç‚¹å¤§å°ä¸åŒ</td>\n</tr>\n<tr>\n<td><code>c</code></td>\n<td>color æˆ– array</td>\n<td>ç‚¹çš„<strong>é¢œè‰²</strong>ï¼Œå¯ä»¥æ˜¯å­—ç¬¦ä¸²å¦‚ <code>'red'</code>ï¼Œæˆ–æ•°ç»„æ˜ å°„ colormap</td>\n</tr>\n<tr>\n<td><code>marker</code></td>\n<td>str</td>\n<td>ç‚¹çš„<strong>å½¢çŠ¶</strong>ï¼Œå¦‚ <code>'o'</code> åœ†ç‚¹ã€<code>'^'</code> ä¸‰è§’ç­‰</td>\n</tr>\n<tr>\n<td><code>cmap</code></td>\n<td>colormap</td>\n<td>ç”¨äºå°† <code>c</code> æ•°ç»„æ˜ å°„ä¸ºé¢œè‰²çš„<strong>é¢œè‰²æ˜ å°„è¡¨</strong>ï¼ˆå¦‚ <code>plt.cm.Blues</code>ï¼‰</td>\n</tr>\n<tr>\n<td><code>norm</code></td>\n<td>Normalize å®ä¾‹</td>\n<td>è‡ªå®šä¹‰é¢œè‰²å½’ä¸€åŒ–æ–¹å¼ï¼Œé…åˆ <code>cmap</code> ä½¿ç”¨</td>\n</tr>\n<tr>\n<td><code>vmin</code></td>\n<td>float</td>\n<td><code>cmap</code> çš„æœ€å°å€¼ï¼ˆå¯æ§åˆ¶é¢œè‰²èŒƒå›´ï¼‰</td>\n</tr>\n<tr>\n<td><code>vmax</code></td>\n<td>float</td>\n<td><code>cmap</code> çš„æœ€å¤§å€¼ï¼ˆåŒä¸Šï¼‰</td>\n</tr>\n<tr>\n<td><code>alpha</code></td>\n<td>float [0, 1]</td>\n<td>ç‚¹çš„<strong>é€æ˜åº¦</strong>ï¼Œ1ä¸ºä¸é€æ˜ï¼Œ0ä¸ºå®Œå…¨é€æ˜</td>\n</tr>\n<tr>\n<td><code>linewidths</code></td>\n<td>float æˆ– array</td>\n<td>ç‚¹çš„è¾¹æ¡†çº¿å®½</td>\n</tr>\n<tr>\n<td><code>edgecolors</code></td>\n<td face,=\"\" none=\"\">color or</td>\n<td>ç‚¹çš„è¾¹æ¡†é¢œè‰²ï¼Œå¯è®¾ä¸º <code>'face'</code>ï¼ˆå’Œç‚¹ä¸€æ ·ï¼‰æˆ– <code>'none'</code>ï¼ˆæ— è¾¹æ¡†ï¼‰</td>\n</tr>\n<tr>\n<td><code>plotnonfinite</code></td>\n<td>bool</td>\n<td>æ˜¯å¦ç»˜åˆ¶ NaN æˆ– Inf å€¼ï¼Œé»˜è®¤ False</td>\n</tr>\n<tr>\n<td><code>data</code></td>\n<td>dict æˆ– DataFrame</td>\n<td>æ”¯æŒä½¿ç”¨ <code>data[\"x\"]</code> æ–¹å¼ä¼ å‚</td>\n</tr>\n<tr>\n<td><code>**kwargs</code></td>\n<td></td>\n<td>ä¼ é€’ç»™åº•å±‚ <code>PathCollection</code> çš„å…¶ä»–å‚æ•°</td>\n</tr>\n</tbody>\n</table>\n<h4 id=\"2æŸ±å½¢å›¾\"><a class=\"anchor\" href=\"#2æŸ±å½¢å›¾\">#</a> 2.æŸ±å½¢å›¾</h4>\n<p>åŸºç¡€ç»˜åˆ¶æ–¹å¼ï¼š</p>\n<pre class=\"shiki shiki-themes vitesse-light vitesse-dark\" style=\"background-color:#ffffff;--shiki-dark-bg:#121212;color:#393a34;--shiki-dark:#dbd7caee\" tabindex=\"0\"><code class=\"language-bash\"><span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">import</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> matplotlib.pyplot</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> as</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> plt</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">import</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> numpy</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> as</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> np</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">x</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> =</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> np.array</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">[</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">Runoob-1</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">, </span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">Runoob-2</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">, </span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">Runoob-3</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">, </span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">C-RUNOOB</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">]</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">y</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> =</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> np.array</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">[</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">12, 22, 6, 18</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">]</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">plt.bar</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#59873A;--shiki-dark:#80A665\">x,y</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">plt.show</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span></span></code></pre>\n<table>\n<thead>\n<tr>\n<th>å‚æ•°å</th>\n<th>ç±»å‹</th>\n<th>è¯´æ˜</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td><code>x</code></td>\n<td>array-like</td>\n<td>æ¯ä¸ªæ¡å½¢çš„ x åæ ‡ï¼ˆåˆ†ç±»å˜é‡ç´¢å¼•æˆ–æ ‡ç­¾ï¼‰</td>\n</tr>\n<tr>\n<td><code>height</code></td>\n<td>array-like</td>\n<td>æ¯ä¸ªæ¡å½¢çš„é«˜åº¦</td>\n</tr>\n<tr>\n<td><code>width</code></td>\n<td>float æˆ– array</td>\n<td>æ¯ä¸ªæ¡å½¢çš„å®½åº¦ï¼ˆé»˜è®¤ <code>0.8</code>ï¼‰</td>\n</tr>\n<tr>\n<td><code>bottom</code></td>\n<td>float æˆ– array</td>\n<td>æ¯ä¸ªæ¡å½¢çš„åº•éƒ¨èµ·å§‹ä½ç½®ï¼ˆé»˜è®¤æ˜¯ <code>0</code>ï¼Œç”¨äºå †å ï¼‰</td>\n</tr>\n<tr>\n<td><code>align</code></td>\n<td><code>'center'</code> or <code>'edge'</code></td>\n<td>æ¡å½¢å¯¹é½æ–¹å¼ï¼Œé»˜è®¤ä¸º <code>'center'</code></td>\n</tr>\n<tr>\n<td><code>color</code></td>\n<td>é¢œè‰² æˆ–æ•°ç»„</td>\n<td>æ¡å½¢é¢œè‰²ï¼ˆå¯ä¸ºå­—ç¬¦ä¸²æˆ– RGB å€¼ï¼‰</td>\n</tr>\n<tr>\n<td><code>edgecolor</code></td>\n<td>é¢œè‰²æˆ–æ•°ç»„</td>\n<td>æ¡å½¢è¾¹æ¡†é¢œè‰²</td>\n</tr>\n<tr>\n<td><code>linewidth</code></td>\n<td>float</td>\n<td>æ¡å½¢è¾¹æ¡†å®½åº¦</td>\n</tr>\n<tr>\n<td><code>tick_label</code></td>\n<td>list</td>\n<td>è®¾ç½® x è½´åˆ»åº¦æ ‡ç­¾ï¼ˆå¦‚åˆ†ç±»åç§°ï¼‰</td>\n</tr>\n<tr>\n<td><code>xerr</code>, <code>yerr</code></td>\n<td>æ•°ç»„æˆ–æ ‡é‡</td>\n<td>è®¾ç½® x/y æ–¹å‘çš„è¯¯å·®æ¡ï¼ˆç”¨äºè¯¯å·®å¯è§†åŒ–ï¼‰</td>\n</tr>\n<tr>\n<td><code>ecolor</code></td>\n<td>é¢œè‰²</td>\n<td>è¯¯å·®æ¡çš„é¢œè‰²</td>\n</tr>\n<tr>\n<td><code>capsize</code></td>\n<td>float</td>\n<td>è¯¯å·®æ¡æœ«ç«¯æ¨ªçº¿çš„é•¿åº¦</td>\n</tr>\n<tr>\n<td><code>label</code></td>\n<td>str</td>\n<td>è®¾ç½®ç”¨äºå›¾ä¾‹çš„æ ‡ç­¾å</td>\n</tr>\n<tr>\n<td><code>alpha</code></td>\n<td>float</td>\n<td>è®¾ç½®é€æ˜åº¦ï¼ˆ0~1ï¼‰</td>\n</tr>\n</tbody>\n</table>\n<h4 id=\"3é¥¼å›¾\"><a class=\"anchor\" href=\"#3é¥¼å›¾\">#</a> 3.é¥¼å›¾</h4>\n<p>åŸºç¡€ç»˜åˆ¶æ–¹å¼</p>\n<pre class=\"shiki shiki-themes vitesse-light vitesse-dark\" style=\"background-color:#ffffff;--shiki-dark-bg:#121212;color:#393a34;--shiki-dark:#dbd7caee\" tabindex=\"0\"><code class=\"language-bash\"><span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">import</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> matplotlib.pyplot</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> as</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> plt</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">import</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> numpy</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> as</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> np</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">y</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> =</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> np.array</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">[</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">35, 25, 25, 15</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">]</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">plt.pie</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#59873A;--shiki-dark:#80A665\">y</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">plt.show</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span></span></code></pre>\n<table>\n<thead>\n<tr>\n<th>å‚æ•°å</th>\n<th>ç±»å‹</th>\n<th>è¯´æ˜</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td><code>x</code></td>\n<td>list æˆ– array</td>\n<td>å„ä¸ªæ‰‡åŒºçš„æ•°å€¼ï¼ˆè‡ªåŠ¨å½’ä¸€åŒ–ä¸ºæ¯”ä¾‹ï¼‰</td>\n</tr>\n<tr>\n<td><code>labels</code></td>\n<td>list[str]</td>\n<td>æ¯ä¸ªæ‰‡åŒºçš„æ ‡ç­¾ï¼ˆæ˜¾ç¤ºåœ¨å›¾ä¸Šï¼‰</td>\n</tr>\n<tr>\n<td><code>explode</code></td>\n<td>list[float]</td>\n<td>æ§åˆ¶æ¯ä¸ªæ‰‡åŒºâ€œå¼¹å‡ºâ€çš„è·ç¦»ï¼ˆä¾‹å¦‚ <code>[0, 0.1, 0, 0.2]</code>ï¼‰</td>\n</tr>\n<tr>\n<td><code>colors</code></td>\n<td>list[str]</td>\n<td>æ‰‡åŒºçš„é¢œè‰²åºåˆ—</td>\n</tr>\n<tr>\n<td><code>autopct</code></td>\n<td>str æˆ–å‡½æ•°</td>\n<td>è‡ªåŠ¨æ˜¾ç¤ºç™¾åˆ†æ¯”æ ¼å¼ï¼ˆå¦‚ <code>\"%.1f%%\"</code>ï¼‰</td>\n</tr>\n<tr>\n<td><code>pctdistance</code></td>\n<td>float</td>\n<td>ç™¾åˆ†æ¯”æ–‡æœ¬è·ç¦»åœ†å¿ƒçš„æ¯”ä¾‹ï¼ˆé»˜è®¤ <code>0.6</code>ï¼‰</td>\n</tr>\n<tr>\n<td><code>labeldistance</code></td>\n<td>float</td>\n<td>æ ‡ç­¾æ–‡æœ¬è·ç¦»åœ†å¿ƒçš„æ¯”ä¾‹ï¼ˆé»˜è®¤ <code>1.1</code>ï¼‰</td>\n</tr>\n<tr>\n<td><code>shadow</code></td>\n<td>bool</td>\n<td>æ˜¯å¦æ˜¾ç¤ºé˜´å½±ï¼ˆç«‹ä½“æ•ˆæœï¼‰</td>\n</tr>\n<tr>\n<td><code>startangle</code></td>\n<td>float</td>\n<td>èµ·å§‹è§’åº¦ï¼ˆé»˜è®¤æ˜¯ 0ï¼Œé€šå¸¸è®¾ä¸º 90 æ›´ç¾è§‚ï¼‰</td>\n</tr>\n<tr>\n<td><code>radius</code></td>\n<td>float</td>\n<td>é¥¼å›¾çš„åŠå¾„ï¼ˆé»˜è®¤æ˜¯ 1ï¼‰</td>\n</tr>\n<tr>\n<td><code>counterclock</code></td>\n<td>bool</td>\n<td>æ˜¯å¦é€†æ—¶é’ˆç»˜å›¾ï¼ˆé»˜è®¤æ˜¯ <code>True</code>ï¼‰</td>\n</tr>\n<tr>\n<td><code>wedgeprops</code></td>\n<td>dict</td>\n<td>æ§åˆ¶æ‰‡åŒºæ ·å¼ï¼Œå¦‚è¾¹æ¡†ï¼š<code>{'edgecolor': 'black'}</code></td>\n</tr>\n<tr>\n<td><code>textprops</code></td>\n<td>dict</td>\n<td>è®¾ç½®æ–‡æœ¬æ ·å¼ï¼Œå¦‚å­—ä½“å¤§å°ã€é¢œè‰²</td>\n</tr>\n<tr>\n<td><code>center</code></td>\n<td>(float, float)</td>\n<td>é¥¼å›¾çš„ä¸­å¿ƒåæ ‡ï¼ˆé»˜è®¤ <code>(0, 0)</code>ï¼‰</td>\n</tr>\n<tr>\n<td><code>frame</code></td>\n<td>bool</td>\n<td>æ˜¯å¦ç”»å›¾æ¡†ï¼ˆé»˜è®¤ <code>False</code>ï¼‰</td>\n</tr>\n<tr>\n<td><code>rotatelabels</code></td>\n<td>bool</td>\n<td>æ˜¯å¦æ—‹è½¬æ ‡ç­¾ä½¿å…¶ä¸æ‰‡åŒºå¯¹é½ï¼ˆé»˜è®¤ <code>False</code>ï¼‰</td>\n</tr>\n<tr>\n<td><code>normalize</code></td>\n<td>bool</td>\n<td>æ˜¯å¦å½’ä¸€åŒ–æ•°æ®ä¸ºæ¯”ä¾‹ï¼ˆMatplotlib 3.4+ï¼‰</td>\n</tr>\n</tbody>\n</table>\n<h4 id=\"4ç›´æ–¹å›¾\"><a class=\"anchor\" href=\"#4ç›´æ–¹å›¾\">#</a> 4.ç›´æ–¹å›¾</h4>\n<p>åŸºæœ¬ç»˜åˆ¶æ–¹å¼:</p>\n<pre class=\"shiki shiki-themes vitesse-light vitesse-dark\" style=\"background-color:#ffffff;--shiki-dark-bg:#121212;color:#393a34;--shiki-dark:#dbd7caee\" tabindex=\"0\"><code class=\"language-bash\"><span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">import</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> matplotlib.pyplot</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> as</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> plt</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">import</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> numpy</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> as</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> np</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\"># ç”Ÿæˆä¸€ç»„éšæœºæ•°æ®</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">data</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> =</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> np.random.randn</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#59873A;--shiki-dark:#80A665\">1000</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\"># ç»˜åˆ¶ç›´æ–¹å›¾</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">plt.hist</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#59873A;--shiki-dark:#80A665\">data,</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> bins=30,</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> color=</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\">'</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">skyblue</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\">'</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">,</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> alpha=</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\">0.8</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\"># è®¾ç½®å›¾è¡¨å±æ€§</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">plt.title</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#59873A;--shiki-dark:#80A665\">'RUNOOB hist() Test'</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">plt.xlabel</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#59873A;--shiki-dark:#80A665\">'Value'</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">plt.ylabel</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#59873A;--shiki-dark:#80A665\">'Frequency'</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\"># æ˜¾ç¤ºå›¾è¡¨</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">plt.show</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span></span></code></pre>\n<pre class=\"shiki shiki-themes vitesse-light vitesse-dark\" style=\"background-color:#ffffff;--shiki-dark-bg:#121212;color:#393a34;--shiki-dark:#dbd7caee\" tabindex=\"0\"><code class=\"language-bash\"><span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">matplotlib.pyplot.hist</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#59873A;--shiki-dark:#80A665\">x,</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> bins=None,</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> range=None,</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> density=False,</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> weights=None,</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> cumulative=False,</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> bottom=None,</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> histtype=</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\">'</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">bar</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\">'</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">,</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> align=</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\">'</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">mid</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\">'</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">,</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> orientation=</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\">'</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">vertical</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\">'</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">,</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> rwidth=None,</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> log=False,</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> color=None,</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> label=None,</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> stacked=False,</span><span style=\"color:#A65E2B;--shiki-dark:#C99076\"> **</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">kwargs</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span></span></code></pre>\n<table>\n<thead>\n<tr>\n<th>å‚æ•°å</th>\n<th>ç±»å‹</th>\n<th>è¯´æ˜</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td><code>x</code></td>\n<td>array-like</td>\n<td>è¦ç»˜åˆ¶ç›´æ–¹å›¾çš„æ•°æ®</td>\n</tr>\n<tr>\n<td><code>bins</code></td>\n<td>int æˆ–åºåˆ—</td>\n<td>ç›´æ–¹å›¾çš„æŸ±æ•°æˆ–è‡ªå®šä¹‰çš„åˆ†ç®±è¾¹ç•Œï¼ˆå¦‚ <code>bins=10</code> æˆ– <code>[0,1,2,3]</code>ï¼‰</td>\n</tr>\n<tr>\n<td><code>range</code></td>\n<td>tuple(min, max)</td>\n<td>è®¾ç½®æ•°æ®èŒƒå›´ï¼Œä»…åŒ…å«æ­¤èŒƒå›´å†…çš„å€¼</td>\n</tr>\n<tr>\n<td><code>density</code></td>\n<td>bool</td>\n<td>æ˜¯å¦æ˜¾ç¤ºä¸º<strong>æ¦‚ç‡å¯†åº¦</strong>ï¼ˆå½’ä¸€åŒ–é¢ç§¯ä¸º 1ï¼‰</td>\n</tr>\n<tr>\n<td><code>weights</code></td>\n<td>array-like</td>\n<td>ç»™æ¯ä¸ªæ ·æœ¬æŒ‡å®šæƒé‡</td>\n</tr>\n<tr>\n<td><code>cumulative</code></td>\n<td>bool</td>\n<td>æ˜¯å¦ç»˜åˆ¶ç´¯è®¡ç›´æ–¹å›¾</td>\n</tr>\n<tr>\n<td><code>bottom</code></td>\n<td>float æˆ– array</td>\n<td>æ¯ä¸ªæŸ±å­çš„åº•éƒ¨èµ·ç‚¹ä½ç½®ï¼ˆé»˜è®¤ä» 0 å¼€å§‹ï¼‰</td>\n</tr>\n<tr>\n<td><code>histtype</code></td>\n<td>str</td>\n<td>ç›´æ–¹å›¾ç±»å‹ï¼Œå¸¸ç”¨æœ‰ï¼š&lt;br&gt;<code>'bar'</code>ï¼ˆé»˜è®¤ï¼Œå¡«å……æŸ±çŠ¶å›¾ï¼‰&lt;br&gt;<code>'barstacked'</code>ï¼ˆå †å æŸ±çŠ¶å›¾ï¼‰&lt;br&gt;<code>'step'</code>ï¼ˆä¸å¡«å……ï¼Œè¾¹æ¡†ï¼‰&lt;br&gt;<code>'stepfilled'</code>ï¼ˆå¡«å……é˜¶æ¢¯ï¼‰</td>\n</tr>\n<tr>\n<td><code>align</code></td>\n<td left,=\"\" mid,=\"\" right=\"\"></td>\n<td>æŸ±å­ç›¸å¯¹äº bin è¾¹ç•Œçš„å¯¹é½æ–¹å¼</td>\n</tr>\n<tr>\n<td><code>orientation</code></td>\n<td vertical,=\"\" horizontal=\"\"></td>\n<td>å‚ç›´ or æ°´å¹³ç›´æ–¹å›¾</td>\n</tr>\n<tr>\n<td><code>rwidth</code></td>\n<td>floatï¼ˆ0~1ï¼‰</td>\n<td>æŸ±å®½å  bin å®½åº¦çš„æ¯”ä¾‹ï¼ˆä¾‹å¦‚ 0.8ï¼‰</td>\n</tr>\n<tr>\n<td><code>log</code></td>\n<td>bool</td>\n<td>y è½´æ˜¯å¦ä½¿ç”¨å¯¹æ•°åˆ»åº¦</td>\n</tr>\n<tr>\n<td><code>color</code></td>\n<td>str æˆ– list</td>\n<td>è®¾ç½®æŸ±å­çš„é¢œè‰²</td>\n</tr>\n<tr>\n<td><code>label</code></td>\n<td>str</td>\n<td>å›¾ä¾‹æ ‡ç­¾</td>\n</tr>\n<tr>\n<td><code>stacked</code></td>\n<td>bool</td>\n<td>æ˜¯å¦å †å å¤šç»„æ•°æ®</td>\n</tr>\n<tr>\n<td><code>**kwargs</code></td>\n<td>-</td>\n<td>å…¶ä»–ä¼ å…¥ <code>patches</code> çš„å‚æ•°ï¼Œå¦‚é€æ˜åº¦ <code>alpha</code>ã€è¾¹æ¡† <code>edgecolor</code> ç­‰</td>\n</tr>\n</tbody>\n</table>\n<pre class=\"shiki shiki-themes vitesse-light vitesse-dark\" style=\"background-color:#ffffff;--shiki-dark-bg:#121212;color:#393a34;--shiki-dark:#dbd7caee\" tabindex=\"0\"><code class=\"language-bash\"><span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">import</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> matplotlib.pyplot</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> as</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> plt</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">import</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> numpy</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> as</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> np</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\"># ç”Ÿæˆä¸‰ç»„éšæœºæ•°æ®</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">data1</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> =</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> np.random.normal</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#59873A;--shiki-dark:#80A665\">0,</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> 1,</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\"> 1000</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">data2</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> =</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> np.random.normal</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#59873A;--shiki-dark:#80A665\">2,</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> 1,</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\"> 1000</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">data3</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> =</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> np.random.normal</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#59873A;--shiki-dark:#80A665\">-2,</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> 1,</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\"> 1000</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\"># ç»˜åˆ¶ç›´æ–¹å›¾</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">plt.hist</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#59873A;--shiki-dark:#80A665\">data1,</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> bins=30,</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> alpha=0.5,</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> label=</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\">'</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">Data 1</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\">'</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">plt.hist</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#59873A;--shiki-dark:#80A665\">data2,</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> bins=30,</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> alpha=0.5,</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> label=</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\">'</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">Data 2</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\">'</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">plt.hist</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#59873A;--shiki-dark:#80A665\">data3,</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> bins=30,</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> alpha=0.5,</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> label=</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\">'</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">Data 3</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\">'</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\"># è®¾ç½®å›¾è¡¨å±æ€§</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">plt.title</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#59873A;--shiki-dark:#80A665\">'RUNOOB hist() TEST'</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">plt.xlabel</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#59873A;--shiki-dark:#80A665\">'Value'</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">plt.ylabel</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#59873A;--shiki-dark:#80A665\">'Frequency'</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">plt.legend</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\"># æ˜¾ç¤ºå›¾è¡¨</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">plt.show</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span></span></code></pre>\n<p>ä»¥ä¸Šå®ä¾‹ä¸­æˆ‘ä»¬ç”Ÿæˆäº†ä¸‰ç»„ä¸åŒçš„éšæœºæ•°æ®ï¼Œå¹¶ä½¿ç”¨ hist() å‡½æ•°ç»˜åˆ¶äº†å®ƒä»¬çš„ç›´æ–¹å›¾ã€‚é€šè¿‡è®¾ç½®ä¸åŒçš„å‡å€¼å’Œæ ‡å‡†å·®ï¼Œæˆ‘ä»¬å¯ä»¥ç”Ÿæˆå…·æœ‰ä¸åŒåˆ†å¸ƒç‰¹å¾çš„éšæœºæ•°æ®ã€‚</p>\n<p>æˆ‘ä»¬è®¾ç½®äº† bins å‚æ•°ä¸º 30ï¼Œè¿™æ„å‘³ç€å°†æ•°æ®èŒƒå›´åˆ†æˆ 30 ä¸ªç­‰å®½çš„åŒºé—´ï¼Œç„¶åç»Ÿè®¡æ¯ä¸ªåŒºé—´å†…æ•°æ®çš„é¢‘æ•°ã€‚</p>\n<p>æˆ‘ä»¬è®¾ç½®äº† alpha å‚æ•°ä¸º 0.5ï¼Œè¿™æ„å‘³ç€æ¯ä¸ªç›´æ–¹å›¾çš„é¢œè‰²é€æ˜åº¦ä¸º 50%ã€‚<br>\næˆ‘ä»¬ä½¿ç”¨ label å‚æ•°è®¾ç½®äº†æ¯ä¸ªç›´æ–¹å›¾çš„æ ‡ç­¾ï¼Œä»¥ä¾¿åœ¨å›¾ä¾‹ä¸­æ˜¾ç¤ºã€‚</p>\n<p>ç„¶åä½¿ç”¨ legend() å‡½æ•°æ˜¾ç¤ºå›¾ä¾‹ã€‚æœ€åï¼Œæˆ‘ä»¬ä½¿ç”¨ title()ã€xlabel() å’Œ ylabel() å‡½æ•°è®¾ç½®äº†å›¾è¡¨çš„æ ‡é¢˜å’Œåæ ‡è½´æ ‡ç­¾ã€‚</p>\n<p>æ˜¾ç¤ºç»“æœå¦‚ä¸‹ï¼š</p>\n<p><img loading=\"lazy\" src=\"/images/pytorch/ex3.png\" alt=\"ex3\"></p>\n<h3 id=\"4imshowimsaveimread\"><a class=\"anchor\" href=\"#4imshowimsaveimread\">#</a> 4.imshow,imsave,imread</h3>\n<p>imshowç”¨äºå›¾åƒæ˜¾ç¤º</p>\n<pre class=\"shiki shiki-themes vitesse-light vitesse-dark\" style=\"background-color:#ffffff;--shiki-dark-bg:#121212;color:#393a34;--shiki-dark:#dbd7caee\" tabindex=\"0\"><code class=\"language-bash\"><span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">import</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> matplotlib.pyplot</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> as</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> plt</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">import</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> numpy</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> as</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> np</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\"># åˆ›å»ºä¸€ä¸ª 10x10 éšæœºå›¾åƒ</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">img</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> =</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> np.random.rand</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#59873A;--shiki-dark:#80A665\">10,</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\"> 10</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">plt.imshow</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#59873A;--shiki-dark:#80A665\">img,</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> cmap=</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\">'</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">viridis</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\">'</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">,</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> interpolation=</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\">'</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">nearest</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\">'</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">plt.colorbar</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">plt.title</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#59873A;--shiki-dark:#80A665\">\"éšæœºå›¾åƒ\"</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">plt.show</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span></span></code></pre>\n<table>\n<thead>\n<tr>\n<th>å‚æ•°å</th>\n<th>è¯´æ˜</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td><code>X</code></td>\n<td>è¾“å…¥å›¾åƒï¼ˆ2D/3D NumPy æ•°ç»„ï¼‰</td>\n</tr>\n<tr>\n<td><code>cmap</code></td>\n<td>é¢œè‰²æ˜ å°„ï¼ˆå¦‚ <code>'gray'</code>, <code>'viridis'</code>, <code>'hot'</code> ç­‰ï¼‰</td>\n</tr>\n<tr>\n<td><code>interpolation</code></td>\n<td>æ’å€¼æ–¹æ³•ï¼ˆå¦‚ <code>'nearest'</code>, <code>'bilinear'</code>ï¼Œç”¨äºæ”¾ç¼©ï¼‰</td>\n</tr>\n<tr>\n<td><code>vmin</code>, <code>vmax</code></td>\n<td>ç”¨äºå½’ä¸€åŒ–å›¾åƒå€¼èŒƒå›´ï¼ˆåƒç´ å€¼æ˜ å°„åˆ°é¢œè‰²ï¼‰</td>\n</tr>\n<tr>\n<td><code>alpha</code></td>\n<td>é€æ˜åº¦ï¼ˆ0 åˆ° 1ï¼‰</td>\n</tr>\n<tr>\n<td><code>extent</code></td>\n<td>è®¾ç½®åæ ‡è½´èŒƒå›´ï¼Œä¾‹å¦‚ <code>[xmin, xmax, ymin, ymax]</code></td>\n</tr>\n<tr>\n<td><code>origin</code></td>\n<td><code>'upper'</code> æˆ– <code>'lower'</code>ï¼Œè®¾ç½®å›¾åƒåŸç‚¹æ–¹å‘</td>\n</tr>\n</tbody>\n</table>\n<p>imreadç”¨äºè¯»å–å›¾åƒ</p>\n<pre class=\"shiki shiki-themes vitesse-light vitesse-dark\" style=\"background-color:#ffffff;--shiki-dark-bg:#121212;color:#393a34;--shiki-dark:#dbd7caee\" tabindex=\"0\"><code class=\"language-bash\"><span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">import</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> matplotlib.pyplot</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> as</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> plt</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">img</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> =</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> plt.imread</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#59873A;--shiki-dark:#80A665\">\"cat.jpg\"</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span></span>\n<span class=\"line\"><span style=\"color:#998418;--shiki-dark:#B8A965\">print</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">img.shape</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">  </span><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\"># ä¾‹å¦‚ (400, 600, 3)</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">plt.imshow</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#59873A;--shiki-dark:#80A665\">img</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">plt.axis</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#59873A;--shiki-dark:#80A665\">'off'</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">plt.title</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#59873A;--shiki-dark:#80A665\">\"çŒ«çŒ«å›¾åƒ\"</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">plt.show</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span></span></code></pre>\n<p>imsaveç”¨äºä¿å­˜å›¾åƒ</p>\n<pre class=\"shiki shiki-themes vitesse-light vitesse-dark\" style=\"background-color:#ffffff;--shiki-dark-bg:#121212;color:#393a34;--shiki-dark:#dbd7caee\" tabindex=\"0\"><code class=\"language-bash\"><span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">import</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> matplotlib.pyplot</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> as</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> plt</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">import</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> numpy</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> as</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> np</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\"># ä¿å­˜ä¸€å¼ éšæœºå›¾åƒ</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">img</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> =</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> np.random.rand</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#59873A;--shiki-dark:#80A665\">100,</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\"> 100</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">plt.imsave</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#59873A;--shiki-dark:#80A665\">\"random_image.png\"</span><span style=\"color:#59873A;--shiki-dark:#80A665\">,</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> img,</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> cmap=</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\">'</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">gray</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\">'</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span></span>\n<span class=\"line\"></span></code></pre>\n<table>\n<thead>\n<tr>\n<th>å‚æ•°å</th>\n<th>è¯´æ˜</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td><code>fname</code></td>\n<td>ä¿å­˜æ–‡ä»¶è·¯å¾„ï¼ˆå­—ç¬¦ä¸²ï¼‰</td>\n</tr>\n<tr>\n<td><code>arr</code></td>\n<td>NumPy å›¾åƒæ•°ç»„</td>\n</tr>\n<tr>\n<td><code>cmap</code></td>\n<td>æ˜ å°„é¢œè‰²è¡¨ï¼ˆç°åº¦å›¾éœ€è¦ï¼‰</td>\n</tr>\n<tr>\n<td><code>format</code></td>\n<td>å¯é€‰å¼ºåˆ¶ä¿å­˜æ ¼å¼</td>\n</tr>\n<tr>\n<td><code>vmin</code>, <code>vmax</code></td>\n<td>æ˜ å°„åƒç´ å€¼èŒƒå›´ï¼ˆå½’ä¸€åŒ–ï¼‰</td>\n</tr>\n</tbody>\n</table>\n<hr>\n<h2 id=\"ç•ªå¤–äºŒ-æ•°æ®å¤„ç†ç¯‡\"><a class=\"anchor\" href=\"#ç•ªå¤–äºŒ-æ•°æ®å¤„ç†ç¯‡\">#</a> ç•ªå¤–äºŒã€æ•°æ®å¤„ç†ç¯‡</h2>\n<h3 id=\"pandasæ“ä½œå¤–éƒ¨æ•°æ®\"><a class=\"anchor\" href=\"#pandasæ“ä½œå¤–éƒ¨æ•°æ®\">#</a> Pandasæ“ä½œå¤–éƒ¨æ•°æ®</h3>\n<ol>\n<li>è¯»å– CSV æ–‡ä»¶ï¼š<code>pd.read_csv()</code></li>\n</ol>\n<pre class=\"shiki shiki-themes vitesse-light vitesse-dark\" style=\"background-color:#ffffff;--shiki-dark-bg:#121212;color:#393a34;--shiki-dark:#dbd7caee\" tabindex=\"0\"><code class=\"language-python\"><span class=\"line\"><span style=\"color:#1E754F;--shiki-dark:#4D9375\">import</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\"> pandas </span><span style=\"color:#1E754F;--shiki-dark:#4D9375\">as</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\"> pd</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">df </span><span style=\"color:#999999;--shiki-dark:#666666\">=</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\"> pd</span><span style=\"color:#999999;--shiki-dark:#666666\">.</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">read_csv</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">data.csv</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span></span></code></pre>\n<table>\n<thead>\n<tr>\n<th>å‚æ•°å</th>\n<th>è¯´æ˜</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td><code>sep</code></td>\n<td>åˆ†éš”ç¬¦ï¼Œé»˜è®¤<code>,</code>ï¼Œå¯ä»¥è®¾ä¸º<code>\\t</code></td>\n</tr>\n<tr>\n<td><code>header</code></td>\n<td>æŒ‡å®šå“ªä¸€è¡Œä¸ºåˆ—å</td>\n</tr>\n<tr>\n<td><code>names</code></td>\n<td>è‡ªå®šä¹‰åˆ—å</td>\n</tr>\n<tr>\n<td><code>index_col</code></td>\n<td>æŒ‡å®šå“ªåˆ—ä½œä¸ºç´¢å¼•</td>\n</tr>\n<tr>\n<td><code>usecols</code></td>\n<td>è¯»å–æŒ‡å®šåˆ—</td>\n</tr>\n<tr>\n<td><code>encoding</code></td>\n<td>ç¼–ç ï¼Œé¿å…ä¸­æ–‡ä¹±ç ç”¨<code>utf-8-sig</code> æˆ– <code>gbk</code></td>\n</tr>\n</tbody>\n</table>\n<ol start=\"2\">\n<li>å†™å…¥ CSV æ–‡ä»¶ï¼š<code>df.to_csv()</code></li>\n</ol>\n<pre class=\"shiki shiki-themes vitesse-light vitesse-dark\" style=\"background-color:#ffffff;--shiki-dark-bg:#121212;color:#393a34;--shiki-dark:#dbd7caee\" tabindex=\"0\"><code class=\"language-python\"><span class=\"line\"><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">df</span><span style=\"color:#999999;--shiki-dark:#666666\">.</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">to_csv</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">output.csv</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span><span style=\"color:#B07D48;--shiki-dark:#BD976A\"> index</span><span style=\"color:#999999;--shiki-dark:#666666\">=</span><span style=\"color:#1E754F;--shiki-dark:#4D9375\">False</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span><span style=\"color:#B07D48;--shiki-dark:#BD976A\"> encoding</span><span style=\"color:#999999;--shiki-dark:#666666\">=</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">utf-8-sig</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span></span></code></pre>\n<hr>\n<ol start=\"3\">\n<li>è¯»å– Excel æ–‡ä»¶ï¼š<code>pd.read_excel()</code></li>\n</ol>\n<pre class=\"shiki shiki-themes vitesse-light vitesse-dark\" style=\"background-color:#ffffff;--shiki-dark-bg:#121212;color:#393a34;--shiki-dark:#dbd7caee\" tabindex=\"0\"><code class=\"language-python\"><span class=\"line\"><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">df </span><span style=\"color:#999999;--shiki-dark:#666666\">=</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\"> pd</span><span style=\"color:#999999;--shiki-dark:#666666\">.</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">read_excel</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">data.xlsx</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span><span style=\"color:#B07D48;--shiki-dark:#BD976A\"> sheet_name</span><span style=\"color:#999999;--shiki-dark:#666666\">=</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">Sheet1</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span></span></code></pre>\n<table>\n<thead>\n<tr>\n<th>å‚æ•°å</th>\n<th>è¯´æ˜</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td><code>sheet_name</code></td>\n<td>å·¥ä½œè¡¨åç§°æˆ–ç´¢å¼•</td>\n</tr>\n<tr>\n<td><code>usecols</code></td>\n<td>æŒ‡å®šè¯»å–åˆ—</td>\n</tr>\n<tr>\n<td><code>index_col</code></td>\n<td>è®¾ç½®ç´¢å¼•åˆ—</td>\n</tr>\n</tbody>\n</table>\n<ol start=\"4\">\n<li>å†™å…¥ Excel æ–‡ä»¶ï¼š<code>df.to_excel()</code></li>\n</ol>\n<pre class=\"shiki shiki-themes vitesse-light vitesse-dark\" style=\"background-color:#ffffff;--shiki-dark-bg:#121212;color:#393a34;--shiki-dark:#dbd7caee\" tabindex=\"0\"><code class=\"language-python\"><span class=\"line\"><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">df</span><span style=\"color:#999999;--shiki-dark:#666666\">.</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">to_excel</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">output.xlsx</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span><span style=\"color:#B07D48;--shiki-dark:#BD976A\"> sheet_name</span><span style=\"color:#999999;--shiki-dark:#666666\">=</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">ç»“æœ</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span><span style=\"color:#B07D48;--shiki-dark:#BD976A\"> index</span><span style=\"color:#999999;--shiki-dark:#666666\">=</span><span style=\"color:#1E754F;--shiki-dark:#4D9375\">False</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span></span></code></pre>\n<ol start=\"5\">\n<li>å¤šä¸ª sheet å†™å…¥</li>\n</ol>\n<pre class=\"shiki shiki-themes vitesse-light vitesse-dark\" style=\"background-color:#ffffff;--shiki-dark-bg:#121212;color:#393a34;--shiki-dark:#dbd7caee\" tabindex=\"0\"><code class=\"language-python\"><span class=\"line\"><span style=\"color:#1E754F;--shiki-dark:#4D9375\">with</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\"> pd</span><span style=\"color:#999999;--shiki-dark:#666666\">.</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">ExcelWriter</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">multi.xlsx</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span><span style=\"color:#1E754F;--shiki-dark:#4D9375\"> as</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\"> writer</span><span style=\"color:#999999;--shiki-dark:#666666\">:</span></span>\n<span class=\"line\"><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">    df1</span><span style=\"color:#999999;--shiki-dark:#666666\">.</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">to_excel</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">writer</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span><span style=\"color:#B07D48;--shiki-dark:#BD976A\"> sheet_name</span><span style=\"color:#999999;--shiki-dark:#666666\">=</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">Sheet1</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span></span>\n<span class=\"line\"><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">    df2</span><span style=\"color:#999999;--shiki-dark:#666666\">.</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">to_excel</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">writer</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span><span style=\"color:#B07D48;--shiki-dark:#BD976A\"> sheet_name</span><span style=\"color:#999999;--shiki-dark:#666666\">=</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">Sheet2</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span></span></code></pre>\n<hr>\n<ol start=\"6\">\n<li>è¯»å– JSON æ–‡ä»¶ï¼š<code>pd.read_json()</code></li>\n</ol>\n<pre class=\"shiki shiki-themes vitesse-light vitesse-dark\" style=\"background-color:#ffffff;--shiki-dark-bg:#121212;color:#393a34;--shiki-dark:#dbd7caee\" tabindex=\"0\"><code class=\"language-python\"><span class=\"line\"><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">df </span><span style=\"color:#999999;--shiki-dark:#666666\">=</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\"> pd</span><span style=\"color:#999999;--shiki-dark:#666666\">.</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">read_json</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">data.json</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span></span></code></pre>\n<p>JSON æ ¼å¼è¦æ±‚ï¼šé€šå¸¸æ˜¯æ•°ç»„å¯¹è±¡ç»“æ„ï¼Œå¦‚ï¼š</p>\n<pre class=\"shiki shiki-themes vitesse-light vitesse-dark\" style=\"background-color:#ffffff;--shiki-dark-bg:#121212;color:#393a34;--shiki-dark:#dbd7caee\" tabindex=\"0\"><code class=\"language-json\"><span class=\"line\"><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">[</span></span>\n<span class=\"line\"><span style=\"color:#999999;--shiki-dark:#666666\">  </span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">{</span><span style=\"color:#99841877;--shiki-dark:#B8A96577\">\"</span><span style=\"color:#998418;--shiki-dark:#B8A965\">name</span><span style=\"color:#99841877;--shiki-dark:#B8A96577\">\"</span><span style=\"color:#999999;--shiki-dark:#666666\">:</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">Alice</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span><span style=\"color:#99841877;--shiki-dark:#B8A96577\"> \"</span><span style=\"color:#998418;--shiki-dark:#B8A965\">age</span><span style=\"color:#99841877;--shiki-dark:#B8A96577\">\"</span><span style=\"color:#999999;--shiki-dark:#666666\">:</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\"> 25</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">}</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span></span>\n<span class=\"line\"><span style=\"color:#999999;--shiki-dark:#666666\">  </span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">{</span><span style=\"color:#99841877;--shiki-dark:#B8A96577\">\"</span><span style=\"color:#998418;--shiki-dark:#B8A965\">name</span><span style=\"color:#99841877;--shiki-dark:#B8A96577\">\"</span><span style=\"color:#999999;--shiki-dark:#666666\">:</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">Bob</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span><span style=\"color:#99841877;--shiki-dark:#B8A96577\"> \"</span><span style=\"color:#998418;--shiki-dark:#B8A965\">age</span><span style=\"color:#99841877;--shiki-dark:#B8A96577\">\"</span><span style=\"color:#999999;--shiki-dark:#666666\">:</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\"> 30</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">}</span></span>\n<span class=\"line\"><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">]</span></span></code></pre>\n<ol start=\"7\">\n<li>å†™å…¥ JSON æ–‡ä»¶ï¼š<code>df.to_json()</code></li>\n</ol>\n<pre class=\"shiki shiki-themes vitesse-light vitesse-dark\" style=\"background-color:#ffffff;--shiki-dark-bg:#121212;color:#393a34;--shiki-dark:#dbd7caee\" tabindex=\"0\"><code class=\"language-python\"><span class=\"line\"><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">df</span><span style=\"color:#999999;--shiki-dark:#666666\">.</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">to_json</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">output.json</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span><span style=\"color:#B07D48;--shiki-dark:#BD976A\"> orient</span><span style=\"color:#999999;--shiki-dark:#666666\">=</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">records</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span><span style=\"color:#B07D48;--shiki-dark:#BD976A\"> force_ascii</span><span style=\"color:#999999;--shiki-dark:#666666\">=</span><span style=\"color:#1E754F;--shiki-dark:#4D9375\">False</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span></span></code></pre>\n<table>\n<thead>\n<tr>\n<th>å‚æ•°å</th>\n<th>è¯´æ˜</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td><code>orient</code></td>\n<td>ç»“æ„æ–¹å¼ï¼Œå¦‚ <code>records</code>, <code>split</code>, <code>index</code> ç­‰</td>\n</tr>\n<tr>\n<td><code>force_ascii</code></td>\n<td>ä¸­æ–‡æ˜¯å¦è½¬ä¹‰ä¸º ASCIIï¼Œè®¾ä¸º False ä¿ç•™ä¸­æ–‡</td>\n</tr>\n</tbody>\n</table>\n<hr>\n<table>\n<thead>\n<tr>\n<th>æ–‡ä»¶ç±»å‹</th>\n<th>è¯»å–å‡½æ•°</th>\n<th>å†™å…¥å‡½æ•°</th>\n<th>æ”¯æŒå¤šè¡¨</th>\n<th>ç¼–ç è®¾ç½®</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>CSV</td>\n<td><code>pd.read_csv()</code></td>\n<td><code>df.to_csv()</code></td>\n<td>å¦</td>\n<td>æ”¯æŒ</td>\n</tr>\n<tr>\n<td>Excel</td>\n<td><code>pd.read_excel()</code></td>\n<td><code>df.to_excel()</code></td>\n<td>æ˜¯</td>\n<td>ä¸€èˆ¬æ— éœ€</td>\n</tr>\n<tr>\n<td>JSON</td>\n<td><code>pd.read_json()</code></td>\n<td><code>df.to_json()</code></td>\n<td>å¦</td>\n<td>æ”¯æŒ</td>\n</tr>\n</tbody>\n</table>\n<h3 id=\"pandaså®ç°æ•°æ®æ¸…æ´—\"><a class=\"anchor\" href=\"#pandaså®ç°æ•°æ®æ¸…æ´—\">#</a> Pandaså®ç°æ•°æ®æ¸…æ´—</h3>\n<ol>\n<li>æ¸…ç†ç©ºå€¼</li>\n</ol>\n<p>é¦–å…ˆå¯ä»¥åœ¨è¯»å–æ–‡ä»¶çš„æ—¶å€™è‡ªå®šä¹‰ç©ºå€¼</p>\n<pre class=\"shiki shiki-themes vitesse-light vitesse-dark\" style=\"background-color:#ffffff;--shiki-dark-bg:#121212;color:#393a34;--shiki-dark:#dbd7caee\" tabindex=\"0\"><code class=\"language-bash\"><span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">missing_values</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> =</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\"> </span><span style=\"color:rgba(255, 18, 18, 0.8);--shiki-dark:rgba(255, 18, 18, 0.8)\">[</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">n/a</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">, </span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">na</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">,</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">--</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">]#è‡ªå®šä¹‰ç¼ºå¤±å€¼</span></span>\n<span class=\"line\"><span style=\"color:#B07D48;--shiki-dark:#BD976A\">df</span><span style=\"color:#999999;--shiki-dark:#666666\">=</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">pd.read_csv</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">(</span><span style=\"color:#59873A;--shiki-dark:#80A665\">\"./data/csv/property-data.csv\"</span><span style=\"color:#59873A;--shiki-dark:#80A665\">,na_values</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">=missing_values</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">)</span></span></code></pre>\n<p>åˆ©ç”¨dropnaæ–¹æ³•æ¸…ç†ç©ºå€¼</p>\n<pre class=\"shiki shiki-themes vitesse-light vitesse-dark\" style=\"background-color:#ffffff;--shiki-dark-bg:#121212;color:#393a34;--shiki-dark:#dbd7caee\" tabindex=\"0\"><code class=\"language-bash\"><span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">df.dropna</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#59873A;--shiki-dark:#80A665\">axis</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">=0,how=</span><span style=\"color:#59873A;--shiki-dark:#80A665\">'any'</span><span style=\"color:#59873A;--shiki-dark:#80A665\">,thresh</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">=None,</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> subset=None,</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> inplace=True</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\"> </span><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\">#inplace=Trueè¡¨ç¤ºåœ¨åŸæ•°æ®ä¸Šä¿®æ”¹</span></span>\n<span class=\"line\"><span style=\"color:#998418;--shiki-dark:#B8A965\">print</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\"> </span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">df</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">[</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\">'</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">NUM_BEDROOMS</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\">'</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">]</span><span style=\"color:#59873A;--shiki-dark:#80A665\">.isnull</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">(</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">)</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span></span>\n<span class=\"line\"><span style=\"color:#998418;--shiki-dark:#B8A965\">print</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">df.to_string</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">(</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">)</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span></span></code></pre>\n<ol start=\"2\">\n<li>æ›¿æ¢ç©ºå•å…ƒæ ¼</li>\n</ol>\n<p>å¸¸ç”¨æ–¹æ³•æ˜¯è®¡ç®—åˆ—çš„å‡å€¼ã€ä¸­ä½æ•°å€¼æˆ–ä¼—æ•°:</p>\n<pre class=\"shiki shiki-themes vitesse-light vitesse-dark\" style=\"background-color:#ffffff;--shiki-dark-bg:#121212;color:#393a34;--shiki-dark:#dbd7caee\" tabindex=\"0\"><code class=\"language-bash\"><span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">missing_values</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> =</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\"> </span><span style=\"color:rgba(255, 18, 18, 0.8);--shiki-dark:rgba(255, 18, 18, 0.8)\">[</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">n/a</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">, </span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">na</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">,</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">--</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">]#è‡ªå®šä¹‰ç¼ºå¤±å€¼</span></span>\n<span class=\"line\"><span style=\"color:#B07D48;--shiki-dark:#BD976A\">df</span><span style=\"color:#999999;--shiki-dark:#666666\">=</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">pd.read_csv</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">(</span><span style=\"color:#59873A;--shiki-dark:#80A665\">\"./data/csv/property-data.csv\"</span><span style=\"color:#59873A;--shiki-dark:#80A665\">,na_values</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">=missing_values</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">)</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">x</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> =</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> df[</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">ST_NUM</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">].mean</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">(</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">)</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#998418;--shiki-dark:#B8A965\">print</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">(</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">x</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">)</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">df</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">[</span><span style=\"color:#59873A;--shiki-dark:#80A665\">\"ST_NUM\"</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">]</span><span style=\"color:#59873A;--shiki-dark:#80A665\">.fillna</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">(</span><span style=\"color:#59873A;--shiki-dark:#80A665\">x,</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> inplace</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> =</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> True</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">)</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#998418;--shiki-dark:#B8A965\">print</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">(</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">df.to_string</span><span style=\"color:#a65e2b;--shiki-dark:#d4976c\">(</span><span style=\"color:#a65e2b;--shiki-dark:#d4976c\">)</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">)</span></span></code></pre>\n<ol start=\"3\">\n<li>æ¸…æ´—æ ¼å¼é”™è¯¯æ•°æ®</li>\n</ol>\n<p>åˆ©ç”¨to_datetimeè¿›è¡Œå¤„ç†</p>\n<pre class=\"shiki shiki-themes vitesse-light vitesse-dark\" style=\"background-color:#ffffff;--shiki-dark-bg:#121212;color:#393a34;--shiki-dark:#dbd7caee\" tabindex=\"0\"><code class=\"language-bash\"><span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">data</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> =</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> {</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">  \"Date\"</span><span style=\"color:#998418;--shiki-dark:#B8A965\">:</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\"> </span><span style=\"color:rgba(255, 18, 18, 0.8);--shiki-dark:rgba(255, 18, 18, 0.8)\">[</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\">'</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">2020/12/01</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\">'</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">, </span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\">'</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">2020/12/02</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\">'</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> ,</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\"> '</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">20201226</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\">'</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">],</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">  \"duration\"</span><span style=\"color:#998418;--shiki-dark:#B8A965\">:</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\"> </span><span style=\"color:rgba(255, 18, 18, 0.8);--shiki-dark:rgba(255, 18, 18, 0.8)\">[</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">50, </span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">40,</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> 45]</span></span>\n<span class=\"line\"><span style=\"color:rgba(255, 18, 18, 0.8);--shiki-dark:rgba(255, 18, 18, 0.8)\">}</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">df</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> =</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> pd.DataFrame</span><span style=\"color:#a65e2b;--shiki-dark:#d4976c\">(</span><span style=\"color:#59873A;--shiki-dark:#80A665\">data,</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> index</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> =</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\"> </span><span style=\"color:rgba(255, 18, 18, 0.8);--shiki-dark:rgba(255, 18, 18, 0.8)\">[</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">day1</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">, </span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">day2</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">,</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">day3</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">]</span><span style=\"color:#a65e2b;--shiki-dark:#d4976c\">)</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">df</span><span style=\"color:#a65e2b;--shiki-dark:#d4976c\">[</span><span style=\"color:#59873A;--shiki-dark:#80A665\">'Date'</span><span style=\"color:#a65e2b;--shiki-dark:#d4976c\">]</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> =</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> pd.to_datetime</span><span style=\"color:#a65e2b;--shiki-dark:#d4976c\">(</span><span style=\"color:#59873A;--shiki-dark:#80A665\">df</span><span style=\"color:#a13865;--shiki-dark:#d9739f\">[</span><span style=\"color:#59873A;--shiki-dark:#80A665\">'Date'</span><span style=\"color:#a13865;--shiki-dark:#d9739f\">]</span><span style=\"color:#a65e2b;--shiki-dark:#d4976c\">)</span></span>\n<span class=\"line\"><span style=\"color:#998418;--shiki-dark:#B8A965\">print</span><span style=\"color:#a65e2b;--shiki-dark:#d4976c\">(</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">df.to_string</span><span style=\"color:#a13865;--shiki-dark:#d9739f\">(</span><span style=\"color:#a13865;--shiki-dark:#d9739f\">)</span><span style=\"color:#a65e2b;--shiki-dark:#d4976c\">)</span></span></code></pre>\n<ol start=\"4\">\n<li>æ¸…æ´—é”™è¯¯æ•°æ®</li>\n</ol>\n<p>åˆ©ç”¨loc(index,head)+ifåˆ¤æ–­æ¡ä»¶å¤„ç†ä¿®æ”¹å¼‚å¸¸æ•°æ®</p>\n<pre class=\"shiki shiki-themes vitesse-light vitesse-dark\" style=\"background-color:#ffffff;--shiki-dark-bg:#121212;color:#393a34;--shiki-dark:#dbd7caee\" tabindex=\"0\"><code class=\"language-bash\"><span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">person</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> =</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> {</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">  \"name\"</span><span style=\"color:#998418;--shiki-dark:#B8A965\">:</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\"> </span><span style=\"color:rgba(255, 18, 18, 0.8);--shiki-dark:rgba(255, 18, 18, 0.8)\">[</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\">'</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">Google</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\">'</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">, </span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\">'</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">Runoob</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\">'</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> ,</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\"> '</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">Taobao</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\">'</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">],</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">  \"age\"</span><span style=\"color:#998418;--shiki-dark:#B8A965\">:</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\"> </span><span style=\"color:rgba(255, 18, 18, 0.8);--shiki-dark:rgba(255, 18, 18, 0.8)\">[</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">50, </span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">40,</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> 12345]</span><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\">    # 12345 å¹´é¾„æ•°æ®æ˜¯é”™è¯¯çš„</span></span>\n<span class=\"line\"><span style=\"color:rgba(255, 18, 18, 0.8);--shiki-dark:rgba(255, 18, 18, 0.8)\">}</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">df</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> =</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> pd.DataFrame</span><span style=\"color:#a65e2b;--shiki-dark:#d4976c\">(</span><span style=\"color:#59873A;--shiki-dark:#80A665\">person</span><span style=\"color:#a65e2b;--shiki-dark:#d4976c\">)</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#1E754F;--shiki-dark:#4D9375\">for</span><span style=\"color:#B07D48;--shiki-dark:#BD976A\"> x</span><span style=\"color:#1E754F;--shiki-dark:#4D9375\"> in</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> df.index:</span></span>\n<span class=\"line\"><span style=\"color:#1E754F;--shiki-dark:#4D9375\">  if</span><span style=\"color:#59873A;--shiki-dark:#80A665\"> df.loc</span><span style=\"color:rgba(255, 18, 18, 0.8);--shiki-dark:rgba(255, 18, 18, 0.8)\">[</span><span style=\"color:#59873A;--shiki-dark:#80A665\">x,</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">age</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">]</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\"> </span><span style=\"color:#AB5959;--shiki-dark:#CB7676\">&gt;</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> 120:</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">    df.loc</span><span style=\"color:rgba(255, 18, 18, 0.8);--shiki-dark:rgba(255, 18, 18, 0.8)\">[</span><span style=\"color:#59873A;--shiki-dark:#80A665\">x,</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">age</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">]</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> =</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\"> 120</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#998418;--shiki-dark:#B8A965\">print</span><span style=\"color:#bda437;--shiki-dark:#e6cc77\">(</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">df.to_string</span><span style=\"color:#296aa3;--shiki-dark:#6394bf\">(</span><span style=\"color:#296aa3;--shiki-dark:#6394bf\">)</span><span style=\"color:#bda437;--shiki-dark:#e6cc77\">)</span></span></code></pre>\n<ol start=\"5\">\n<li>æ¸…æ´—é‡å¤æ•°æ®</li>\n</ol>\n<p>åˆ©ç”¨<code>drop_duplicates</code>æ–¹æ³•</p>\n<pre class=\"shiki shiki-themes vitesse-light vitesse-dark\" style=\"background-color:#ffffff;--shiki-dark-bg:#121212;color:#393a34;--shiki-dark:#dbd7caee\" tabindex=\"0\"><code class=\"language-bash\"><span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">persons</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> =</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> {</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">  \"name\"</span><span style=\"color:#998418;--shiki-dark:#B8A965\">:</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\"> </span><span style=\"color:rgba(255, 18, 18, 0.8);--shiki-dark:rgba(255, 18, 18, 0.8)\">[</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\">'</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">Google</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\">'</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">, </span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\">'</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">Runoob</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\">'</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">,</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\"> '</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">Runoob</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\">'</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">,</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\"> '</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">Taobao</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\">'</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">],</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">  \"age\"</span><span style=\"color:#998418;--shiki-dark:#B8A965\">:</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\"> </span><span style=\"color:rgba(255, 18, 18, 0.8);--shiki-dark:rgba(255, 18, 18, 0.8)\">[</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">50, </span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">40,</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> 40,</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> 23]</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">  </span></span>\n<span class=\"line\"><span style=\"color:rgba(255, 18, 18, 0.8);--shiki-dark:rgba(255, 18, 18, 0.8)\">}</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#B07D48;--shiki-dark:#BD976A\">df</span><span style=\"color:#999999;--shiki-dark:#666666\">=</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">pd.DataFrame</span><span style=\"color:#a65e2b;--shiki-dark:#d4976c\">(</span><span style=\"color:#59873A;--shiki-dark:#80A665\">persons</span><span style=\"color:#a65e2b;--shiki-dark:#d4976c\">)</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">df.drop_duplicates</span><span style=\"color:#a65e2b;--shiki-dark:#d4976c\">(</span><span style=\"color:#59873A;--shiki-dark:#80A665\">inplace</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> =</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> True</span><span style=\"color:#a65e2b;--shiki-dark:#d4976c\">)</span></span>\n<span class=\"line\"><span style=\"color:#998418;--shiki-dark:#B8A965\">print</span><span style=\"color:#a65e2b;--shiki-dark:#d4976c\">(</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">df</span><span style=\"color:#a65e2b;--shiki-dark:#d4976c\">)</span></span>\n<span class=\"line\"></span></code></pre>\n<ol start=\"6\">\n<li>æ•°æ®å½’ä¸€åŒ–å’Œæ ‡å‡†åŒ–</li>\n</ol>\n<p><code>StandardScaler()</code>æ ‡å‡†åŒ–:å°†æ•°æ®è½¬æ¢ä¸ºå‡å€¼ä¸º0ï¼Œæ ‡å‡†å·®ä¸º1çš„åˆ†å¸ƒã€‚</p>\n<p><code>MinMaxScaler()</code>å½’ä¸€åŒ–:å°†æ•°æ®ç¼©æ”¾åˆ°æŒ‡å®šçš„èŒƒå›´ï¼ˆå¦‚ [0, 1]ï¼‰</p>\n<p><code>StandardScaler</code> å’Œ <code>MinMaxScaler</code> ï¼Œéƒ½æ˜¯æ¥è‡ª sklearn.preprocessing æ¨¡å—çš„ç‰¹å¾ç¼©æ”¾å™¨ï¼ˆscalersï¼‰</p>\n<p>è°ƒç”¨å®ä¾‹:</p>\n<pre class=\"shiki shiki-themes vitesse-light vitesse-dark\" style=\"background-color:#ffffff;--shiki-dark-bg:#121212;color:#393a34;--shiki-dark:#dbd7caee\" tabindex=\"0\"><code class=\"language-bash\"><span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">from</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> sklearn.preprocessing</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> import</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> MinMaxScaler</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">scaler</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> =</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> MinMaxScaler</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\">  # å®ä¾‹åŒ–</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">df</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">[</span><span style=\"color:#59873A;--shiki-dark:#80A665\">'ST_NUM'</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">]</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> =</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> scaler.fit_transform</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#59873A;--shiki-dark:#80A665\">df</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">[</span><span style=\"color:#a65e2b;--shiki-dark:#d4976c\">[</span><span style=\"color:#59873A;--shiki-dark:#80A665\">'ST_NUM'</span><span style=\"color:#a65e2b;--shiki-dark:#d4976c\">]</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">]</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\">  # æ³¨æ„è¦ç”¨åŒä¸­æ‹¬å·ä¿æŒ DataFrame ç»“æ„</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#998418;--shiki-dark:#B8A965\">print</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">df.to_string</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">(</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">)</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span></span>\n<span class=\"line\"></span></code></pre>\n<table>\n<thead>\n<tr>\n<th>ç‰¹æ€§</th>\n<th>å½’ä¸€åŒ–ï¼ˆNormalizationï¼‰</th>\n<th>æ ‡å‡†åŒ–ï¼ˆStandardizationï¼‰</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>èŒƒå›´</td>\n<td>é€šå¸¸å‹ç¼©åˆ° <code>[0, 1]</code></td>\n<td>æ²¡æœ‰é™å®šèŒƒå›´ï¼ˆå‡å€¼ä¸º 0ï¼‰</td>\n</tr>\n<tr>\n<td>å…¬å¼</td>\n<td><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">(</mo><mi>x</mi><mo>âˆ’</mo><mi>m</mi><mi>i</mi><mi>n</mi><mo stretchy=\"false\">)</mo><mi mathvariant=\"normal\">/</mi><mo stretchy=\"false\">(</mo><mi>m</mi><mi>a</mi><mi>x</mi><mo>âˆ’</mo><mi>m</mi><mi>i</mi><mi>n</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">(x - min)/(max - min)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">âˆ’</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">min</span><span class=\"mclose\">)</span><span class=\"mord\">/</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">ma</span><span class=\"mord mathnormal\">x</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">âˆ’</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">min</span><span class=\"mclose\">)</span></span></span></span></td>\n<td><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">(</mo><mi>x</mi><mo>âˆ’</mo><mi>Î¼</mi><mo stretchy=\"false\">)</mo><mi mathvariant=\"normal\">/</mi><mi>Ïƒ</mi></mrow><annotation encoding=\"application/x-tex\">(x - Î¼)/Ïƒ</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">âˆ’</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">Î¼</span><span class=\"mclose\">)</span><span class=\"mord\">/</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">Ïƒ</span></span></span></span></td>\n</tr>\n<tr>\n<td>æ˜¯å¦å—å¼‚å¸¸å€¼å½±å“</td>\n<td>å®¹æ˜“å—å½±å“</td>\n<td>ç›¸å¯¹ä¸æ•æ„Ÿ</td>\n</tr>\n<tr>\n<td>é€‚åˆç®—æ³•</td>\n<td>KNNã€SVMã€è·ç¦»ç±»ç®—æ³•</td>\n<td>çº¿æ€§æ¨¡å‹ã€ç¥ç»ç½‘ç»œç­‰</td>\n</tr>\n</tbody>\n</table>\n<h3 id=\"pandasæ±‚è§£æ•°æ®çš„ç›¸å…³æ€§\"><a class=\"anchor\" href=\"#pandasæ±‚è§£æ•°æ®çš„ç›¸å…³æ€§\">#</a> Pandasæ±‚è§£æ•°æ®çš„ç›¸å…³æ€§</h3>\n<ul>\n<li>çš®å°”é€Šç›¸å…³ç³»æ•°(Pearson)ï¼šè¡¡é‡ä¸¤ä¸ªå˜é‡ä¹‹é—´çº¿æ€§å…³ç³»å¼ºåº¦å’Œæ–¹å‘çš„æŒ‡æ ‡ï¼Œå€¼åŸŸåœ¨ [-1, 1] ä¹‹é—´ã€‚</li>\n<li>æ–¯çš®å°”æ›¼ç­‰çº§ç›¸å…³ç³»æ•°(Spearman)ï¼šè¡¡é‡ä¸¤ä¸ªå˜é‡çš„å•è°ƒå…³ç³»ï¼ˆå³ä¸€ä¸ªå˜é‡å¢åŠ ï¼Œå¦ä¸€ä¸ªæ˜¯å¦æ€»æ˜¯å¢åŠ æˆ–æ€»æ˜¯å‡å°‘ï¼Œä¸è¦æ±‚çº¿æ€§ï¼‰</li>\n<li>è‚¯å¾·å°”ç§©ç›¸å…³ç³»æ•°(kendall):è¡¡é‡ä¸¤ä¸ªå˜é‡ä¹‹é—´æ’åçš„ä¸€è‡´æ€§ï¼ˆç§©çš„â€œæ–¹å‘ä¸€è‡´â€ç¨‹åº¦ï¼‰ã€‚</li>\n<li>ç›¸å…³æ€§çŸ©é˜µï¼šç”¨æ¥æŸ¥çœ‹å„ä¸ªå˜é‡ä¹‹é—´çš„ç›¸å…³æ€§ã€‚</li>\n<li>çƒ­å›¾ï¼šä¸€ç§æœ‰æ•ˆçš„å¯è§†åŒ–æ–¹å¼ï¼Œå¯ä»¥å¸®åŠ©æˆ‘ä»¬ç›´è§‚åœ°æŸ¥çœ‹å˜é‡ä¹‹é—´çš„ç›¸å…³æ€§ã€‚</li>\n</ul>\n<pre class=\"shiki shiki-themes vitesse-light vitesse-dark\" style=\"background-color:#ffffff;--shiki-dark-bg:#121212;color:#393a34;--shiki-dark:#dbd7caee\" tabindex=\"0\"><code class=\"language-bash\"><span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">import</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> pandas</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> as</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> pd</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\"># ç¤ºä¾‹æ•°æ®</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">data</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> =</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> {</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">    'Height'</span><span style=\"color:#998418;--shiki-dark:#B8A965\">:</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\"> </span><span style=\"color:rgba(255, 18, 18, 0.8);--shiki-dark:rgba(255, 18, 18, 0.8)\">[</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">150, </span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">160,</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> 170,</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> 180,</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> 190],</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">    'Weight'</span><span style=\"color:#998418;--shiki-dark:#B8A965\">:</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\"> </span><span style=\"color:rgba(255, 18, 18, 0.8);--shiki-dark:rgba(255, 18, 18, 0.8)\">[</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">45, </span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">55,</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> 65,</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> 75,</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> 85],</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">    'Age'</span><span style=\"color:#998418;--shiki-dark:#B8A965\">:</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\"> </span><span style=\"color:rgba(255, 18, 18, 0.8);--shiki-dark:rgba(255, 18, 18, 0.8)\">[</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">20, </span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">25,</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> 30,</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> 35,</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> 40]</span></span>\n<span class=\"line\"><span style=\"color:rgba(255, 18, 18, 0.8);--shiki-dark:rgba(255, 18, 18, 0.8)\">}</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">df</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> =</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> pd.DataFrame</span><span style=\"color:#a13865;--shiki-dark:#d9739f\">(</span><span style=\"color:#59873A;--shiki-dark:#80A665\">data</span><span style=\"color:#a13865;--shiki-dark:#d9739f\">)</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\"># è®¡ç®—çš®å°”é€Šç›¸å…³ç³»æ•°</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">correlation</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> =</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> df.corr</span><span style=\"color:#a13865;--shiki-dark:#d9739f\">(</span><span style=\"color:#B07D48;--shiki-dark:#BD976A\">method</span><span style=\"color:#999999;--shiki-dark:#666666\">=</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\">'</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">pearson</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\">'</span><span style=\"color:#a13865;--shiki-dark:#d9739f\">)</span></span>\n<span class=\"line\"><span style=\"color:#998418;--shiki-dark:#B8A965\">print</span><span style=\"color:#a13865;--shiki-dark:#d9739f\">(</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">correlation</span><span style=\"color:#a13865;--shiki-dark:#d9739f\">)</span></span></code></pre>\n<p>åˆ‡æ¢corré‡Œé¢methodå€¼å°±æ˜¯åˆ©ç”¨ä¸åŒçš„æ–¹æ³•æ±‚è§£ç›¸å…³ç³»æ•°</p>\n",
            "tags": [
                "deeplearning",
                "pytorch",
                "Transformer"
            ]
        }
    ]
}